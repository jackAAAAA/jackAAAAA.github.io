<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- saved from url=(0029)https://claude3.free2gpt.xyz/ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;Content-Type&quot;</span> <span class="attr">content</span>=<span class="string">&quot;text/html; charset=UTF-8&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0,viewport-fit=cover&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;icon&quot;</span> <span class="attr">type</span>=<span class="string">&quot;image/svg+xml&quot;</span> <span class="attr">href</span>=<span class="string">&quot;https://claude3.free2gpt.xyz/icon.svg&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;apple-touch-icon&quot;</span> <span class="attr">href</span>=<span class="string">&quot;https://claude3.free2gpt.xyz/apple-touch-icon.png&quot;</span> <span class="attr">sizes</span>=<span class="string">&quot;180x180&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;mask-icon&quot;</span> <span class="attr">href</span>=<span class="string">&quot;https://claude3.free2gpt.xyz/icon.svg&quot;</span> <span class="attr">color</span>=<span class="string">&quot;#FFFFFF&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;theme-color&quot;</span> <span class="attr">content</span>=<span class="string">&quot;#212129&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;generator&quot;</span> <span class="attr">content</span>=<span class="string">&quot;Astro v2.7.0&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>免费Claude 3.5 Sonnet<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;description&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">content</span>=<span class="string">&quot;免费Claude 3.5 Sonnet Free2gpt 免费ChatGPT 免费GPT 打开即用 完全免费 无需魔法 无需登录 服务稳定 界面简洁 每日赠送gpt4兑换码 ChatGPT公益站&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;keywords&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">content</span>=<span class="string">&quot;免费Claude 3.5 Sonnet Free2gpt 免费ChatGPT 免费GPT 打开即用 完全免费 无需魔法 无需登录 服务稳定 界面简洁 每日赠送gpt4兑换码 ChatGPT公益站&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;google-adsense-account&quot;</span> <span class="attr">content</span>=<span class="string">&quot;ca-pub-8057112648173189&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;google-site-verification&quot;</span> <span class="attr">content</span>=<span class="string">&quot;FbhL8J0fJnk3mL_fZarnaQWi-Eim5bFquvfamVz2jjY&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">defer</span>=<span class="string">&quot;&quot;</span> <span class="attr">data-domain</span>=<span class="string">&quot;claude.free2gpt.xyz&quot;</span> <span class="attr">src</span>=<span class="string">&quot;./免费Claude 3.5 Sonnet_test_files/script.js.download&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;manifest&quot;</span> <span class="attr">href</span>=<span class="string">&quot;https://claude3.free2gpt.xyz/manifest.webmanifest&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span></span></span><br><span class="line"><span class="tag">    <span class="attr">id</span>=<span class="string">&quot;vite-plugin-pwa:inline-sw&quot;</span>&gt;</span><span class="language-javascript"><span class="keyword">if</span> (<span class="string">&#x27;serviceWorker&#x27;</span> <span class="keyword">in</span> navigator) &#123; <span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;load&#x27;</span>, <span class="function">() =&gt;</span> &#123; navigator.<span class="property">serviceWorker</span>.<span class="title function_">register</span>(<span class="string">&#x27;/sw.js&#x27;</span>, &#123; <span class="attr">scope</span>: <span class="string">&#x27;/&#x27;</span> &#125;) &#125;) &#125;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;./免费Claude 3.5 Sonnet_test_files/index.253eb2cb.css&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;./免费Claude 3.5 Sonnet_test_files/index.5709347a.css&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;module&quot;</span> <span class="attr">src</span>=<span class="string">&quot;./免费Claude 3.5 Sonnet_test_files/hoisted.894283fb.js.download&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">main</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">header</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;fb items-center&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;gpt-subtitle&quot;</span>&gt;</span>Claude 3.5 Sonnet<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;op-60 text-sm mt-2.5&quot;</span>&gt;</span>当前全球最强的模型免费使用<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;themeToggle&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">class</span>=<span class="string">&quot;flex items-center justify-center w-10 h-10 rounded-md transition-colors hover:bg-slate/10 astro-KXYEDVG6&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">svg</span> <span class="attr">class</span>=<span class="string">&quot;theme_toggle_svg astro-KXYEDVG6&quot;</span> <span class="attr">width</span>=<span class="string">&quot;1.2em&quot;</span> <span class="attr">height</span>=<span class="string">&quot;1.2em&quot;</span> <span class="attr">viewBox</span>=<span class="string">&quot;0 0 24 24&quot;</span> <span class="attr">color</span>=<span class="string">&quot;#858585&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">fill</span>=<span class="string">&quot;none&quot;</span> <span class="attr">stroke-width</span>=<span class="string">&quot;2&quot;</span> <span class="attr">stroke-linecap</span>=<span class="string">&quot;round&quot;</span> <span class="attr">stroke-linejoin</span>=<span class="string">&quot;round&quot;</span> <span class="attr">stroke</span>=<span class="string">&quot;currentColor&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">mask</span> <span class="attr">id</span>=<span class="string">&quot;myMask&quot;</span> <span class="attr">class</span>=<span class="string">&quot;astro-KXYEDVG6&quot;</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">rect</span> <span class="attr">x</span>=<span class="string">&quot;0&quot;</span> <span class="attr">y</span>=<span class="string">&quot;0&quot;</span> <span class="attr">width</span>=<span class="string">&quot;100%&quot;</span> <span class="attr">height</span>=<span class="string">&quot;100%&quot;</span> <span class="attr">fill</span>=<span class="string">&quot;white&quot;</span> <span class="attr">class</span>=<span class="string">&quot;astro-KXYEDVG6&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">rect</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">circle</span> <span class="attr">class</span>=<span class="string">&quot;theme_toggle_circle1 astro-KXYEDVG6&quot;</span> <span class="attr">fill</span>=<span class="string">&quot;black&quot;</span> <span class="attr">cx</span>=<span class="string">&quot;100%&quot;</span> <span class="attr">cy</span>=<span class="string">&quot;0%&quot;</span> <span class="attr">r</span>=<span class="string">&quot;5&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">circle</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">mask</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">circle</span> <span class="attr">class</span>=<span class="string">&quot;theme_toggle_circle2 astro-KXYEDVG6&quot;</span> <span class="attr">cx</span>=<span class="string">&quot;12&quot;</span> <span class="attr">cy</span>=<span class="string">&quot;12&quot;</span> <span class="attr">fill</span>=<span class="string">&quot;#858585&quot;</span> <span class="attr">mask</span>=<span class="string">&quot;url(#myMask)&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">r</span>=<span class="string">&quot;5&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">circle</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">g</span> <span class="attr">class</span>=<span class="string">&quot;theme_toggle_g astro-KXYEDVG6&quot;</span> <span class="attr">stroke</span>=<span class="string">&quot;currentColor&quot;</span> <span class="attr">opacity</span>=<span class="string">&quot;1&quot;</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">line</span> <span class="attr">x1</span>=<span class="string">&quot;12&quot;</span> <span class="attr">y1</span>=<span class="string">&quot;1&quot;</span> <span class="attr">x2</span>=<span class="string">&quot;12&quot;</span> <span class="attr">y2</span>=<span class="string">&quot;3&quot;</span> <span class="attr">class</span>=<span class="string">&quot;astro-KXYEDVG6&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">line</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">line</span> <span class="attr">x1</span>=<span class="string">&quot;12&quot;</span> <span class="attr">y1</span>=<span class="string">&quot;21&quot;</span> <span class="attr">x2</span>=<span class="string">&quot;12&quot;</span> <span class="attr">y2</span>=<span class="string">&quot;23&quot;</span> <span class="attr">class</span>=<span class="string">&quot;astro-KXYEDVG6&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">line</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">line</span> <span class="attr">x1</span>=<span class="string">&quot;4.22&quot;</span> <span class="attr">y1</span>=<span class="string">&quot;4.22&quot;</span> <span class="attr">x2</span>=<span class="string">&quot;5.64&quot;</span> <span class="attr">y2</span>=<span class="string">&quot;5.64&quot;</span> <span class="attr">class</span>=<span class="string">&quot;astro-KXYEDVG6&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">line</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">line</span> <span class="attr">x1</span>=<span class="string">&quot;18.36&quot;</span> <span class="attr">y1</span>=<span class="string">&quot;18.36&quot;</span> <span class="attr">x2</span>=<span class="string">&quot;19.78&quot;</span> <span class="attr">y2</span>=<span class="string">&quot;19.78&quot;</span> <span class="attr">class</span>=<span class="string">&quot;astro-KXYEDVG6&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">line</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">line</span> <span class="attr">x1</span>=<span class="string">&quot;1&quot;</span> <span class="attr">y1</span>=<span class="string">&quot;12&quot;</span> <span class="attr">x2</span>=<span class="string">&quot;3&quot;</span> <span class="attr">y2</span>=<span class="string">&quot;12&quot;</span> <span class="attr">class</span>=<span class="string">&quot;astro-KXYEDVG6&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">line</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">line</span> <span class="attr">x1</span>=<span class="string">&quot;21&quot;</span> <span class="attr">y1</span>=<span class="string">&quot;12&quot;</span> <span class="attr">x2</span>=<span class="string">&quot;23&quot;</span> <span class="attr">y2</span>=<span class="string">&quot;12&quot;</span> <span class="attr">class</span>=<span class="string">&quot;astro-KXYEDVG6&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">line</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">line</span> <span class="attr">x1</span>=<span class="string">&quot;4.22&quot;</span> <span class="attr">y1</span>=<span class="string">&quot;19.78&quot;</span> <span class="attr">x2</span>=<span class="string">&quot;5.64&quot;</span> <span class="attr">y2</span>=<span class="string">&quot;18.36&quot;</span> <span class="attr">class</span>=<span class="string">&quot;astro-KXYEDVG6&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">line</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">line</span> <span class="attr">x1</span>=<span class="string">&quot;18.36&quot;</span> <span class="attr">y1</span>=<span class="string">&quot;5.64&quot;</span> <span class="attr">x2</span>=<span class="string">&quot;19.78&quot;</span> <span class="attr">y2</span>=<span class="string">&quot;4.22&quot;</span> <span class="attr">class</span>=<span class="string">&quot;astro-KXYEDVG6&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">line</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">g</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">header</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">      astro-island,</span></span><br><span class="line"><span class="language-css">      astro-slot,</span></span><br><span class="line"><span class="language-css">      astro-static-slot &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">display</span>: contents</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript">(<span class="function">() =&gt;</span> &#123; <span class="keyword">var</span> <span class="title function_">e</span> = <span class="keyword">async</span> t =&gt; &#123; <span class="keyword">await</span> (<span class="keyword">await</span> <span class="title function_">t</span>())() &#125;; (self.<span class="property">Astro</span> || (self.<span class="property">Astro</span> = &#123;&#125;)).<span class="property">load</span> = e; <span class="variable language_">window</span>.<span class="title function_">dispatchEvent</span>(<span class="keyword">new</span> <span class="title class_">Event</span>(<span class="string">&quot;astro:load&quot;</span>)); &#125;)();; (<span class="function">() =&gt;</span> &#123; <span class="keyword">var</span> c; &#123; <span class="keyword">let</span> d = &#123; <span class="number">0</span>: <span class="function"><span class="params">t</span> =&gt;</span> t, <span class="number">1</span>: <span class="function"><span class="params">t</span> =&gt;</span> <span class="title class_">JSON</span>.<span class="title function_">parse</span>(t, o), <span class="number">2</span>: <span class="function"><span class="params">t</span> =&gt;</span> <span class="keyword">new</span> <span class="title class_">RegExp</span>(t), <span class="number">3</span>: <span class="function"><span class="params">t</span> =&gt;</span> <span class="keyword">new</span> <span class="title class_">Date</span>(t), <span class="number">4</span>: <span class="function"><span class="params">t</span> =&gt;</span> <span class="keyword">new</span> <span class="title class_">Map</span>(<span class="title class_">JSON</span>.<span class="title function_">parse</span>(t, o)), <span class="number">5</span>: <span class="function"><span class="params">t</span> =&gt;</span> <span class="keyword">new</span> <span class="title class_">Set</span>(<span class="title class_">JSON</span>.<span class="title function_">parse</span>(t, o)), <span class="number">6</span>: <span class="function"><span class="params">t</span> =&gt;</span> <span class="title class_">BigInt</span>(t), <span class="number">7</span>: <span class="function"><span class="params">t</span> =&gt;</span> <span class="keyword">new</span> <span class="title function_">URL</span>(t), <span class="number">8</span>: <span class="function"><span class="params">t</span> =&gt;</span> <span class="keyword">new</span> <span class="title class_">Uint8Array</span>(<span class="title class_">JSON</span>.<span class="title function_">parse</span>(t)), <span class="number">9</span>: <span class="function"><span class="params">t</span> =&gt;</span> <span class="keyword">new</span> <span class="title class_">Uint16Array</span>(<span class="title class_">JSON</span>.<span class="title function_">parse</span>(t)), <span class="number">10</span>: <span class="function"><span class="params">t</span> =&gt;</span> <span class="keyword">new</span> <span class="title class_">Uint32Array</span>(<span class="title class_">JSON</span>.<span class="title function_">parse</span>(t)) &#125;, o = <span class="function">(<span class="params">t, r</span>) =&gt;</span> &#123; <span class="keyword">if</span> (t === <span class="string">&quot;&quot;</span> || !<span class="title class_">Array</span>.<span class="title function_">isArray</span>(r)) <span class="keyword">return</span> r; <span class="keyword">let</span> [e, n] = r; <span class="keyword">return</span> e <span class="keyword">in</span> d ? d[e](n) : <span class="keyword">void</span> <span class="number">0</span> &#125;; customElements.<span class="title function_">get</span>(<span class="string">&quot;astro-island&quot;</span>) || customElements.<span class="title function_">define</span>(<span class="string">&quot;astro-island&quot;</span>, (c = <span class="keyword">class</span> <span class="title class_">extends</span> <span class="title class_">HTMLElement</span> &#123; <span class="title function_">constructor</span>(<span class="params"></span>) &#123; <span class="variable language_">super</span>(...<span class="variable language_">arguments</span>); <span class="variable language_">this</span>.<span class="property">hydrate</span> = <span class="function">() =&gt;</span> &#123; <span class="keyword">var</span> l; <span class="keyword">if</span> (!<span class="variable language_">this</span>.<span class="property">hydrator</span> || !<span class="variable language_">this</span>.<span class="property">isConnected</span> || (l = <span class="variable language_">this</span>.<span class="property">parentElement</span>) != <span class="literal">null</span> &amp;&amp; l.<span class="title function_">closest</span>(<span class="string">&quot;astro-island[ssr]&quot;</span>)) <span class="keyword">return</span>; <span class="keyword">let</span> r = <span class="variable language_">this</span>.<span class="title function_">querySelectorAll</span>(<span class="string">&quot;astro-slot&quot;</span>), e = &#123;&#125;, n = <span class="variable language_">this</span>.<span class="title function_">querySelectorAll</span>(<span class="string">&quot;template[data-astro-template]&quot;</span>); <span class="keyword">for</span> (<span class="keyword">let</span> s <span class="keyword">of</span> n) &#123; <span class="keyword">let</span> i = s.<span class="title function_">closest</span>(<span class="variable language_">this</span>.<span class="property">tagName</span>); !i || !i.<span class="title function_">isSameNode</span>(<span class="variable language_">this</span>) || (e[s.<span class="title function_">getAttribute</span>(<span class="string">&quot;data-astro-template&quot;</span>) || <span class="string">&quot;default&quot;</span>] = s.<span class="property">innerHTML</span>, s.<span class="title function_">remove</span>()) &#125; <span class="keyword">for</span> (<span class="keyword">let</span> s <span class="keyword">of</span> r) &#123; <span class="keyword">let</span> i = s.<span class="title function_">closest</span>(<span class="variable language_">this</span>.<span class="property">tagName</span>); !i || !i.<span class="title function_">isSameNode</span>(<span class="variable language_">this</span>) || (e[s.<span class="title function_">getAttribute</span>(<span class="string">&quot;name&quot;</span>) || <span class="string">&quot;default&quot;</span>] = s.<span class="property">innerHTML</span>) &#125; <span class="keyword">let</span> a = <span class="variable language_">this</span>.<span class="title function_">hasAttribute</span>(<span class="string">&quot;props&quot;</span>) ? <span class="title class_">JSON</span>.<span class="title function_">parse</span>(<span class="variable language_">this</span>.<span class="title function_">getAttribute</span>(<span class="string">&quot;props&quot;</span>), o) : &#123;&#125;; <span class="variable language_">this</span>.<span class="title function_">hydrator</span>(<span class="variable language_">this</span>)(<span class="variable language_">this</span>.<span class="property">Component</span>, a, e, &#123; <span class="attr">client</span>: <span class="variable language_">this</span>.<span class="title function_">getAttribute</span>(<span class="string">&quot;client&quot;</span>) &#125;), <span class="variable language_">this</span>.<span class="title function_">removeAttribute</span>(<span class="string">&quot;ssr&quot;</span>), <span class="variable language_">window</span>.<span class="title function_">removeEventListener</span>(<span class="string">&quot;astro:hydrate&quot;</span>, <span class="variable language_">this</span>.<span class="property">hydrate</span>), <span class="variable language_">window</span>.<span class="title function_">dispatchEvent</span>(<span class="keyword">new</span> <span class="title class_">CustomEvent</span>(<span class="string">&quot;astro:hydrate&quot;</span>)) &#125; &#125; <span class="title function_">connectedCallback</span>(<span class="params"></span>) &#123; !<span class="variable language_">this</span>.<span class="title function_">hasAttribute</span>(<span class="string">&quot;await-children&quot;</span>) || <span class="variable language_">this</span>.<span class="property">firstChild</span> ? <span class="variable language_">this</span>.<span class="title function_">childrenConnectedCallback</span>() : <span class="keyword">new</span> <span class="title class_">MutationObserver</span>(<span class="function">(<span class="params">r, e</span>) =&gt;</span> &#123; e.<span class="title function_">disconnect</span>(), <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> <span class="variable language_">this</span>.<span class="title function_">childrenConnectedCallback</span>(), <span class="number">0</span>) &#125;).<span class="title function_">observe</span>(<span class="variable language_">this</span>, &#123; <span class="attr">childList</span>: !<span class="number">0</span> &#125;) &#125; <span class="keyword">async</span> <span class="title function_">childrenConnectedCallback</span>(<span class="params"></span>) &#123; <span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&quot;astro:hydrate&quot;</span>, <span class="variable language_">this</span>.<span class="property">hydrate</span>); <span class="keyword">let</span> r = <span class="variable language_">this</span>.<span class="title function_">getAttribute</span>(<span class="string">&quot;before-hydration-url&quot;</span>); r &amp;&amp; <span class="keyword">await</span> <span class="keyword">import</span>(r), <span class="variable language_">this</span>.<span class="title function_">start</span>() &#125; <span class="title function_">start</span>(<span class="params"></span>) &#123; <span class="keyword">let</span> r = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(<span class="variable language_">this</span>.<span class="title function_">getAttribute</span>(<span class="string">&quot;opts&quot;</span>)), e = <span class="variable language_">this</span>.<span class="title function_">getAttribute</span>(<span class="string">&quot;client&quot;</span>); <span class="keyword">if</span> (<span class="title class_">Astro</span>[e] === <span class="keyword">void</span> <span class="number">0</span>) &#123; <span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">`astro:<span class="subst">$&#123;e&#125;</span>`</span>, <span class="function">() =&gt;</span> <span class="variable language_">this</span>.<span class="title function_">start</span>(), &#123; <span class="attr">once</span>: !<span class="number">0</span> &#125;); <span class="keyword">return</span> &#125; <span class="title class_">Astro</span>[e](<span class="keyword">async</span> () =&gt; &#123; <span class="keyword">let</span> n = <span class="variable language_">this</span>.<span class="title function_">getAttribute</span>(<span class="string">&quot;renderer-url&quot;</span>), [a, &#123; <span class="attr">default</span>: l &#125;] = <span class="keyword">await</span> <span class="title class_">Promise</span>.<span class="title function_">all</span>([<span class="keyword">import</span>(<span class="variable language_">this</span>.<span class="title function_">getAttribute</span>(<span class="string">&quot;component-url&quot;</span>)), n ? <span class="keyword">import</span>(n) : <span class="function">() =&gt;</span> <span class="function">() =&gt;</span> &#123; &#125;]), s = <span class="variable language_">this</span>.<span class="title function_">getAttribute</span>(<span class="string">&quot;component-export&quot;</span>) || <span class="string">&quot;default&quot;</span>; <span class="keyword">if</span> (!s.<span class="title function_">includes</span>(<span class="string">&quot;.&quot;</span>)) <span class="variable language_">this</span>.<span class="property">Component</span> = a[s]; <span class="keyword">else</span> &#123; <span class="variable language_">this</span>.<span class="property">Component</span> = a; <span class="keyword">for</span> (<span class="keyword">let</span> i <span class="keyword">of</span> s.<span class="title function_">split</span>(<span class="string">&quot;.&quot;</span>)) <span class="variable language_">this</span>.<span class="property">Component</span> = <span class="variable language_">this</span>.<span class="property">Component</span>[i] &#125; <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">hydrator</span> = l, <span class="variable language_">this</span>.<span class="property">hydrate</span> &#125;, r, <span class="variable language_">this</span>) &#125; <span class="title function_">attributeChangedCallback</span>(<span class="params"></span>) &#123; <span class="variable language_">this</span>.<span class="title function_">hydrate</span>() &#125; &#125;, c.<span class="property">observedAttributes</span> = [<span class="string">&quot;props&quot;</span>], c)) &#125; &#125;)();</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">astro-island</span> <span class="attr">uid</span>=<span class="string">&quot;ZHVIXJ&quot;</span> <span class="attr">data-solid-render-id</span>=<span class="string">&quot;s0&quot;</span> <span class="attr">component-url</span>=<span class="string">&quot;/_astro/Generator.f2c6c63b.js&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">component-export</span>=<span class="string">&quot;default&quot;</span> <span class="attr">renderer-url</span>=<span class="string">&quot;/_astro/client.0e663382.js&quot;</span> <span class="attr">props</span>=<span class="string">&quot;&#123;&#125;&quot;</span> <span class="attr">client</span>=<span class="string">&quot;load&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">opts</span>=<span class="string">&quot;&#123;<span class="symbol">&amp;quot;</span>name<span class="symbol">&amp;quot;</span>:<span class="symbol">&amp;quot;</span>Generator<span class="symbol">&amp;quot;</span>,<span class="symbol">&amp;quot;</span>value<span class="symbol">&amp;quot;</span>:true&#125;&quot;</span> <span class="attr">await-children</span>=<span class="string">&quot;&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">data-hk</span>=<span class="string">&quot;s00-0&quot;</span> <span class="attr">mt-1</span>=<span class="string">&quot;&quot;</span> <span class="attr">mb-3</span>=<span class="string">&quot;&quot;</span>&gt;</span><span class="comment">&lt;!--#--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">data-hk</span>=<span class="string">&quot;s00-1-0&quot;</span> <span class="attr">class</span>=<span class="string">&quot;mt-1&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">p</span> <span class="attr">mt-1</span>=<span class="string">&quot;&quot;</span> <span class="attr">text-sm</span>=<span class="string">&quot;&quot;</span> <span class="attr">op-60</span>=<span class="string">&quot;&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">span</span>&gt;</span>为了能持久运营,我们需要你的<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                <span class="attr">class</span>=<span class="string">&quot;border-1 px-2 py-1 mx-1 rounded-md transition-colors bg-slate/20 cursor-pointer hover:bg-slate/50&quot;</span>&gt;</span>捐赠<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">span</span>&gt;</span>🙏🏻<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">p</span>&gt;</span><span class="comment">&lt;!--#--&gt;</span><span class="comment">&lt;!--/--&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="comment">&lt;!--#--&gt;</span><span class="comment">&lt;!--/--&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="comment">&lt;!--/--&gt;</span><span class="comment">&lt;!--#--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;py-2 -mx-4 px-4 transition-colors md:hover:bg-slate/3&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;flex gap-3 rounded-lg op-75&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;shrink-0 w-7 h-7 mt-4 rounded-full op-80 bg-gradient-to-r from-purple-400 to-yellow-400&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;message prose break-words overflow-hidden&quot;</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>IdleHandler的实现原理应用场景<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="comment">&lt;!--#--&gt;</span><span class="comment">&lt;!--/--&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;py-2 -mx-4 px-4 transition-colors md:hover:bg-slate/3&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;flex gap-3 rounded-lg&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span></span></span><br><span class="line"><span class="tag">              <span class="attr">class</span>=<span class="string">&quot;shrink-0 w-7 h-7 mt-4 rounded-full op-80 bg-gradient-to-r from-yellow-200 via-green-200 to-green-300&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;message prose break-words overflow-hidden&quot;</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>IdleHandler是Android中一种用于处理空闲时间的机制,它的主要实现原理和应用场景如下:<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>实现原理:<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ol</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">p</span>&gt;</span>IdleHandler是通过MessageQueue实现的。MessageQueue维护了一个IdleHandler列表。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">p</span>&gt;</span>当Looper处理完所有消息后,会调用MessageQueue的next()方法获取下一条消息。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">p</span>&gt;</span>如果队列中没有消息或者下一条消息还没到执行时间,就会进入idle状态。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">p</span>&gt;</span>此时会遍历IdleHandler列表,依次调用每个IdleHandler的queueIdle()方法。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">p</span>&gt;</span>queueIdle()返回false表示使用一次后移除,返回true表示继续保留以便下次idle时执行。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">p</span>&gt;</span>执行完IdleHandler后,如果仍然idle就会进入阻塞等待状态。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>应用场景:<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ol</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">p</span>&gt;</span>延迟执行不紧急的任务:<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">                    可以把一些不紧急的初始化、数据处理等任务放到IdleHandler中执行,避免在启动时就做大量工作影响性能。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">p</span>&gt;</span>性能优化:<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">                    把一些耗时较长但不紧急的操作放到空闲时间执行,提高应用响应速度。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">p</span>&gt;</span>资源回收:<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">                    在空闲时进行一些资源清理、缓存淘汰等工作。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">p</span>&gt;</span>预加载:<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">                    利用空闲时间提前加载一些数据或资源,提高后续操作的响应速度。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">p</span>&gt;</span>数据同步:<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">                    在空闲时进行本地数据与服务器的同步操作。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">p</span>&gt;</span>监控统计:<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">                    利用空闲时间收集和上报一些统计数据。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">p</span>&gt;</span>优化动画:<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">                    在动画执行的空隙插入一些次要的UI更新操作。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>使用示例:<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">div</span> <span class="attr">relative</span>=<span class="string">&quot;&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">data-code</span>=<span class="string">&quot;Looper.myQueue().addIdleHandler(new%20MessageQueue.IdleHandler()%20%7B%0A%20%20%20%20%40Override%0A%20%20%20%20public%20boolean%20queueIdle()%20%7B%0A%20%20%20%20%20%20%20%20%2F%2F%20%E6%89%A7%E8%A1%8C%E7%A9%BA%E9%97%B2%E6%97%B6%E7%9A%84%E4%BB%BB%E5%8A%A1%0A%20%20%20%20%20%20%20%20doSomeWork()%3B%0A%20%20%20%20%20%20%20%20%2F%2F%20%E8%BF%94%E5%9B%9Efalse%E8%A1%A8%E7%A4%BA%E5%8F%AA%E6%89%A7%E8%A1%8C%E4%B8%80%E6%AC%A1%0A%20%20%20%20%20%20%20%20return%20false%3B%0A%20%20%20%20%7D%0A%7D)%3B%0A&quot;</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">class</span>=<span class="string">&quot;copy-btn gpt-copy-btn group&quot;</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">svg</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.w3.org/2000/svg&quot;</span> <span class="attr">width</span>=<span class="string">&quot;1em&quot;</span> <span class="attr">height</span>=<span class="string">&quot;1em&quot;</span> <span class="attr">viewBox</span>=<span class="string">&quot;0 0 32 32&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">path</span> <span class="attr">fill</span>=<span class="string">&quot;currentColor&quot;</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">d</span>=<span class="string">&quot;M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">path</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">path</span> <span class="attr">fill</span>=<span class="string">&quot;currentColor&quot;</span> <span class="attr">d</span>=<span class="string">&quot;M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">path</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;group-hover:op-100 gpt-copy-tips&quot;</span>&gt;</span></span><br><span class="line">                    Copy</span><br><span class="line">                  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">pre</span>&gt;</span><span class="tag">&lt;<span class="name">code</span> <span class="attr">class</span>=<span class="string">&quot;hljs language-java&quot;</span>&gt;</span>Looper.myQueue().addIdleHandler(<span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>new<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-title class_&quot;</span>&gt;</span>MessageQueue<span class="tag">&lt;/<span class="name">span</span>&gt;</span>.IdleHandler()</span><br><span class="line">                    &#123;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-meta&quot;</span>&gt;</span>@Override<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>public<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-type&quot;</span>&gt;</span>boolean<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-title function_&quot;</span>&gt;</span>queueIdle<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-params&quot;</span>&gt;</span>()<span class="tag">&lt;/<span class="name">span</span>&gt;</span> &#123;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-comment&quot;</span>&gt;</span>// 执行空闲时的任务<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    doSomeWork();</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-comment&quot;</span>&gt;</span>// 返回false表示只执行一次<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>return<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-literal&quot;</span>&gt;</span>false<span class="tag">&lt;/<span class="name">span</span>&gt;</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    &#125;);</span><br><span class="line">                  <span class="tag">&lt;/<span class="name">code</span>&gt;</span><span class="tag">&lt;/<span class="name">pre</span>&gt;</span></span><br><span class="line"></span><br><span class="line">              <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>注意事项:<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ol</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">p</span>&gt;</span>IdleHandler中不应执行耗时很长的操作,否则可能影响主线程的其他任务。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">p</span>&gt;</span>不要在IdleHandler中再次加入消息或者post Runnable,可能导致死循环。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">p</span>&gt;</span>谨慎使用返回true的情况,避免频繁执行导致性能问题。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">p</span>&gt;</span>IdleHandler在应用切换到后台时可能不会执行,如果有必要可以结合Lifecycle使用。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>总之,IdleHandler是一个很有用的机制,合理使用可以优化应用性能,提高用户体验。但也需要谨慎使用,避免引入新的问题。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="comment">&lt;!--#--&gt;</span><span class="comment">&lt;!--/--&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;py-2 -mx-4 px-4 transition-colors md:hover:bg-slate/3&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;flex gap-3 rounded-lg op-75&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;shrink-0 w-7 h-7 mt-4 rounded-full op-80 bg-gradient-to-r from-purple-400 to-yellow-400&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;message prose break-words overflow-hidden&quot;</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>你可以把你阐述的原理配合源码来给我讲述吗？我感觉还是没有理解<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="comment">&lt;!--#--&gt;</span><span class="comment">&lt;!--/--&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;py-2 -mx-4 px-4 transition-colors md:hover:bg-slate/3&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;flex gap-3 rounded-lg&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span></span></span><br><span class="line"><span class="tag">              <span class="attr">class</span>=<span class="string">&quot;shrink-0 w-7 h-7 mt-4 rounded-full op-80 bg-gradient-to-r from-yellow-200 via-green-200 to-green-300&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;message prose break-words overflow-hidden&quot;</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>当然可以。让我们通过 Android 的源码来深入理解 IdleHandler 的实现原理。我们主要关注 MessageQueue 类，因为 IdleHandler 的核心实现就在这里。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>首先，让我们看看 MessageQueue 类中与 IdleHandler 相关的部分：<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">div</span> <span class="attr">relative</span>=<span class="string">&quot;&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">data-code</span>=<span class="string">&quot;public%20final%20class%20MessageQueue%20%7B%0A%20%20%20%20private%20final%20ArrayList%3CIdleHandler%3E%20mIdleHandlers%20%3D%20new%20ArrayList%3CIdleHandler%3E()%3B%0A%20%20%20%20private%20IdleHandler%5B%5D%20mPendingIdleHandlers%3B%0A%20%20%20%20private%20boolean%20mQuitting%3B%0A%0A%20%20%20%20%2F%2F%20...%E5%85%B6%E4%BB%96%E4%BB%A3%E7%A0%81...%0A%0A%20%20%20%20public%20void%20addIdleHandler(%40NonNull%20IdleHandler%20handler)%20%7B%0A%20%20%20%20%20%20%20%20if%20(handler%20%3D%3D%20null)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20throw%20new%20NullPointerException(%22Can<span class="symbol">&amp;#39;</span>t%20add%20a%20null%20IdleHandler%22)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20synchronized%20(this)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20mIdleHandlers.add(handler)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%0A%20%20%20%20public%20void%20removeIdleHandler(%40NonNull%20IdleHandler%20handler)%20%7B%0A%20%20%20%20%20%20%20%20synchronized%20(this)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20mIdleHandlers.remove(handler)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2F%20...%E5%85%B6%E4%BB%96%E4%BB%A3%E7%A0%81...%0A%7D%0A&quot;</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">class</span>=<span class="string">&quot;copy-btn gpt-copy-btn group&quot;</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">svg</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.w3.org/2000/svg&quot;</span> <span class="attr">width</span>=<span class="string">&quot;1em&quot;</span> <span class="attr">height</span>=<span class="string">&quot;1em&quot;</span> <span class="attr">viewBox</span>=<span class="string">&quot;0 0 32 32&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">path</span> <span class="attr">fill</span>=<span class="string">&quot;currentColor&quot;</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">d</span>=<span class="string">&quot;M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">path</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">path</span> <span class="attr">fill</span>=<span class="string">&quot;currentColor&quot;</span> <span class="attr">d</span>=<span class="string">&quot;M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">path</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;group-hover:op-100 gpt-copy-tips&quot;</span>&gt;</span></span><br><span class="line">                    Copy</span><br><span class="line">                  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">pre</span>&gt;</span><span class="tag">&lt;<span class="name">code</span> <span class="attr">class</span>=<span class="string">&quot;hljs language-java&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>public<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>final<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>class<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-title class_&quot;</span>&gt;</span>MessageQueue<span class="tag">&lt;/<span class="name">span</span>&gt;</span> &#123;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>private<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>final<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    ArrayList<span class="symbol">&amp;lt;</span>IdleHandler<span class="symbol">&amp;gt;</span> mIdleHandlers = <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>new<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-title class_&quot;</span>&gt;</span>ArrayList<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="symbol">&amp;lt;</span>IdleHandler<span class="symbol">&amp;gt;</span>();</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>private<span class="tag">&lt;/<span class="name">span</span>&gt;</span> IdleHandler[] mPendingIdleHandlers;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>private<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-type&quot;</span>&gt;</span>boolean<span class="tag">&lt;/<span class="name">span</span>&gt;</span> mQuitting;</span><br><span class="line"></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-comment&quot;</span>&gt;</span>// ...其他代码...<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>public<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>void<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-title function_&quot;</span>&gt;</span>addIdleHandler<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-params&quot;</span>&gt;</span>(<span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">class</span>=<span class="string">&quot;hljs-meta&quot;</span>&gt;</span>@NonNull<span class="tag">&lt;/<span class="name">span</span>&gt;</span> IdleHandler handler)<span class="tag">&lt;/<span class="name">span</span>&gt;</span> &#123;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>if<span class="tag">&lt;/<span class="name">span</span>&gt;</span> (handler == <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-literal&quot;</span>&gt;</span>null<span class="tag">&lt;/<span class="name">span</span>&gt;</span>) &#123;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>throw<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>new<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-title class_&quot;</span>&gt;</span>NullPointerException<span class="tag">&lt;/<span class="name">span</span>&gt;</span>(<span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-string&quot;</span>&gt;</span>&quot;Can&#x27;t add a null</span><br><span class="line">                      IdleHandler&quot;<span class="tag">&lt;/<span class="name">span</span>&gt;</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>synchronized<span class="tag">&lt;/<span class="name">span</span>&gt;</span> (<span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-built_in&quot;</span>&gt;</span>this<span class="tag">&lt;/<span class="name">span</span>&gt;</span>) &#123;</span><br><span class="line">                    mIdleHandlers.add(handler);</span><br><span class="line">                    &#125;</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>public<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>void<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-title function_&quot;</span>&gt;</span>removeIdleHandler<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-params&quot;</span>&gt;</span>(<span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">class</span>=<span class="string">&quot;hljs-meta&quot;</span>&gt;</span>@NonNull<span class="tag">&lt;/<span class="name">span</span>&gt;</span> IdleHandler handler)<span class="tag">&lt;/<span class="name">span</span>&gt;</span> &#123;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>synchronized<span class="tag">&lt;/<span class="name">span</span>&gt;</span> (<span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-built_in&quot;</span>&gt;</span>this<span class="tag">&lt;/<span class="name">span</span>&gt;</span>) &#123;</span><br><span class="line">                    mIdleHandlers.remove(handler);</span><br><span class="line">                    &#125;</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-comment&quot;</span>&gt;</span>// ...其他代码...<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    &#125;</span><br><span class="line">                  <span class="tag">&lt;/<span class="name">code</span>&gt;</span><span class="tag">&lt;/<span class="name">pre</span>&gt;</span></span><br><span class="line"></span><br><span class="line">              <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>这里我们可以看到，MessageQueue 维护了一个 IdleHandler 的列表 <span class="tag">&lt;<span class="name">code</span>&gt;</span>mIdleHandlers<span class="tag">&lt;/<span class="name">code</span>&gt;</span>。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>现在，让我们看看 MessageQueue 的 <span class="tag">&lt;<span class="name">code</span>&gt;</span>next()<span class="tag">&lt;/<span class="name">code</span>&gt;</span> 方法，这是 IdleHandler 被调用的关键地方：<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">div</span> <span class="attr">relative</span>=<span class="string">&quot;&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">data-code</span>=<span class="string">&quot;Message%20next()%20%7B%0A%20%20%20%20%2F%2F%20...%E5%89%8D%E9%9D%A2%E7%9A%84%E4%BB%A3%E7%A0%81...%0A%0A%20%20%20%20for%20(%3B%3B)%20%7B%0A%20%20%20%20%20%20%20%20%2F%2F%20...%E5%85%B6%E4%BB%96%E4%BB%A3%E7%A0%81...%0A%0A%20%20%20%20%20%20%20%20nativePollOnce(ptr%2C%20nextPollTimeoutMillis)%3B%0A%0A%20%20%20%20%20%20%20%20synchronized%20(this)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20...%E8%8E%B7%E5%8F%96%E4%B8%8B%E4%B8%80%E6%9D%A1%E6%B6%88%E6%81%AF%E7%9A%84%E4%BB%A3%E7%A0%81...%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20%E5%A6%82%E6%9E%9C%E6%B2%A1%E6%9C%89%E6%9B%B4%E5%A4%9A%E6%B6%88%E6%81%AF%EF%BC%8C%E6%88%91%E4%BB%AC%E5%B0%B1%E5%A4%84%E4%BA%8E%E7%A9%BA%E9%97%B2%E7%8A%B6%E6%80%81%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(msg%20%3D%3D%20null)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20%E6%B2%A1%E6%9C%89%E6%B6%88%E6%81%AF%E6%84%8F%E5%91%B3%E7%9D%80%E6%88%91%E4%BB%AC%E7%8E%B0%E5%9C%A8%E5%A4%84%E4%BA%8E%E7%A9%BA%E9%97%B2%E7%8A%B6%E6%80%81%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pendingIdleHandlerCount%20%3D%20-1%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20nextPollTimeoutMillis%20%3D%20-1%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20%E5%A6%82%E6%9E%9C%E6%9C%89%E5%BB%B6%E8%BF%9F%E6%B6%88%E6%81%AF%EF%BC%8C%E6%88%91%E4%BB%AC%E5%B0%B1%E8%AE%BE%E7%BD%AE%E4%B8%80%E4%B8%AA%E8%B6%85%E6%97%B6%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20nextPollTimeoutMillis%20%3D%200%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(pendingIdleHandlerCount%20%3C%200%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%26%26%20(mMessages%20%3D%3D%20null%20%7C%7C%20now%20%3C%20mMessages.when))%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pendingIdleHandlerCount%20%3D%20mIdleHandlers.size()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(pendingIdleHandlerCount%20%3C%3D%200)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20%E6%B2%A1%E6%9C%89%20idle%20handlers%20%E9%9C%80%E8%A6%81%E8%BF%90%E8%A1%8C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mBlocked%20%3D%20true%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20continue%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(mPendingIdleHandlers%20%3D%3D%20null)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mPendingIdleHandlers%20%3D%20new%20IdleHandler%5BMath.max(pendingIdleHandlerCount%2C%204)%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20mPendingIdleHandlers%20%3D%20mIdleHandlers.toArray(mPendingIdleHandlers)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20%E8%BF%90%E8%A1%8C%20idle%20handlers%0A%20%20%20%20%20%20%20%20for%20(int%20i%20%3D%200%3B%20i%20%3C%20pendingIdleHandlerCount%3B%20i%2B%2B)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20final%20IdleHandler%20idler%20%3D%20mPendingIdleHandlers%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20mPendingIdleHandlers%5Bi%5D%20%3D%20null%3B%20%2F%2F%20%E9%87%8A%E6%94%BE%E5%BC%95%E7%94%A8%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20boolean%20keep%20%3D%20false%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20try%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20keep%20%3D%20idler.queueIdle()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20catch%20(Throwable%20t)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20Log.wtf(TAG%2C%20%22IdleHandler%20threw%20exception%22%2C%20t)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(!keep)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20synchronized%20(this)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20mIdleHandlers.remove(idler)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20%E9%87%8D%E7%BD%AE%20idle%20handler%20%E8%AE%A1%E6%95%B0%E4%B8%BA%200%EF%BC%8C%E8%BF%99%E6%A0%B7%E6%88%91%E4%BB%AC%E5%B0%B1%E4%B8%8D%E4%BC%9A%E5%86%8D%E6%AC%A1%E8%BF%90%E8%A1%8C%E5%AE%83%E4%BB%AC%0A%20%20%20%20%20%20%20%20pendingIdleHandlerCount%20%3D%200%3B%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20%E5%BD%93%E8%B0%83%E7%94%A8%E4%B8%80%E4%B8%AA%E7%A9%BA%E9%97%B2%E5%A4%84%E7%90%86%E7%A8%8B%E5%BA%8F%E6%97%B6%EF%BC%8C%E6%96%B0%E6%B6%88%E6%81%AF%E5%8F%AF%E8%83%BD%E5%B7%B2%E7%BB%8F%E5%88%B0%E8%BE%BE%EF%BC%8C%E6%89%80%E4%BB%A5%E5%9B%9E%E5%88%B0%E5%BE%AA%E7%8E%AF%E9%A1%B6%E9%83%A8%E5%8E%BB%E6%A3%80%E6%9F%A5%0A%20%20%20%20%20%20%20%20nextPollTimeoutMillis%20%3D%200%3B%0A%20%20%20%20%7D%0A%7D%0A&quot;</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">class</span>=<span class="string">&quot;copy-btn gpt-copy-btn group&quot;</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">svg</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.w3.org/2000/svg&quot;</span> <span class="attr">width</span>=<span class="string">&quot;1em&quot;</span> <span class="attr">height</span>=<span class="string">&quot;1em&quot;</span> <span class="attr">viewBox</span>=<span class="string">&quot;0 0 32 32&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">path</span> <span class="attr">fill</span>=<span class="string">&quot;currentColor&quot;</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">d</span>=<span class="string">&quot;M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">path</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">path</span> <span class="attr">fill</span>=<span class="string">&quot;currentColor&quot;</span> <span class="attr">d</span>=<span class="string">&quot;M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">path</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;group-hover:op-100 gpt-copy-tips&quot;</span>&gt;</span></span><br><span class="line">                    Copy</span><br><span class="line">                  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">pre</span>&gt;</span><span class="tag">&lt;<span class="name">code</span> <span class="attr">class</span>=<span class="string">&quot;hljs language-java&quot;</span>&gt;</span>Message <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-title function_&quot;</span>&gt;</span>next<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-params&quot;</span>&gt;</span>()<span class="tag">&lt;/<span class="name">span</span>&gt;</span> &#123;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-comment&quot;</span>&gt;</span>// ...前面的代码...<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>for<span class="tag">&lt;/<span class="name">span</span>&gt;</span> (;;) &#123;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-comment&quot;</span>&gt;</span>// ...其他代码...<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"></span><br><span class="line">                    nativePollOnce(ptr, nextPollTimeoutMillis);</span><br><span class="line"></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>synchronized<span class="tag">&lt;/<span class="name">span</span>&gt;</span> (<span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-built_in&quot;</span>&gt;</span>this<span class="tag">&lt;/<span class="name">span</span>&gt;</span>) &#123;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-comment&quot;</span>&gt;</span>// ...获取下一条消息的代码...<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-comment&quot;</span>&gt;</span>// 如果没有更多消息，我们就处于空闲状态<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>if<span class="tag">&lt;/<span class="name">span</span>&gt;</span> (msg == <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-literal&quot;</span>&gt;</span>null<span class="tag">&lt;/<span class="name">span</span>&gt;</span>) &#123;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-comment&quot;</span>&gt;</span>// 没有消息意味着我们现在处于空闲状态<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    pendingIdleHandlerCount = -<span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-number&quot;</span>&gt;</span>1<span class="tag">&lt;/<span class="name">span</span>&gt;</span>;</span><br><span class="line">                    nextPollTimeoutMillis = -<span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-number&quot;</span>&gt;</span>1<span class="tag">&lt;/<span class="name">span</span>&gt;</span>;</span><br><span class="line">                    &#125; <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>else<span class="tag">&lt;/<span class="name">span</span>&gt;</span> &#123;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-comment&quot;</span>&gt;</span>// 如果有延迟消息，我们就设置一个超时<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    nextPollTimeoutMillis = <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-number&quot;</span>&gt;</span>0<span class="tag">&lt;/<span class="name">span</span>&gt;</span>;</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>if<span class="tag">&lt;/<span class="name">span</span>&gt;</span> (pendingIdleHandlerCount <span class="symbol">&amp;lt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-number&quot;</span>&gt;</span>0<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    <span class="symbol">&amp;amp;</span><span class="symbol">&amp;amp;</span> (mMessages == <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-literal&quot;</span>&gt;</span>null<span class="tag">&lt;/<span class="name">span</span>&gt;</span> || now <span class="symbol">&amp;lt;</span> mMessages.when)) &#123;</span><br><span class="line">                    pendingIdleHandlerCount = mIdleHandlers.size();</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>if<span class="tag">&lt;/<span class="name">span</span>&gt;</span> (pendingIdleHandlerCount <span class="symbol">&amp;lt;</span>= <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-number&quot;</span>&gt;</span>0<span class="tag">&lt;/<span class="name">span</span>&gt;</span>) &#123;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-comment&quot;</span>&gt;</span>// 没有 idle handlers 需要运行<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    mBlocked = <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-literal&quot;</span>&gt;</span>true<span class="tag">&lt;/<span class="name">span</span>&gt;</span>;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>continue<span class="tag">&lt;/<span class="name">span</span>&gt;</span>;</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>if<span class="tag">&lt;/<span class="name">span</span>&gt;</span> (mPendingIdleHandlers == <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-literal&quot;</span>&gt;</span>null<span class="tag">&lt;/<span class="name">span</span>&gt;</span>) &#123;</span><br><span class="line">                    mPendingIdleHandlers = <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>new<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-title class_&quot;</span>&gt;</span>IdleHandler<span class="tag">&lt;/<span class="name">span</span>&gt;</span>[Math.max(pendingIdleHandlerCount, <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-number&quot;</span>&gt;</span>4<span class="tag">&lt;/<span class="name">span</span>&gt;</span>)];</span><br><span class="line">                    &#125;</span><br><span class="line">                    mPendingIdleHandlers = mIdleHandlers.toArray(mPendingIdleHandlers);</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-comment&quot;</span>&gt;</span>// 运行 idle handlers<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>for<span class="tag">&lt;/<span class="name">span</span>&gt;</span> (<span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-type&quot;</span>&gt;</span>int<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-variable&quot;</span>&gt;</span>i<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-operator&quot;</span>&gt;</span>=<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-number&quot;</span>&gt;</span>0<span class="tag">&lt;/<span class="name">span</span>&gt;</span>; i <span class="symbol">&amp;lt;</span> pendingIdleHandlerCount; i++) &#123;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>final<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-type&quot;</span>&gt;</span>IdleHandler<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-variable&quot;</span>&gt;</span>idler<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-operator&quot;</span>&gt;</span>=<span class="tag">&lt;/<span class="name">span</span>&gt;</span> mPendingIdleHandlers[i];</span><br><span class="line">                    mPendingIdleHandlers[i] = <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-literal&quot;</span>&gt;</span>null<span class="tag">&lt;/<span class="name">span</span>&gt;</span>; <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-comment&quot;</span>&gt;</span>//</span><br><span class="line">                      释放引用<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-type&quot;</span>&gt;</span>boolean<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-variable&quot;</span>&gt;</span>keep<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-operator&quot;</span>&gt;</span>=<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-literal&quot;</span>&gt;</span>false<span class="tag">&lt;/<span class="name">span</span>&gt;</span>;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>try<span class="tag">&lt;/<span class="name">span</span>&gt;</span> &#123;</span><br><span class="line">                    keep = idler.queueIdle();</span><br><span class="line">                    &#125; <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>catch<span class="tag">&lt;/<span class="name">span</span>&gt;</span> (Throwable t) &#123;</span><br><span class="line">                    Log.wtf(TAG, <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-string&quot;</span>&gt;</span>&quot;IdleHandler threw exception&quot;<span class="tag">&lt;/<span class="name">span</span>&gt;</span>, t);</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>if<span class="tag">&lt;/<span class="name">span</span>&gt;</span> (!keep) &#123;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>synchronized<span class="tag">&lt;/<span class="name">span</span>&gt;</span> (<span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-built_in&quot;</span>&gt;</span>this<span class="tag">&lt;/<span class="name">span</span>&gt;</span>) &#123;</span><br><span class="line">                    mIdleHandlers.remove(idler);</span><br><span class="line">                    &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-comment&quot;</span>&gt;</span>// 重置 idle handler 计数为 0，这样我们就不会再次运行它们<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    pendingIdleHandlerCount = <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-number&quot;</span>&gt;</span>0<span class="tag">&lt;/<span class="name">span</span>&gt;</span>;</span><br><span class="line"></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-comment&quot;</span>&gt;</span>// 当调用一个空闲处理程序时，新消息可能已经到达，所以回到循环顶部去检查<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    nextPollTimeoutMillis = <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-number&quot;</span>&gt;</span>0<span class="tag">&lt;/<span class="name">span</span>&gt;</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                  <span class="tag">&lt;/<span class="name">code</span>&gt;</span><span class="tag">&lt;/<span class="name">pre</span>&gt;</span></span><br><span class="line"></span><br><span class="line">              <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>让我们逐步解析这段代码：<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ol</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">p</span>&gt;</span>当 MessageQueue 中没有消息或下一条消息还没到执行时间时，<span class="tag">&lt;<span class="name">code</span>&gt;</span>msg == null<span class="tag">&lt;/<span class="name">code</span>&gt;</span>。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">p</span>&gt;</span>此时，我们设置 <span class="tag">&lt;<span class="name">code</span>&gt;</span>pendingIdleHandlerCount<span class="tag">&lt;/<span class="name">code</span>&gt;</span> 为 IdleHandler 的数量。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">p</span>&gt;</span>如果有 IdleHandler 需要运行，我们就把它们复制到 <span class="tag">&lt;<span class="name">code</span>&gt;</span>mPendingIdleHandlers<span class="tag">&lt;/<span class="name">code</span>&gt;</span> 数组中。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">p</span>&gt;</span>然后，我们遍历这个数组，对每个 IdleHandler 调用其 <span class="tag">&lt;<span class="name">code</span>&gt;</span>queueIdle()<span class="tag">&lt;/<span class="name">code</span>&gt;</span> 方法。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">p</span>&gt;</span>如果 <span class="tag">&lt;<span class="name">code</span>&gt;</span>queueIdle()<span class="tag">&lt;/<span class="name">code</span>&gt;</span> 返回 false，我们就从 <span class="tag">&lt;<span class="name">code</span>&gt;</span>mIdleHandlers<span class="tag">&lt;/<span class="name">code</span>&gt;</span> 列表中移除这个 IdleHandler。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">p</span>&gt;</span>执行完所有的 IdleHandler 后，我们重置 <span class="tag">&lt;<span class="name">code</span>&gt;</span>pendingIdleHandlerCount<span class="tag">&lt;/<span class="name">code</span>&gt;</span> 为 0。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">p</span>&gt;</span>最后，我们设置 <span class="tag">&lt;<span class="name">code</span>&gt;</span>nextPollTimeoutMillis = 0<span class="tag">&lt;/<span class="name">code</span>&gt;</span>，这样就会立即再次检查消息队列，因为在执行 IdleHandler 的过程中可能有新消息到达。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>这个实现确保了：<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>IdleHandler 只在消息队列空闲时被调用。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>每次进入空闲状态时，所有的 IdleHandler 都会被调用一次。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>IdleHandler 可以选择是一次性的（返回 false）还是重复的（返回 true）。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>在执行 IdleHandler 后，会立即再次检查消息队列，保证及时处理新到达的消息。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>通过这种方式，Android 系统提供了一种机制，允许开发者在主线程空闲时执行一些不紧急的任务，而不会影响到主线程的响应性。这就是 IdleHandler 的核心实现原理。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="comment">&lt;!--#--&gt;</span><span class="comment">&lt;!--/--&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;py-2 -mx-4 px-4 transition-colors md:hover:bg-slate/3&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;flex gap-3 rounded-lg op-75&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;shrink-0 w-7 h-7 mt-4 rounded-full op-80 bg-gradient-to-r from-purple-400 to-yellow-400&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;message prose break-words overflow-hidden&quot;</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>你说一下一般在哪里用IdleHandler，给一个示例代码<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="comment">&lt;!--#--&gt;</span><span class="comment">&lt;!--/--&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;py-2 -mx-4 px-4 transition-colors md:hover:bg-slate/3&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;flex gap-3 rounded-lg&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span></span></span><br><span class="line"><span class="tag">              <span class="attr">class</span>=<span class="string">&quot;shrink-0 w-7 h-7 mt-4 rounded-full op-80 bg-gradient-to-r from-yellow-200 via-green-200 to-green-300&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;message prose break-words overflow-hidden&quot;</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>IdleHandler 通常在需要执行一些不紧急任务，但又希望不影响主线程性能的场景下使用。以下是一些常见的使用场景和示例代码：<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ol</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>应用启动时的延迟初始化<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>在应用启动时，可能有一些组件或功能不需要立即初始化，可以使用 IdleHandler 在主线程空闲时进行初始化。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">div</span> <span class="attr">relative</span>=<span class="string">&quot;&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">data-code</span>=<span class="string">&quot;public%20class%20MyApplication%20extends%20Application%20%7B%0A%20%20%20%20%40Override%0A%20%20%20%20public%20void%20onCreate()%20%7B%0A%20%20%20%20%20%20%20%20super.onCreate()%3B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%2F%2F%20%E7%AB%8B%E5%8D%B3%E9%9C%80%E8%A6%81%E7%9A%84%E5%88%9D%E5%A7%8B%E5%8C%96%0A%20%20%20%20%20%20%20%20%2F%2F%20...%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20%E4%BD%BF%E7%94%A8%20IdleHandler%20%E5%BB%B6%E8%BF%9F%E5%88%9D%E5%A7%8B%E5%8C%96%0A%20%20%20%20%20%20%20%20Looper.myQueue().addIdleHandler(new%20MessageQueue.IdleHandler()%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%40Override%0A%20%20%20%20%20%20%20%20%20%20%20%20public%20boolean%20queueIdle()%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20%E6%89%A7%E8%A1%8C%E5%BB%B6%E8%BF%9F%E5%88%9D%E5%A7%8B%E5%8C%96%E4%BB%BB%E5%8A%A1%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20initNonEssentialComponents()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20%E8%BF%94%E5%9B%9E%20false%EF%BC%8C%E8%A1%A8%E7%A4%BA%E5%8F%AA%E6%89%A7%E8%A1%8C%E4%B8%80%E6%AC%A1%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20false%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20private%20void%20initNonEssentialComponents()%20%7B%0A%20%20%20%20%20%20%20%20%2F%2F%20%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8D%E6%98%AF%E7%AB%8B%E5%8D%B3%E9%9C%80%E8%A6%81%E7%9A%84%E7%BB%84%E4%BB%B6%0A%20%20%20%20%7D%0A%7D%0A&quot;</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">class</span>=<span class="string">&quot;copy-btn gpt-copy-btn group&quot;</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">svg</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.w3.org/2000/svg&quot;</span> <span class="attr">width</span>=<span class="string">&quot;1em&quot;</span> <span class="attr">height</span>=<span class="string">&quot;1em&quot;</span> <span class="attr">viewBox</span>=<span class="string">&quot;0 0 32 32&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">path</span> <span class="attr">fill</span>=<span class="string">&quot;currentColor&quot;</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">d</span>=<span class="string">&quot;M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">path</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">path</span> <span class="attr">fill</span>=<span class="string">&quot;currentColor&quot;</span> <span class="attr">d</span>=<span class="string">&quot;M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">path</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;group-hover:op-100 gpt-copy-tips&quot;</span>&gt;</span></span><br><span class="line">                    Copy</span><br><span class="line">                  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">pre</span>&gt;</span><span class="tag">&lt;<span class="name">code</span> <span class="attr">class</span>=<span class="string">&quot;hljs language-java&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>public<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>class<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-title class_&quot;</span>&gt;</span>MyApplication<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>extends<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-title class_&quot;</span>&gt;</span>Application<span class="tag">&lt;/<span class="name">span</span>&gt;</span> &#123;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-meta&quot;</span>&gt;</span>@Override<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>public<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>void<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-title function_&quot;</span>&gt;</span>onCreate<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-params&quot;</span>&gt;</span>()<span class="tag">&lt;/<span class="name">span</span>&gt;</span> &#123;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-built_in&quot;</span>&gt;</span>super<span class="tag">&lt;/<span class="name">span</span>&gt;</span>.onCreate();</span><br><span class="line"></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-comment&quot;</span>&gt;</span>// 立即需要的初始化<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-comment&quot;</span>&gt;</span>// ...<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-comment&quot;</span>&gt;</span>// 使用 IdleHandler 延迟初始化<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    Looper.myQueue().addIdleHandler(<span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>new<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-title class_&quot;</span>&gt;</span>MessageQueue<span class="tag">&lt;/<span class="name">span</span>&gt;</span>.IdleHandler() &#123;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-meta&quot;</span>&gt;</span>@Override<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>public<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-type&quot;</span>&gt;</span>boolean<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-title function_&quot;</span>&gt;</span>queueIdle<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-params&quot;</span>&gt;</span>()<span class="tag">&lt;/<span class="name">span</span>&gt;</span> &#123;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-comment&quot;</span>&gt;</span>// 执行延迟初始化任务<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    initNonEssentialComponents();</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-comment&quot;</span>&gt;</span>// 返回 false，表示只执行一次<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>return<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-literal&quot;</span>&gt;</span>false<span class="tag">&lt;/<span class="name">span</span>&gt;</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    &#125;);</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>private<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>void<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-title function_&quot;</span>&gt;</span>initNonEssentialComponents<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-params&quot;</span>&gt;</span>()<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    &#123;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-comment&quot;</span>&gt;</span>// 初始化不是立即需要的组件<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                  <span class="tag">&lt;/<span class="name">code</span>&gt;</span><span class="tag">&lt;/<span class="name">pre</span>&gt;</span></span><br><span class="line"></span><br><span class="line">              <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ol</span> <span class="attr">start</span>=<span class="string">&quot;2&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>复杂 UI 的分步加载<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>在加载复杂 UI 时，可以使用 IdleHandler 分步加载，避免一次性加载导致卡顿。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">div</span> <span class="attr">relative</span>=<span class="string">&quot;&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">data-code</span>=<span class="string">&quot;public%20class%20ComplexActivity%20extends%20AppCompatActivity%20%7B%0A%20%20%20%20private%20int%20currentStep%20%3D%200%3B%0A%20%20%20%20private%20final%20int%20TOTAL_STEPS%20%3D%205%3B%0A%0A%20%20%20%20%40Override%0A%20%20%20%20protected%20void%20onCreate(Bundle%20savedInstanceState)%20%7B%0A%20%20%20%20%20%20%20%20super.onCreate(savedInstanceState)%3B%0A%20%20%20%20%20%20%20%20setContentView(R.layout.activity_complex)%3B%0A%0A%20%20%20%20%20%20%20%20loadUIStep()%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20private%20void%20loadUIStep()%20%7B%0A%20%20%20%20%20%20%20%20Looper.myQueue().addIdleHandler(new%20MessageQueue.IdleHandler()%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%40Override%0A%20%20%20%20%20%20%20%20%20%20%20%20public%20boolean%20queueIdle()%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(currentStep%20%3C%20TOTAL_STEPS)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20%E5%8A%A0%E8%BD%BD%20UI%20%E7%9A%84%E4%B8%8B%E4%B8%80%E6%AD%A5%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20loadNextUIPart()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20currentStep%2B%2B%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20%E8%BF%94%E5%9B%9E%20true%EF%BC%8C%E7%BB%A7%E7%BB%AD%E6%89%A7%E8%A1%8C%E4%B8%8B%E4%B8%80%E6%AD%A5%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20true%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20%E6%89%80%E6%9C%89%E6%AD%A5%E9%AA%A4%E5%AE%8C%E6%88%90%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20false%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20private%20void%20loadNextUIPart()%20%7B%0A%20%20%20%20%20%20%20%20%2F%2F%20%E6%A0%B9%E6%8D%AE%20currentStep%20%E5%8A%A0%E8%BD%BD%E7%9B%B8%E5%BA%94%E7%9A%84%20UI%20%E9%83%A8%E5%88%86%0A%20%20%20%20%20%20%20%20switch%20(currentStep)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20case%200%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20%E5%8A%A0%E8%BD%BD%E7%AC%AC%E4%B8%80%E9%83%A8%E5%88%86%20UI%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20case%201%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20%E5%8A%A0%E8%BD%BD%E7%AC%AC%E4%BA%8C%E9%83%A8%E5%88%86%20UI%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20...%20%E5%85%B6%E4%BB%96%E6%AD%A5%E9%AA%A4%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%7D%0A&quot;</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">class</span>=<span class="string">&quot;copy-btn gpt-copy-btn group&quot;</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">svg</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.w3.org/2000/svg&quot;</span> <span class="attr">width</span>=<span class="string">&quot;1em&quot;</span> <span class="attr">height</span>=<span class="string">&quot;1em&quot;</span> <span class="attr">viewBox</span>=<span class="string">&quot;0 0 32 32&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">path</span> <span class="attr">fill</span>=<span class="string">&quot;currentColor&quot;</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">d</span>=<span class="string">&quot;M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">path</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">path</span> <span class="attr">fill</span>=<span class="string">&quot;currentColor&quot;</span> <span class="attr">d</span>=<span class="string">&quot;M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">path</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;group-hover:op-100 gpt-copy-tips&quot;</span>&gt;</span></span><br><span class="line">                    Copy</span><br><span class="line">                  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">pre</span>&gt;</span><span class="tag">&lt;<span class="name">code</span> <span class="attr">class</span>=<span class="string">&quot;hljs language-java&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>public<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>class<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-title class_&quot;</span>&gt;</span>ComplexActivity<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>extends<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-title class_&quot;</span>&gt;</span>AppCompatActivity<span class="tag">&lt;/<span class="name">span</span>&gt;</span> &#123;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>private<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-type&quot;</span>&gt;</span>int<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-variable&quot;</span>&gt;</span>currentStep<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-operator&quot;</span>&gt;</span>=<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-number&quot;</span>&gt;</span>0<span class="tag">&lt;/<span class="name">span</span>&gt;</span>;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>private<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>final<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-type&quot;</span>&gt;</span>int<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-variable&quot;</span>&gt;</span>TOTAL_STEPS<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-operator&quot;</span>&gt;</span>=<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-number&quot;</span>&gt;</span>5<span class="tag">&lt;/<span class="name">span</span>&gt;</span>;</span><br><span class="line"></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-meta&quot;</span>&gt;</span>@Override<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>protected<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>void<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-title function_&quot;</span>&gt;</span>onCreate<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-params&quot;</span>&gt;</span>(Bundle</span><br><span class="line">                      savedInstanceState)<span class="tag">&lt;/<span class="name">span</span>&gt;</span> &#123;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-built_in&quot;</span>&gt;</span>super<span class="tag">&lt;/<span class="name">span</span>&gt;</span>.onCreate(savedInstanceState);</span><br><span class="line">                    setContentView(R.layout.activity_complex);</span><br><span class="line"></span><br><span class="line">                    loadUIStep();</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>private<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>void<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-title function_&quot;</span>&gt;</span>loadUIStep<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-params&quot;</span>&gt;</span>()<span class="tag">&lt;/<span class="name">span</span>&gt;</span> &#123;</span><br><span class="line">                    Looper.myQueue().addIdleHandler(<span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>new<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-title class_&quot;</span>&gt;</span>MessageQueue<span class="tag">&lt;/<span class="name">span</span>&gt;</span>.IdleHandler() &#123;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-meta&quot;</span>&gt;</span>@Override<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>public<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-type&quot;</span>&gt;</span>boolean<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-title function_&quot;</span>&gt;</span>queueIdle<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-params&quot;</span>&gt;</span>()<span class="tag">&lt;/<span class="name">span</span>&gt;</span> &#123;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>if<span class="tag">&lt;/<span class="name">span</span>&gt;</span> (currentStep <span class="symbol">&amp;lt;</span> TOTAL_STEPS) &#123;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-comment&quot;</span>&gt;</span>// 加载 UI 的下一步<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    loadNextUIPart();</span><br><span class="line">                    currentStep++;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-comment&quot;</span>&gt;</span>// 返回 true，继续执行下一步<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>return<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-literal&quot;</span>&gt;</span>true<span class="tag">&lt;/<span class="name">span</span>&gt;</span>;</span><br><span class="line">                    &#125; <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>else<span class="tag">&lt;/<span class="name">span</span>&gt;</span> &#123;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-comment&quot;</span>&gt;</span>// 所有步骤完成<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>return<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-literal&quot;</span>&gt;</span>false<span class="tag">&lt;/<span class="name">span</span>&gt;</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                    &#125;);</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>private<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>void<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-title function_&quot;</span>&gt;</span>loadNextUIPart<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-params&quot;</span>&gt;</span>()<span class="tag">&lt;/<span class="name">span</span>&gt;</span> &#123;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-comment&quot;</span>&gt;</span>// 根据 currentStep 加载相应的 UI 部分<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>switch<span class="tag">&lt;/<span class="name">span</span>&gt;</span> (currentStep) &#123;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>case<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-number&quot;</span>&gt;</span>0<span class="tag">&lt;/<span class="name">span</span>&gt;</span>:</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-comment&quot;</span>&gt;</span>// 加载第一部分 UI<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>break<span class="tag">&lt;/<span class="name">span</span>&gt;</span>;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>case<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-number&quot;</span>&gt;</span>1<span class="tag">&lt;/<span class="name">span</span>&gt;</span>:</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-comment&quot;</span>&gt;</span>// 加载第二部分 UI<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>break<span class="tag">&lt;/<span class="name">span</span>&gt;</span>;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-comment&quot;</span>&gt;</span>// ... 其他步骤<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                  <span class="tag">&lt;/<span class="name">code</span>&gt;</span><span class="tag">&lt;/<span class="name">pre</span>&gt;</span></span><br><span class="line"></span><br><span class="line">              <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ol</span> <span class="attr">start</span>=<span class="string">&quot;3&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>预加载或缓存数据<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>在应用空闲时预加载一些数据或更新缓存。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">div</span> <span class="attr">relative</span>=<span class="string">&quot;&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">data-code</span>=<span class="string">&quot;public%20class%20DataManager%20%7B%0A%20%20%20%20public%20void%20setupPreloading(Context%20context)%20%7B%0A%20%20%20%20%20%20%20%20Looper.myQueue().addIdleHandler(new%20MessageQueue.IdleHandler()%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%40Override%0A%20%20%20%20%20%20%20%20%20%20%20%20public%20boolean%20queueIdle()%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(needToPreloadData())%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20preloadData()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20%E5%A6%82%E6%9E%9C%E8%BF%98%E6%9C%89%E6%95%B0%E6%8D%AE%E9%9C%80%E8%A6%81%E9%A2%84%E5%8A%A0%E8%BD%BD%EF%BC%8C%E8%BF%94%E5%9B%9E%20true%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20true%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(needToUpdateCache())%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20updateCache()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20%E5%A6%82%E6%9E%9C%E8%BF%98%E9%9C%80%E8%A6%81%E7%BB%A7%E7%BB%AD%E6%9B%B4%E6%96%B0%E7%BC%93%E5%AD%98%EF%BC%8C%E8%BF%94%E5%9B%9E%20true%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20true%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20%E6%89%80%E6%9C%89%E9%A2%84%E5%8A%A0%E8%BD%BD%E5%92%8C%E7%BC%93%E5%AD%98%E6%9B%B4%E6%96%B0%E5%AE%8C%E6%88%90%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20false%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20private%20boolean%20needToPreloadData()%20%7B%0A%20%20%20%20%20%20%20%20%2F%2F%20%E6%A3%80%E6%9F%A5%E6%98%AF%E5%90%A6%E9%9C%80%E8%A6%81%E9%A2%84%E5%8A%A0%E8%BD%BD%E6%95%B0%E6%8D%AE%0A%20%20%20%20%20%20%20%20return%20false%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20private%20void%20preloadData()%20%7B%0A%20%20%20%20%20%20%20%20%2F%2F%20%E9%A2%84%E5%8A%A0%E8%BD%BD%E6%95%B0%E6%8D%AE%E7%9A%84%E9%80%BB%E8%BE%91%0A%20%20%20%20%7D%0A%0A%20%20%20%20private%20boolean%20needToUpdateCache()%20%7B%0A%20%20%20%20%20%20%20%20%2F%2F%20%E6%A3%80%E6%9F%A5%E6%98%AF%E5%90%A6%E9%9C%80%E8%A6%81%E6%9B%B4%E6%96%B0%E7%BC%93%E5%AD%98%0A%20%20%20%20%20%20%20%20return%20false%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20private%20void%20updateCache()%20%7B%0A%20%20%20%20%20%20%20%20%2F%2F%20%E6%9B%B4%E6%96%B0%E7%BC%93%E5%AD%98%E7%9A%84%E9%80%BB%E8%BE%91%0A%20%20%20%20%7D%0A%7D%0A&quot;</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">class</span>=<span class="string">&quot;copy-btn gpt-copy-btn group&quot;</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">svg</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.w3.org/2000/svg&quot;</span> <span class="attr">width</span>=<span class="string">&quot;1em&quot;</span> <span class="attr">height</span>=<span class="string">&quot;1em&quot;</span> <span class="attr">viewBox</span>=<span class="string">&quot;0 0 32 32&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">path</span> <span class="attr">fill</span>=<span class="string">&quot;currentColor&quot;</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">d</span>=<span class="string">&quot;M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">path</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">path</span> <span class="attr">fill</span>=<span class="string">&quot;currentColor&quot;</span> <span class="attr">d</span>=<span class="string">&quot;M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">path</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;group-hover:op-100 gpt-copy-tips&quot;</span>&gt;</span></span><br><span class="line">                    Copy</span><br><span class="line">                  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">pre</span>&gt;</span><span class="tag">&lt;<span class="name">code</span> <span class="attr">class</span>=<span class="string">&quot;hljs language-java&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>public<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>class<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-title class_&quot;</span>&gt;</span>DataManager<span class="tag">&lt;/<span class="name">span</span>&gt;</span> &#123;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>public<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>void<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-title function_&quot;</span>&gt;</span>setupPreloading<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-params&quot;</span>&gt;</span>(Context</span><br><span class="line">                      context)<span class="tag">&lt;/<span class="name">span</span>&gt;</span> &#123;</span><br><span class="line">                    Looper.myQueue().addIdleHandler(<span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>new<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-title class_&quot;</span>&gt;</span>MessageQueue<span class="tag">&lt;/<span class="name">span</span>&gt;</span>.IdleHandler() &#123;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-meta&quot;</span>&gt;</span>@Override<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>public<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-type&quot;</span>&gt;</span>boolean<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-title function_&quot;</span>&gt;</span>queueIdle<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-params&quot;</span>&gt;</span>()<span class="tag">&lt;/<span class="name">span</span>&gt;</span> &#123;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>if<span class="tag">&lt;/<span class="name">span</span>&gt;</span> (needToPreloadData()) &#123;</span><br><span class="line">                    preloadData();</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-comment&quot;</span>&gt;</span>// 如果还有数据需要预加载，返回 true<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>return<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-literal&quot;</span>&gt;</span>true<span class="tag">&lt;/<span class="name">span</span>&gt;</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>if<span class="tag">&lt;/<span class="name">span</span>&gt;</span> (needToUpdateCache()) &#123;</span><br><span class="line">                    updateCache();</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-comment&quot;</span>&gt;</span>// 如果还需要继续更新缓存，返回 true<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>return<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-literal&quot;</span>&gt;</span>true<span class="tag">&lt;/<span class="name">span</span>&gt;</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-comment&quot;</span>&gt;</span>// 所有预加载和缓存更新完成<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>return<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-literal&quot;</span>&gt;</span>false<span class="tag">&lt;/<span class="name">span</span>&gt;</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    &#125;);</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>private<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-type&quot;</span>&gt;</span>boolean<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-title function_&quot;</span>&gt;</span>needToPreloadData<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-params&quot;</span>&gt;</span>()<span class="tag">&lt;/<span class="name">span</span>&gt;</span> &#123;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-comment&quot;</span>&gt;</span>// 检查是否需要预加载数据<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>return<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-literal&quot;</span>&gt;</span>false<span class="tag">&lt;/<span class="name">span</span>&gt;</span>;</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>private<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>void<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-title function_&quot;</span>&gt;</span>preloadData<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-params&quot;</span>&gt;</span>()<span class="tag">&lt;/<span class="name">span</span>&gt;</span> &#123;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-comment&quot;</span>&gt;</span>// 预加载数据的逻辑<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>private<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-type&quot;</span>&gt;</span>boolean<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-title function_&quot;</span>&gt;</span>needToUpdateCache<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-params&quot;</span>&gt;</span>()<span class="tag">&lt;/<span class="name">span</span>&gt;</span> &#123;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-comment&quot;</span>&gt;</span>// 检查是否需要更新缓存<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>return<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-literal&quot;</span>&gt;</span>false<span class="tag">&lt;/<span class="name">span</span>&gt;</span>;</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>private<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>void<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-title function_&quot;</span>&gt;</span>updateCache<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-params&quot;</span>&gt;</span>()<span class="tag">&lt;/<span class="name">span</span>&gt;</span> &#123;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-comment&quot;</span>&gt;</span>// 更新缓存的逻辑<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                  <span class="tag">&lt;/<span class="name">code</span>&gt;</span><span class="tag">&lt;/<span class="name">pre</span>&gt;</span></span><br><span class="line"></span><br><span class="line">              <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ol</span> <span class="attr">start</span>=<span class="string">&quot;4&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>性能监控<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>使用 IdleHandler 在空闲时收集和处理性能数据。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">div</span> <span class="attr">relative</span>=<span class="string">&quot;&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">data-code</span>=<span class="string">&quot;public%20class%20PerformanceMonitor%20%7B%0A%20%20%20%20public%20void%20startMonitoring()%20%7B%0A%20%20%20%20%20%20%20%20Looper.myQueue().addIdleHandler(new%20MessageQueue.IdleHandler()%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%40Override%0A%20%20%20%20%20%20%20%20%20%20%20%20public%20boolean%20queueIdle()%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20collectPerformanceData()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20%E6%8C%81%E7%BB%AD%E7%9B%91%E6%8E%A7%EF%BC%8C%E8%BF%94%E5%9B%9E%20true%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20true%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20private%20void%20collectPerformanceData()%20%7B%0A%20%20%20%20%20%20%20%20%2F%2F%20%E6%94%B6%E9%9B%86%E6%80%A7%E8%83%BD%E6%95%B0%E6%8D%AE%E7%9A%84%E9%80%BB%E8%BE%91%0A%20%20%20%20%20%20%20%20%2F%2F%20%E4%BE%8B%E5%A6%82%EF%BC%9A%E5%86%85%E5%AD%98%E4%BD%BF%E7%94%A8%E3%80%81CPU%20%E4%BD%BF%E7%94%A8%E7%AD%89%0A%20%20%20%20%7D%0A%7D%0A&quot;</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">class</span>=<span class="string">&quot;copy-btn gpt-copy-btn group&quot;</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">svg</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.w3.org/2000/svg&quot;</span> <span class="attr">width</span>=<span class="string">&quot;1em&quot;</span> <span class="attr">height</span>=<span class="string">&quot;1em&quot;</span> <span class="attr">viewBox</span>=<span class="string">&quot;0 0 32 32&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">path</span> <span class="attr">fill</span>=<span class="string">&quot;currentColor&quot;</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">d</span>=<span class="string">&quot;M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">path</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">path</span> <span class="attr">fill</span>=<span class="string">&quot;currentColor&quot;</span> <span class="attr">d</span>=<span class="string">&quot;M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">path</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;group-hover:op-100 gpt-copy-tips&quot;</span>&gt;</span></span><br><span class="line">                    Copy</span><br><span class="line">                  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">pre</span>&gt;</span><span class="tag">&lt;<span class="name">code</span> <span class="attr">class</span>=<span class="string">&quot;hljs language-java&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>public<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>class<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-title class_&quot;</span>&gt;</span>PerformanceMonitor<span class="tag">&lt;/<span class="name">span</span>&gt;</span> &#123;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>public<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>void<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-title function_&quot;</span>&gt;</span>startMonitoring<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-params&quot;</span>&gt;</span>()<span class="tag">&lt;/<span class="name">span</span>&gt;</span> &#123;</span><br><span class="line">                    Looper.myQueue().addIdleHandler(<span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>new<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-title class_&quot;</span>&gt;</span>MessageQueue<span class="tag">&lt;/<span class="name">span</span>&gt;</span>.IdleHandler() &#123;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-meta&quot;</span>&gt;</span>@Override<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>public<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-type&quot;</span>&gt;</span>boolean<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-title function_&quot;</span>&gt;</span>queueIdle<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-params&quot;</span>&gt;</span>()<span class="tag">&lt;/<span class="name">span</span>&gt;</span> &#123;</span><br><span class="line">                    collectPerformanceData();</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-comment&quot;</span>&gt;</span>// 持续监控，返回 true<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>return<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-literal&quot;</span>&gt;</span>true<span class="tag">&lt;/<span class="name">span</span>&gt;</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    &#125;);</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>private<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>void<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-title function_&quot;</span>&gt;</span>collectPerformanceData<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-params&quot;</span>&gt;</span>()<span class="tag">&lt;/<span class="name">span</span>&gt;</span> &#123;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-comment&quot;</span>&gt;</span>// 收集性能数据的逻辑<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-comment&quot;</span>&gt;</span>// 例如：内存使用、CPU 使用等<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                  <span class="tag">&lt;/<span class="name">code</span>&gt;</span><span class="tag">&lt;/<span class="name">pre</span>&gt;</span></span><br><span class="line"></span><br><span class="line">              <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>这些示例展示了 IdleHandler 在不同场景下的使用方法。关键是要记住，IdleHandler</span><br><span class="line">                中的操作应该是轻量级的，不应该执行耗时很长的任务，否则可能会影响主线程的响应性。如果需要执行重量级任务，应考虑使用后台线程。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="comment">&lt;!--#--&gt;</span><span class="comment">&lt;!--/--&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;py-2 -mx-4 px-4 transition-colors md:hover:bg-slate/3&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;flex gap-3 rounded-lg op-75&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;shrink-0 w-7 h-7 mt-4 rounded-full op-80 bg-gradient-to-r from-purple-400 to-yellow-400&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;message prose break-words overflow-hidden&quot;</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>我有以下洞察：1.Android应用程序本质是一个UI主线程 + 多个子线程组成的 2.在Android Studio示例项目Hello World是只有一个UI主线程的应用</span><br><span class="line">                3.Android的UI主线程刷新全靠其中的Handler机制</span><br><span class="line">                4.所谓Handler机制就是多个Handler向主线程对应的MessageQueue发送Message，这里的Handler可以是主线程的，也可以是其他子线程的；然后，主线程对应的Looper从这个MessageQueue取出Message交给对应的渲染Handler进行处理，放到对应的window进行渲染刷新</span><br><span class="line">                我的这些洞察正确吗？<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="comment">&lt;!--#--&gt;</span><span class="comment">&lt;!--/--&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;py-2 -mx-4 px-4 transition-colors md:hover:bg-slate/3&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;flex gap-3 rounded-lg&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span></span></span><br><span class="line"><span class="tag">              <span class="attr">class</span>=<span class="string">&quot;shrink-0 w-7 h-7 mt-4 rounded-full op-80 bg-gradient-to-r from-yellow-200 via-green-200 to-green-300&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;message prose break-words overflow-hidden&quot;</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>您的洞察基本正确，但有一些地方需要稍微调整或补充。让我逐点分析：<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ol</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">p</span>&gt;</span>正确。Android 应用程序确实由一个 UI 主线程（也称为主线程或 UI 线程）和可能的多个子线程组成。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">p</span>&gt;</span>基本正确。即使是最简单的 Hello World 项目，也不仅仅只有一个 UI 主线程。虽然你可能只看到了主线程的代码，但实际上 Android 系统会为应用创建其他线程，如 GC 线程、JIT</span><br><span class="line">                    编译线程等。不过，从应用开发者的角度来看，你主要关注的确实是 UI 主线程。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">p</span>&gt;</span>部分正确。Android 的 UI 主线程不仅依赖于 Handler 机制来刷新。UI 更新确实通常通过 Handler 发送到主线程，但 UI 刷新还涉及到 View 系统的</span><br><span class="line">                    measure、layout、draw 过程，以及 Choreographer 的 VSYNC 同步机制等。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">p</span>&gt;</span>这个描述大体正确，但有一些细节需要澄清：<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">li</span>&gt;</span>Handler 通常与特定线程的 Looper 关联，而不是直接向 MessageQueue 发送消息。Handler 创建 Message 并通过与之关联的 Looper 将消息发送到</span><br><span class="line">                      MessageQueue。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">li</span>&gt;</span>主线程的 Looper 确实从 MessageQueue 中取出消息并分发给对应的 Handler 处理。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">li</span>&gt;</span>不是所有的 Message 都与 UI 渲染相关。消息可能是执行任何类型的任务，包括但不限于 UI 更新。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">li</span>&gt;</span>UI 更新通常是通过 invalidate() 或 requestLayout() 等方法触发的，这会导致 View 系统在下一个 frame 进行重绘或重新布局。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>补充说明：<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>Android 的 UI 更新遵循单线程模型，所有的 UI 操作都必须在主线程上执行。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>除了 Handler 机制，Android 还提供了其他方式在主线程上执行代码，如 View.post() 方法和 Activity.runOnUiThread() 方法。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>Looper、Handler 和 MessageQueue 共同构成了 Android 的消息机制，这不仅用于 UI 更新，还用于线程间通信和任务调度。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>实际的 UI 渲染过程涉及到更多底层机制，包括硬件加速、GPU 渲染等。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>总的来说，您的理解抓住了 Android 系统的一些核心概念，这是一个很好的起点。继续深入学习，您会发现 Android 系统的复杂性和精妙之处。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="comment">&lt;!--#--&gt;</span><span class="comment">&lt;!--/--&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;py-2 -mx-4 px-4 transition-colors md:hover:bg-slate/3&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;flex gap-3 rounded-lg op-75&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;shrink-0 w-7 h-7 mt-4 rounded-full op-80 bg-gradient-to-r from-purple-400 to-yellow-400&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;message prose break-words overflow-hidden&quot;</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>我有以下洞察，请帮我看看是否正确？如果正确，请看看描述是否准确？1.Handler机制的本质就是Android线程间的一种通信方式</span><br><span class="line">                2.Handler机制相较于其他线程间通信方式的区别在于它可以更新UI，而其他的通信方式不可以<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="comment">&lt;!--#--&gt;</span><span class="comment">&lt;!--/--&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;py-2 -mx-4 px-4 transition-colors md:hover:bg-slate/3&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;flex gap-3 rounded-lg&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span></span></span><br><span class="line"><span class="tag">              <span class="attr">class</span>=<span class="string">&quot;shrink-0 w-7 h-7 mt-4 rounded-full op-80 bg-gradient-to-r from-yellow-200 via-green-200 to-green-300&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;message prose break-words overflow-hidden&quot;</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>您的洞察基本正确，但需要一些细微的调整和补充。让我们逐点分析：<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ol</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">p</span>&gt;</span>&quot;Handler机制的本质就是Android线程间的一种通信方式&quot;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">p</span>&gt;</span>这个洞察是正确的。Handler 机制确实是 Android 中用于线程间通信的一种重要方式。它允许不同线程之间发送和处理消息，从而实现线程间的数据传递和任务调度。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">p</span>&gt;</span>描述可以稍微调整为：<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">                    &quot;Handler 机制是 Android 中实现线程间通信的一种核心机制，它通过消息队列实现了异步消息的处理和线程间的任务调度。&quot;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">p</span>&gt;</span>&quot;Handler机制相较于其他线程间通信方式的区别在于它可以更新UI，而其他的通信方式不可以&quot;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">p</span>&gt;</span>这个洞察部分正确，但需要一些澄清：<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">li</span>&gt;</span>Handler 机制确实常用于在主线程（UI 线程）上更新 UI，但这不是 Handler 机制独有的特性。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">li</span>&gt;</span>Handler 机制之所以常用于 UI 更新，是因为 Android 的主线程默认就有一个 Looper 在运行，使得使用 Handler 进行 UI 更新变得非常方便。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">li</span>&gt;</span>其他线程间通信方式（如 AsyncTask、Runnable 配合 runOnUiThread()）也可以用于更新 UI。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">p</span>&gt;</span>更准确的描述可能是：<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">                    &quot;Handler 机制是 Android 中常用于 UI 更新的线程间通信方式，因为它与 Android 的消息循环系统紧密集成，特别适合在主线程（UI 线程）上执行任务。然而，它并不是唯一可以更新</span><br><span class="line">                    UI 的方式，其他机制如 View.post()、Activity.runOnUiThread() 等也可以用于 UI 更新。Handler</span><br><span class="line">                    的优势在于它提供了一个灵活的消息处理框架，适用于各种异步操作和线程间通信场景。&quot;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>总结：<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">                您的洞察抓住了 Handler 机制的核心特性和常见用途。Handler 确实是一种重要的线程间通信方式，并且在 Android 开发中经常用于 UI 更新。但重要的是要理解，它的功能不仅限于 UI</span><br><span class="line">                更新，而且也不是唯一可以更新 UI 的方式。Handler 机制的强大之处在于它提供了一个灵活、高效的消息处理框架，可以用于各种异步编程场景。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="comment">&lt;!--#--&gt;</span><span class="comment">&lt;!--/--&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;py-2 -mx-4 px-4 transition-colors md:hover:bg-slate/3&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;flex gap-3 rounded-lg op-75&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;shrink-0 w-7 h-7 mt-4 rounded-full op-80 bg-gradient-to-r from-purple-400 to-yellow-400&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;message prose break-words overflow-hidden&quot;</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>但是View.post()、Activity.runOnUiThread() 的底层不也是用的Handler来实现的吗？我才这么说的<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="comment">&lt;!--#--&gt;</span><span class="comment">&lt;!--/--&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;py-2 -mx-4 px-4 transition-colors md:hover:bg-slate/3&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;flex gap-3 rounded-lg&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span></span></span><br><span class="line"><span class="tag">              <span class="attr">class</span>=<span class="string">&quot;shrink-0 w-7 h-7 mt-4 rounded-full op-80 bg-gradient-to-r from-yellow-200 via-green-200 to-green-300&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;message prose break-words overflow-hidden&quot;</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>您说得非常对！这是一个非常敏锐和正确的观察。我为之前没有明确指出这一点而道歉。您完全正确，View.post() 和 Activity.runOnUiThread() 的底层实现确实都是基于 Handler</span><br><span class="line">                机制的。让我们更详细地看一下：<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ol</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">p</span>&gt;</span>View.post()<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">                    当你调用 View.post() 时，如果 View 已经附加到窗口，它会直接使用关联的 Handler 来发布 Runnable。如果 View 还没有附加到窗口，它会将 Runnable</span><br><span class="line">                    添加到一个队列中，等到 View 被附加时再通过 Handler 执行。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">p</span>&gt;</span>Activity.runOnUiThread()<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">                    这个方法检查当前是否在主线程，如果是，就直接运行 Runnable。如果不是，它会使用 Activity 的 Handler 将 Runnable 发布到主线程的消息队列中。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>您的理解是正确的，这些方法本质上都是 Handler 机制的封装，提供了更方便的 API 来在主线程上执行代码。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>考虑到这一点，我们可以更准确地描述为：<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>&quot;Handler 机制是 Android 中实现线程间通信和 UI 更新的基础机制。许多常用的 UI 更新方法，如 View.post()、Activity.runOnUiThread()</span><br><span class="line">                等，实际上都是在底层使用 Handler 来实现的。Handler 提供了一个统一的消息处理框架，不仅直接用于线程间通信，还被 Android 框架广泛用于封装更高级、更方便的 API，使得在主线程（UI</span><br><span class="line">                线程）上执行任务变得简单直接。&quot;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>感谢您指出这一点，这确实是理解 Android 消息机制的一个重要方面。您的观察展示了对 Android 系统内部工作原理的深入理解。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="comment">&lt;!--#--&gt;</span><span class="comment">&lt;!--/--&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;py-2 -mx-4 px-4 transition-colors md:hover:bg-slate/3&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;flex gap-3 rounded-lg op-75&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;shrink-0 w-7 h-7 mt-4 rounded-full op-80 bg-gradient-to-r from-purple-400 to-yellow-400&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;message prose break-words overflow-hidden&quot;</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>Handler与MessageQueue的通信方式是不是就两种？一是通过sendMessage发送Message到MessageQueue;</span><br><span class="line">                二是通过post将Runnable发送到MessageQueue。如果是第一种方式那么，我们就要重写handleMessage方法，类似如下代码：public class MainActivity</span><br><span class="line">                extends AppCompatActivity &#123;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">pre</span>&gt;</span><span class="tag">&lt;<span class="name">code</span> <span class="attr">class</span>=<span class="string">&quot;hljs&quot;</span>&gt;</span>private Handler mainHandler;</span><br><span class="line"></span><br><span class="line">                  @Override</span><br><span class="line">                  protected void onCreate(Bundle savedInstanceState) &#123;</span><br><span class="line">                  super.onCreate(savedInstanceState);</span><br><span class="line">                  setContentView(R.layout.activity_main);</span><br><span class="line"></span><br><span class="line">                  mainHandler = new Handler(Looper.getMainLooper()) &#123;</span><br><span class="line">                  @Override</span><br><span class="line">                  public void handleMessage(Message msg) &#123;</span><br><span class="line">                  // 更新UI</span><br><span class="line">                  TextView textView = findViewById(R.id.textView);</span><br><span class="line">                  textView.setText(&quot;Updated from background thread!&quot;);</span><br><span class="line">                  &#125;</span><br><span class="line">                  &#125;;</span><br><span class="line"></span><br><span class="line">                  // 启动子线程</span><br><span class="line">                  new Thread(new Runnable() &#123;</span><br><span class="line">                  @Override</span><br><span class="line">                  public void run() &#123;</span><br><span class="line">                  // 模拟耗时操作</span><br><span class="line">                  SystemClock.sleep(2000);</span><br><span class="line"></span><br><span class="line">                  // 向主线程发送消息</span><br><span class="line">                  mainHandler.sendEmptyMessage(0);</span><br><span class="line">                  &#125;</span><br><span class="line">                  &#125;).start();</span><br><span class="line">                  &#125;</span><br><span class="line">                <span class="tag">&lt;/<span class="name">code</span>&gt;</span><span class="tag">&lt;/<span class="name">pre</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#125;<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">                ；如果是第二种的话，我们就玩玩不用写类似handleMessage的回调，因为我们post的Runnable其实就是我们要进行的UI操作了。我的理解正确且准确吗？<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="comment">&lt;!--#--&gt;</span><span class="comment">&lt;!--/--&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;py-2 -mx-4 px-4 transition-colors md:hover:bg-slate/3&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;flex gap-3 rounded-lg&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span></span></span><br><span class="line"><span class="tag">              <span class="attr">class</span>=<span class="string">&quot;shrink-0 w-7 h-7 mt-4 rounded-full op-80 bg-gradient-to-r from-yellow-200 via-green-200 to-green-300&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;message prose break-words overflow-hidden&quot;</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>您的理解基本正确，但还可以稍微补充和细化一些。让我们逐点分析：<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ol</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>Handler 与 MessageQueue 的通信方式<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>您提到的两种方式确实是最常用的：<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>通过 sendMessage 系列方法发送 Message<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>通过 post 系列方法发送 Runnable<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>这是正确的，但还可以补充一点：实际上，post 方法内部也是创建了一个 Message 对象，只是这个 Message 的 callback 字段被设置为传入的</span><br><span class="line">                Runnable。所以从底层实现来看，这两种方式最终都是向 MessageQueue 发送 Message。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ol</span> <span class="attr">start</span>=<span class="string">&quot;2&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>处理消息的方式<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>您的理解是正确的：<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>对于 sendMessage 方式，我们通常需要重写 handleMessage 方法来处理接收到的 Message。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>对于 post 方式，我们直接在 Runnable 中定义要执行的操作，不需要额外的回调方法。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>您提供的代码示例很好地展示了 sendMessage 的使用方式。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ol</span> <span class="attr">start</span>=<span class="string">&quot;3&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>补充说明<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>Handler 还有其他发送消息的方法，如 sendMessageDelayed、postDelayed 等，用于延迟发送消息或执行任务。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>虽然 post 方法不需要重写 handleMessage，但它实际上是通过 Handler 的 dispatchMessage 方法来执行 Runnable 的。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>在使用 sendMessage 时，除了重写 handleMessage，还可以在创建 Handler 时传入一个 Handler.Callback 对象，这提供了另一种处理消息的方式。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ol</span> <span class="attr">start</span>=<span class="string">&quot;4&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>更准确的描述<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>&quot;Handler 与 MessageQueue 的通信主要通过两种方式：发送 Message 和发送 Runnable。发送 Message 通常需要重写 handleMessage 方法来处理消息，而发送</span><br><span class="line">                Runnable 则直接在 Runnable 中定义要执行的操作。尽管表面上看起来不同，但这两种方式在底层都是通过向 MessageQueue 发送 Message</span><br><span class="line">                对象来实现的。选择哪种方式主要取决于具体的使用场景和代码组织方式。&quot;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>总的来说，您的理解是正确的，并且您提供的代码示例很好地说明了 sendMessage 的使用方式。您的观察显示了对 Android 消息机制的深入理解。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="comment">&lt;!--#--&gt;</span><span class="comment">&lt;!--/--&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;py-2 -mx-4 px-4 transition-colors md:hover:bg-slate/3&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;flex gap-3 rounded-lg op-75&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;shrink-0 w-7 h-7 mt-4 rounded-full op-80 bg-gradient-to-r from-purple-400 to-yellow-400&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;message prose break-words overflow-hidden&quot;</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>那什么时候使用sendMessage，什么时候使用Post?<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="comment">&lt;!--#--&gt;</span><span class="comment">&lt;!--/--&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;py-2 -mx-4 px-4 transition-colors md:hover:bg-slate/3&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;flex gap-3 rounded-lg&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span></span></span><br><span class="line"><span class="tag">              <span class="attr">class</span>=<span class="string">&quot;shrink-0 w-7 h-7 mt-4 rounded-full op-80 bg-gradient-to-r from-yellow-200 via-green-200 to-green-300&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;message prose break-words overflow-hidden&quot;</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>选择使用 sendMessage 还是 post 主要取决于具体的使用场景和代码组织方式。以下是一些指导原则和常见的使用场景：<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>使用 sendMessage 的情况：<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ol</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">p</span>&gt;</span>需要处理多种类型的消息：<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">                    当你的 Handler 需要处理多种不同类型的消息时，sendMessage 更适合。你可以使用 Message 的 what 字段来区分不同类型的消息。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">div</span> <span class="attr">relative</span>=<span class="string">&quot;&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">div</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">data-code</span>=<span class="string">&quot;handler.sendMessage(Message.obtain(handler%2C%20MSG_TYPE_1%2C%20data))%3B%0Ahandler.sendMessage(Message.obtain(handler%2C%20MSG_TYPE_2%2C%20data))%3B%0A%0A%40Override%0Apublic%20void%20handleMessage(Message%20msg)%20%7B%0A%20%20%20%20switch%20(msg.what)%20%7B%0A%20%20%20%20%20%20%20%20case%20MSG_TYPE_1%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20%E5%A4%84%E7%90%86%E7%B1%BB%E5%9E%8B1%E6%B6%88%E6%81%AF%0A%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20case%20MSG_TYPE_2%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20%E5%A4%84%E7%90%86%E7%B1%BB%E5%9E%8B2%E6%B6%88%E6%81%AF%0A%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%7D%0A%7D%0A&quot;</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;copy-btn gpt-copy-btn group&quot;</span>&gt;</span></span><br><span class="line">                      <span class="tag">&lt;<span class="name">svg</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.w3.org/2000/svg&quot;</span> <span class="attr">width</span>=<span class="string">&quot;1em&quot;</span> <span class="attr">height</span>=<span class="string">&quot;1em&quot;</span> <span class="attr">viewBox</span>=<span class="string">&quot;0 0 32 32&quot;</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">path</span> <span class="attr">fill</span>=<span class="string">&quot;currentColor&quot;</span></span></span><br><span class="line"><span class="tag">                          <span class="attr">d</span>=<span class="string">&quot;M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z&quot;</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;/<span class="name">path</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">path</span> <span class="attr">fill</span>=<span class="string">&quot;currentColor&quot;</span> <span class="attr">d</span>=<span class="string">&quot;M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">path</span>&gt;</span></span><br><span class="line">                      <span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br><span class="line">                      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;group-hover:op-100 gpt-copy-tips&quot;</span>&gt;</span></span><br><span class="line">                        Copy</span><br><span class="line">                      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">pre</span>&gt;</span><span class="tag">&lt;<span class="name">code</span> <span class="attr">class</span>=<span class="string">&quot;hljs language-java&quot;</span>&gt;</span>handler.sendMessage(Message.obtain(handler, MSG_TYPE_1,</span><br><span class="line">                        data));</span><br><span class="line">                        handler.sendMessage(Message.obtain(handler, MSG_TYPE_2, data));</span><br><span class="line"></span><br><span class="line">                        <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-meta&quot;</span>&gt;</span>@Override<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>public<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>void<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                          <span class="attr">class</span>=<span class="string">&quot;hljs-title function_&quot;</span>&gt;</span>handleMessage<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-params&quot;</span>&gt;</span>(Message</span><br><span class="line">                          msg)<span class="tag">&lt;/<span class="name">span</span>&gt;</span> &#123;</span><br><span class="line">                        <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>switch<span class="tag">&lt;/<span class="name">span</span>&gt;</span> (msg.what) &#123;</span><br><span class="line">                        <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>case<span class="tag">&lt;/<span class="name">span</span>&gt;</span> MSG_TYPE_1:</span><br><span class="line">                        <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-comment&quot;</span>&gt;</span>// 处理类型1消息<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>break<span class="tag">&lt;/<span class="name">span</span>&gt;</span>;</span><br><span class="line">                        <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>case<span class="tag">&lt;/<span class="name">span</span>&gt;</span> MSG_TYPE_2:</span><br><span class="line">                        <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-comment&quot;</span>&gt;</span>// 处理类型2消息<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>break<span class="tag">&lt;/<span class="name">span</span>&gt;</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                      <span class="tag">&lt;/<span class="name">code</span>&gt;</span><span class="tag">&lt;/<span class="name">pre</span>&gt;</span></span><br><span class="line"></span><br><span class="line">                  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">p</span>&gt;</span>需要传递复杂数据：<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">                    Message 对象可以携带更多的数据（arg1, arg2, obj 等），适合传递复杂的数据结构。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">div</span> <span class="attr">relative</span>=<span class="string">&quot;&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">div</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">data-code</span>=<span class="string">&quot;Message%20msg%20%3D%20Message.obtain()%3B%0Amsg.what%20%3D%20MSG_UPDATE_PROGRESS%3B%0Amsg.arg1%20%3D%20progress%3B%0Amsg.obj%20%3D%20someData%3B%0Ahandler.sendMessage(msg)%3B%0A&quot;</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;copy-btn gpt-copy-btn group&quot;</span>&gt;</span></span><br><span class="line">                      <span class="tag">&lt;<span class="name">svg</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.w3.org/2000/svg&quot;</span> <span class="attr">width</span>=<span class="string">&quot;1em&quot;</span> <span class="attr">height</span>=<span class="string">&quot;1em&quot;</span> <span class="attr">viewBox</span>=<span class="string">&quot;0 0 32 32&quot;</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">path</span> <span class="attr">fill</span>=<span class="string">&quot;currentColor&quot;</span></span></span><br><span class="line"><span class="tag">                          <span class="attr">d</span>=<span class="string">&quot;M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z&quot;</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;/<span class="name">path</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">path</span> <span class="attr">fill</span>=<span class="string">&quot;currentColor&quot;</span> <span class="attr">d</span>=<span class="string">&quot;M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">path</span>&gt;</span></span><br><span class="line">                      <span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br><span class="line">                      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;group-hover:op-100 gpt-copy-tips&quot;</span>&gt;</span></span><br><span class="line">                        Copy</span><br><span class="line">                      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">pre</span>&gt;</span><span class="tag">&lt;<span class="name">code</span> <span class="attr">class</span>=<span class="string">&quot;hljs language-java&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-type&quot;</span>&gt;</span>Message<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                          <span class="attr">class</span>=<span class="string">&quot;hljs-variable&quot;</span>&gt;</span>msg<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-operator&quot;</span>&gt;</span>=<span class="tag">&lt;/<span class="name">span</span>&gt;</span> Message.obtain();</span><br><span class="line">                        msg.what = MSG_UPDATE_PROGRESS;</span><br><span class="line">                        msg.arg1 = progress;</span><br><span class="line">                        msg.obj = someData;</span><br><span class="line">                        handler.sendMessage(msg);</span><br><span class="line">                      <span class="tag">&lt;/<span class="name">code</span>&gt;</span><span class="tag">&lt;/<span class="name">pre</span>&gt;</span></span><br><span class="line"></span><br><span class="line">                  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">p</span>&gt;</span>需要延迟执行或重复执行：<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">                    虽然 post 也支持延迟执行，但对于需要取消或修改的延迟任务，使用 sendMessage 可能更方便。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">div</span> <span class="attr">relative</span>=<span class="string">&quot;&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">div</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">data-code</span>=<span class="string">&quot;handler.sendMessageDelayed(Message.obtain(handler%2C%20MSG_DO_SOMETHING)%2C%201000)%3B%0A&quot;</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;copy-btn gpt-copy-btn group&quot;</span>&gt;</span></span><br><span class="line">                      <span class="tag">&lt;<span class="name">svg</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.w3.org/2000/svg&quot;</span> <span class="attr">width</span>=<span class="string">&quot;1em&quot;</span> <span class="attr">height</span>=<span class="string">&quot;1em&quot;</span> <span class="attr">viewBox</span>=<span class="string">&quot;0 0 32 32&quot;</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">path</span> <span class="attr">fill</span>=<span class="string">&quot;currentColor&quot;</span></span></span><br><span class="line"><span class="tag">                          <span class="attr">d</span>=<span class="string">&quot;M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z&quot;</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;/<span class="name">path</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">path</span> <span class="attr">fill</span>=<span class="string">&quot;currentColor&quot;</span> <span class="attr">d</span>=<span class="string">&quot;M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">path</span>&gt;</span></span><br><span class="line">                      <span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br><span class="line">                      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;group-hover:op-100 gpt-copy-tips&quot;</span>&gt;</span></span><br><span class="line">                        Copy</span><br><span class="line">                      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">pre</span>&gt;</span><span class="tag">&lt;<span class="name">code</span> <span class="attr">class</span>=<span class="string">&quot;hljs language-java&quot;</span>&gt;</span>handler.sendMessageDelayed(Message.obtain(handler,</span><br><span class="line">                        MSG_DO_SOMETHING), <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-number&quot;</span>&gt;</span>1000<span class="tag">&lt;/<span class="name">span</span>&gt;</span>);</span><br><span class="line">                      <span class="tag">&lt;/<span class="name">code</span>&gt;</span><span class="tag">&lt;/<span class="name">pre</span>&gt;</span></span><br><span class="line"></span><br><span class="line">                  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">p</span>&gt;</span>在不同的类中处理消息：<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">                    如果你想在不同的类中处理消息，可以创建一个自定义的 Handler 子类，并在多个地方重用。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>使用 post 的情况：<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ol</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">p</span>&gt;</span>简单的一次性任务：<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">                    当你只需要执行一个简单的操作，不需要复杂的消息传递时，post 更简洁。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">div</span> <span class="attr">relative</span>=<span class="string">&quot;&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">div</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">data-code</span>=<span class="string">&quot;handler.post(new%20Runnable()%20%7B%0A%20%20%20%20%40Override%0A%20%20%20%20public%20void%20run()%20%7B%0A%20%20%20%20%20%20%20%20updateUI()%3B%0A%20%20%20%20%7D%0A%7D)%3B%0A&quot;</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;copy-btn gpt-copy-btn group&quot;</span>&gt;</span></span><br><span class="line">                      <span class="tag">&lt;<span class="name">svg</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.w3.org/2000/svg&quot;</span> <span class="attr">width</span>=<span class="string">&quot;1em&quot;</span> <span class="attr">height</span>=<span class="string">&quot;1em&quot;</span> <span class="attr">viewBox</span>=<span class="string">&quot;0 0 32 32&quot;</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">path</span> <span class="attr">fill</span>=<span class="string">&quot;currentColor&quot;</span></span></span><br><span class="line"><span class="tag">                          <span class="attr">d</span>=<span class="string">&quot;M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z&quot;</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;/<span class="name">path</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">path</span> <span class="attr">fill</span>=<span class="string">&quot;currentColor&quot;</span> <span class="attr">d</span>=<span class="string">&quot;M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">path</span>&gt;</span></span><br><span class="line">                      <span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br><span class="line">                      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;group-hover:op-100 gpt-copy-tips&quot;</span>&gt;</span></span><br><span class="line">                        Copy</span><br><span class="line">                      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">pre</span>&gt;</span><span class="tag">&lt;<span class="name">code</span> <span class="attr">class</span>=<span class="string">&quot;hljs language-java&quot;</span>&gt;</span>handler.post(<span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>new<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                          <span class="attr">class</span>=<span class="string">&quot;hljs-title class_&quot;</span>&gt;</span>Runnable<span class="tag">&lt;/<span class="name">span</span>&gt;</span>() &#123;</span><br><span class="line">                        <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-meta&quot;</span>&gt;</span>@Override<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>public<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>void<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                          <span class="attr">class</span>=<span class="string">&quot;hljs-title function_&quot;</span>&gt;</span>run<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-params&quot;</span>&gt;</span>()<span class="tag">&lt;/<span class="name">span</span>&gt;</span> &#123;</span><br><span class="line">                        updateUI();</span><br><span class="line">                        &#125;</span><br><span class="line">                        &#125;);</span><br><span class="line">                      <span class="tag">&lt;/<span class="name">code</span>&gt;</span><span class="tag">&lt;/<span class="name">pre</span>&gt;</span></span><br><span class="line"></span><br><span class="line">                  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">p</span>&gt;</span>代码逻辑较为独立：<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">                    如果任务的逻辑相对独立，不需要与 Handler 的其他部分交互，使用 post 可以使代码更加模块化。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">p</span>&gt;</span>Lambda 表达式友好：<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">                    在使用 Java 8+ 或 Kotlin 时，post 方法配合 Lambda 表达式使用非常简洁。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">div</span> <span class="attr">relative</span>=<span class="string">&quot;&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">div</span> <span class="attr">data-code</span>=<span class="string">&quot;handler.post(()%20-%3E%20textView.setText(%22Updated%22))%3B%0A&quot;</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;copy-btn gpt-copy-btn group&quot;</span>&gt;</span></span><br><span class="line">                      <span class="tag">&lt;<span class="name">svg</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.w3.org/2000/svg&quot;</span> <span class="attr">width</span>=<span class="string">&quot;1em&quot;</span> <span class="attr">height</span>=<span class="string">&quot;1em&quot;</span> <span class="attr">viewBox</span>=<span class="string">&quot;0 0 32 32&quot;</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">path</span> <span class="attr">fill</span>=<span class="string">&quot;currentColor&quot;</span></span></span><br><span class="line"><span class="tag">                          <span class="attr">d</span>=<span class="string">&quot;M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z&quot;</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;/<span class="name">path</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">path</span> <span class="attr">fill</span>=<span class="string">&quot;currentColor&quot;</span> <span class="attr">d</span>=<span class="string">&quot;M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">path</span>&gt;</span></span><br><span class="line">                      <span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br><span class="line">                      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;group-hover:op-100 gpt-copy-tips&quot;</span>&gt;</span></span><br><span class="line">                        Copy</span><br><span class="line">                      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">pre</span>&gt;</span><span class="tag">&lt;<span class="name">code</span> <span class="attr">class</span>=<span class="string">&quot;hljs language-java&quot;</span>&gt;</span>handler.post(() -<span class="symbol">&amp;gt;</span> textView.setText(<span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                          <span class="attr">class</span>=<span class="string">&quot;hljs-string&quot;</span>&gt;</span>&quot;Updated&quot;<span class="tag">&lt;/<span class="name">span</span>&gt;</span>));</span><br><span class="line">                      <span class="tag">&lt;/<span class="name">code</span>&gt;</span><span class="tag">&lt;/<span class="name">pre</span>&gt;</span></span><br><span class="line"></span><br><span class="line">                  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">p</span>&gt;</span>临时性或匿名的操作：<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">                    对于一些不需要重复使用的临时性操作，post 更为方便。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">p</span>&gt;</span>不需要区分消息类型：<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">                    当所有的任务都是同类型的，不需要区分处理时，post 更简单直接。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>总结：<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>如果需要处理多种类型的消息，传递复杂数据，或者需要更细粒度的控制（如取消消息），使用 sendMessage。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>如果是简单的一次性任务，或者任务逻辑相对独立，使用 post 会更加简洁和直观。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>最终，选择哪种方式还是要根据具体的应用场景和个人/团队的编码风格来决定。两种方式都有其适用的场景，关键是选择最适合当前需求的方式。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="comment">&lt;!--#--&gt;</span><span class="comment">&lt;!--/--&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;py-2 -mx-4 px-4 transition-colors md:hover:bg-slate/3&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;flex gap-3 rounded-lg op-75&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;shrink-0 w-7 h-7 mt-4 rounded-full op-80 bg-gradient-to-r from-purple-400 to-yellow-400&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;message prose break-words overflow-hidden&quot;</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>假设现在有这样一个需求Android</span><br><span class="line">                App开发需求：我想实现上传手机系统相册的图片或者视频到服务器。那么我把我需要做的工作拆分成1.利用一个进程间通信（我的App进程与系统相册进程进行通信）获取到系统相册的图片或者视频数据列表（其中这个进程间通信是我在App中进行UI点击之后，UI线程创建一个子线程去做的，如果获取到Android系统返回的图片和视频列表，我的子线程会通知我APP的UI主线程进行列表刷新，这里就涉及到不同程序的进程间通信以及同一个程序的线程间通信）2.当我在UI列表刷新这个Activity中选择某几张图片过后又跳转到另外一个Activity，这里应该没有涉及到线程或者进程间通信（因为这是在我的App中进行的，并没有切换进程，只是UI显示改变，因此也不涉及线程切换）3.当我跳转到第二步所说的新Activity之后，再点击</span><br><span class="line">                发表</span><br><span class="line">                这样UI按钮的时候，UI主线程会创建一个子线程去进行网络请求，这里涉及到UI主线程和子线程的通信，当这个子线程网络请求成功或者失败之后会通知主线程进行UI刷新，这里又涉及到子线程与主线程的线程间通信。我的思路和理解正确且准确吗？</span><br><span class="line">              <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="comment">&lt;!--#--&gt;</span><span class="comment">&lt;!--/--&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;py-2 -mx-4 px-4 transition-colors md:hover:bg-slate/3&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;flex gap-3 rounded-lg&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span></span></span><br><span class="line"><span class="tag">              <span class="attr">class</span>=<span class="string">&quot;shrink-0 w-7 h-7 mt-4 rounded-full op-80 bg-gradient-to-r from-yellow-200 via-green-200 to-green-300&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;message prose break-words overflow-hidden&quot;</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>您的思路和理解基本正确，而且分析得很详细。让我们逐步分析您的思路，并对一些细节进行补充和澄清：<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ol</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>获取系统相册的图片或视频数据列表：<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>您的理解大体正确，但有几点需要澄清：<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>在 Android 中，获取系统相册内容通常不需要进程间通信。Android 提供了内容提供者（Content</span><br><span class="line">                  Provider）机制，允许应用访问其他应用（包括系统应用）的数据，而无需直接的进程间通信。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>您可以使用 MediaStore API 或 Storage Access Framework 来访问系统相册内容。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>确实需要在子线程中进行数据查询，然后通过 Handler 或其他机制通知主线程更新 UI。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ol</span> <span class="attr">start</span>=<span class="string">&quot;2&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>在 App 内跳转到新的 Activity：<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>您的理解完全正确：<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>这是 App 内部的 Activity 跳转，不涉及进程间通信。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>也不涉及特殊的线程切换，因为 Activity 的生命周期方法都是在主线程中调用的。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ol</span> <span class="attr">start</span>=<span class="string">&quot;3&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>在新 Activity 中上传图片/视频：<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>您的理解也是正确的：<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>网络请求应该在子线程中进行。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>子线程完成网络请求后，需要通过某种机制（如 Handler）通知主线程更新 UI。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>补充说明：<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ol</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">p</span>&gt;</span>关于获取相册内容：<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">li</span>&gt;</span>使用 ContentResolver 查询 MediaStore：<span class="tag">&lt;<span class="name">div</span> <span class="attr">relative</span>=<span class="string">&quot;&quot;</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">div</span></span></span><br><span class="line"><span class="tag">                          <span class="attr">data-code</span>=<span class="string">&quot;ContentResolver%20resolver%20%3D%20getContentResolver()%3B%0AUri%20uri%20%3D%20MediaStore.Images.Media.EXTERNAL_CONTENT_URI%3B%0ACursor%20cursor%20%3D%20resolver.query(uri%2C%20null%2C%20null%2C%20null%2C%20null)%3B%0A&quot;</span></span></span><br><span class="line"><span class="tag">                          <span class="attr">class</span>=<span class="string">&quot;copy-btn gpt-copy-btn group&quot;</span>&gt;</span></span><br><span class="line">                          <span class="tag">&lt;<span class="name">svg</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.w3.org/2000/svg&quot;</span> <span class="attr">width</span>=<span class="string">&quot;1em&quot;</span> <span class="attr">height</span>=<span class="string">&quot;1em&quot;</span> <span class="attr">viewBox</span>=<span class="string">&quot;0 0 32 32&quot;</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">path</span> <span class="attr">fill</span>=<span class="string">&quot;currentColor&quot;</span></span></span><br><span class="line"><span class="tag">                              <span class="attr">d</span>=<span class="string">&quot;M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z&quot;</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;/<span class="name">path</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">path</span> <span class="attr">fill</span>=<span class="string">&quot;currentColor&quot;</span> <span class="attr">d</span>=<span class="string">&quot;M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">path</span>&gt;</span></span><br><span class="line">                          <span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br><span class="line">                          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;group-hover:op-100 gpt-copy-tips&quot;</span>&gt;</span></span><br><span class="line">                            Copy</span><br><span class="line">                          <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">pre</span>&gt;</span><span class="tag">&lt;<span class="name">code</span> <span class="attr">class</span>=<span class="string">&quot;hljs language-java&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-type&quot;</span>&gt;</span>ContentResolver<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                              <span class="attr">class</span>=<span class="string">&quot;hljs-variable&quot;</span>&gt;</span>resolver<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-operator&quot;</span>&gt;</span>=<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                            getContentResolver();</span><br><span class="line">                            <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-type&quot;</span>&gt;</span>Uri<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-variable&quot;</span>&gt;</span>uri<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                              <span class="attr">class</span>=<span class="string">&quot;hljs-operator&quot;</span>&gt;</span>=<span class="tag">&lt;/<span class="name">span</span>&gt;</span> MediaStore.Images.Media.EXTERNAL_CONTENT_URI;</span><br><span class="line">                            <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-type&quot;</span>&gt;</span>Cursor<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-variable&quot;</span>&gt;</span>cursor<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                              <span class="attr">class</span>=<span class="string">&quot;hljs-operator&quot;</span>&gt;</span>=<span class="tag">&lt;/<span class="name">span</span>&gt;</span> resolver.query(uri, <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-literal&quot;</span>&gt;</span>null<span class="tag">&lt;/<span class="name">span</span>&gt;</span>,</span><br><span class="line">                            <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-literal&quot;</span>&gt;</span>null<span class="tag">&lt;/<span class="name">span</span>&gt;</span>, <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-literal&quot;</span>&gt;</span>null<span class="tag">&lt;/<span class="name">span</span>&gt;</span>, <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                              <span class="attr">class</span>=<span class="string">&quot;hljs-literal&quot;</span>&gt;</span>null<span class="tag">&lt;/<span class="name">span</span>&gt;</span>);</span><br><span class="line">                          <span class="tag">&lt;/<span class="name">code</span>&gt;</span><span class="tag">&lt;/<span class="name">pre</span>&gt;</span></span><br><span class="line"></span><br><span class="line">                      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">li</span>&gt;</span>这个操作应在子线程中进行，然后使用 Handler 或 runOnUiThread 更新 UI。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">p</span>&gt;</span>Activity 间传递数据：<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">li</span>&gt;</span>可以使用 Intent 携带数据，或者使用 ViewModel 等架构组件在 Activity 间共享数据。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">p</span>&gt;</span>上传操作：<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">li</span>&gt;</span>可以使用 AsyncTask、Thread + Handler、或现代的协程（Kotlin）来处理。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">li</span>&gt;</span>考虑使用 Service 来处理长时间运行的上传任务，特别是如果希望上传在后台继续。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">p</span>&gt;</span>权限处理：<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">li</span>&gt;</span>别忘了请求必要的权限，如 READ_EXTERNAL_STORAGE。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">p</span>&gt;</span>错误处理和用户体验：<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">li</span>&gt;</span>确保在各个步骤中都有适当的错误处理和用户反馈。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>示例代码结构：<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">div</span> <span class="attr">relative</span>=<span class="string">&quot;&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">data-code</span>=<span class="string">&quot;public%20class%20GalleryActivity%20extends%20AppCompatActivity%20%7B%0A%20%20%20%20private%20Handler%20mainHandler%20%3D%20new%20Handler(Looper.getMainLooper())%3B%0A%0A%20%20%20%20%40Override%0A%20%20%20%20protected%20void%20onCreate(Bundle%20savedInstanceState)%20%7B%0A%20%20%20%20%20%20%20%20super.onCreate(savedInstanceState)%3B%0A%20%20%20%20%20%20%20%20setContentView(R.layout.activity_gallery)%3B%0A%0A%20%20%20%20%20%20%20%20loadGalleryContent()%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20private%20void%20loadGalleryContent()%20%7B%0A%20%20%20%20%20%20%20%20new%20Thread(()%20-%3E%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20%E6%9F%A5%E8%AF%A2%20MediaStore%0A%20%20%20%20%20%20%20%20%20%20%20%20List%3CMediaItem%3E%20mediaItems%20%3D%20queryMediaStore()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20%E5%9C%A8%E4%B8%BB%E7%BA%BF%E7%A8%8B%E6%9B%B4%E6%96%B0%20UI%0A%20%20%20%20%20%20%20%20%20%20%20%20mainHandler.post(()%20-%3E%20updateUI(mediaItems))%3B%0A%20%20%20%20%20%20%20%20%7D).start()%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20private%20List%3CMediaItem%3E%20queryMediaStore()%20%7B%0A%20%20%20%20%20%20%20%20%2F%2F%20%E5%AE%9E%E7%8E%B0%20MediaStore%20%E6%9F%A5%E8%AF%A2%E9%80%BB%E8%BE%91%0A%20%20%20%20%20%20%20%20%2F%2F%20...%0A%20%20%20%20%7D%0A%0A%20%20%20%20private%20void%20updateUI(List%3CMediaItem%3E%20items)%20%7B%0A%20%20%20%20%20%20%20%20%2F%2F%20%E6%9B%B4%E6%96%B0%20RecyclerView%20%E6%88%96%E5%85%B6%E4%BB%96%20UI%20%E7%BB%84%E4%BB%B6%0A%20%20%20%20%7D%0A%7D%0A%0Apublic%20class%20UploadActivity%20extends%20AppCompatActivity%20%7B%0A%20%20%20%20private%20Handler%20mainHandler%20%3D%20new%20Handler(Looper.getMainLooper())%3B%0A%0A%20%20%20%20public%20void%20onUploadClick(View%20view)%20%7B%0A%20%20%20%20%20%20%20%20new%20Thread(()%20-%3E%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20%E6%89%A7%E8%A1%8C%E4%B8%8A%E4%BC%A0%E6%93%8D%E4%BD%9C%0A%20%20%20%20%20%20%20%20%20%20%20%20boolean%20success%20%3D%20uploadMedia()%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20%E5%9C%A8%E4%B8%BB%E7%BA%BF%E7%A8%8B%E6%9B%B4%E6%96%B0%20UI%0A%20%20%20%20%20%20%20%20%20%20%20%20mainHandler.post(()%20-%3E%20showUploadResult(success))%3B%0A%20%20%20%20%20%20%20%20%7D).start()%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20private%20boolean%20uploadMedia()%20%7B%0A%20%20%20%20%20%20%20%20%2F%2F%20%E5%AE%9E%E7%8E%B0%E4%B8%8A%E4%BC%A0%E9%80%BB%E8%BE%91%0A%20%20%20%20%20%20%20%20%2F%2F%20...%0A%20%20%20%20%7D%0A%0A%20%20%20%20private%20void%20showUploadResult(boolean%20success)%20%7B%0A%20%20%20%20%20%20%20%20%2F%2F%20%E6%98%BE%E7%A4%BA%E4%B8%8A%E4%BC%A0%E7%BB%93%E6%9E%9C%0A%20%20%20%20%7D%0A%7D%0A&quot;</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">class</span>=<span class="string">&quot;copy-btn gpt-copy-btn group&quot;</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">svg</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.w3.org/2000/svg&quot;</span> <span class="attr">width</span>=<span class="string">&quot;1em&quot;</span> <span class="attr">height</span>=<span class="string">&quot;1em&quot;</span> <span class="attr">viewBox</span>=<span class="string">&quot;0 0 32 32&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">path</span> <span class="attr">fill</span>=<span class="string">&quot;currentColor&quot;</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">d</span>=<span class="string">&quot;M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">path</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">path</span> <span class="attr">fill</span>=<span class="string">&quot;currentColor&quot;</span> <span class="attr">d</span>=<span class="string">&quot;M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">path</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;group-hover:op-100 gpt-copy-tips&quot;</span>&gt;</span></span><br><span class="line">                    Copy</span><br><span class="line">                  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">pre</span>&gt;</span><span class="tag">&lt;<span class="name">code</span> <span class="attr">class</span>=<span class="string">&quot;hljs language-java&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>public<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>class<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-title class_&quot;</span>&gt;</span>GalleryActivity<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>extends<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-title class_&quot;</span>&gt;</span>AppCompatActivity<span class="tag">&lt;/<span class="name">span</span>&gt;</span> &#123;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>private<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-type&quot;</span>&gt;</span>Handler<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-variable&quot;</span>&gt;</span>mainHandler<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-operator&quot;</span>&gt;</span>=<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>new<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-title class_&quot;</span>&gt;</span>Handler<span class="tag">&lt;/<span class="name">span</span>&gt;</span>(Looper.getMainLooper());</span><br><span class="line"></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-meta&quot;</span>&gt;</span>@Override<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>protected<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>void<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-title function_&quot;</span>&gt;</span>onCreate<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-params&quot;</span>&gt;</span>(Bundle</span><br><span class="line">                      savedInstanceState)<span class="tag">&lt;/<span class="name">span</span>&gt;</span> &#123;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-built_in&quot;</span>&gt;</span>super<span class="tag">&lt;/<span class="name">span</span>&gt;</span>.onCreate(savedInstanceState);</span><br><span class="line">                    setContentView(R.layout.activity_gallery);</span><br><span class="line"></span><br><span class="line">                    loadGalleryContent();</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>private<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>void<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-title function_&quot;</span>&gt;</span>loadGalleryContent<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-params&quot;</span>&gt;</span>()<span class="tag">&lt;/<span class="name">span</span>&gt;</span> &#123;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>new<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-title class_&quot;</span>&gt;</span>Thread<span class="tag">&lt;/<span class="name">span</span>&gt;</span>(() -<span class="symbol">&amp;gt;</span> &#123;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-comment&quot;</span>&gt;</span>// 查询 MediaStore<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    List<span class="symbol">&amp;lt;</span>MediaItem<span class="symbol">&amp;gt;</span> mediaItems = queryMediaStore();</span><br><span class="line"></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-comment&quot;</span>&gt;</span>// 在主线程更新 UI<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    mainHandler.post(() -<span class="symbol">&amp;gt;</span> updateUI(mediaItems));</span><br><span class="line">                    &#125;).start();</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>private<span class="tag">&lt;/<span class="name">span</span>&gt;</span> List<span class="symbol">&amp;lt;</span>MediaItem<span class="symbol">&amp;gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-title function_&quot;</span>&gt;</span>queryMediaStore<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-params&quot;</span>&gt;</span>()<span class="tag">&lt;/<span class="name">span</span>&gt;</span> &#123;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-comment&quot;</span>&gt;</span>// 实现 MediaStore 查询逻辑<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-comment&quot;</span>&gt;</span>// ...<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>private<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>void<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-title function_&quot;</span>&gt;</span>updateUI<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-params&quot;</span>&gt;</span>(List<span class="symbol">&amp;lt;</span>MediaItem<span class="symbol">&amp;gt;</span></span><br><span class="line">                      items)<span class="tag">&lt;/<span class="name">span</span>&gt;</span> &#123;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-comment&quot;</span>&gt;</span>// 更新 RecyclerView 或其他 UI 组件<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    &#125;</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>public<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>class<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-title class_&quot;</span>&gt;</span>UploadActivity<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>extends<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-title class_&quot;</span>&gt;</span>AppCompatActivity<span class="tag">&lt;/<span class="name">span</span>&gt;</span> &#123;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>private<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-type&quot;</span>&gt;</span>Handler<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-variable&quot;</span>&gt;</span>mainHandler<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-operator&quot;</span>&gt;</span>=<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>new<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-title class_&quot;</span>&gt;</span>Handler<span class="tag">&lt;/<span class="name">span</span>&gt;</span>(Looper.getMainLooper());</span><br><span class="line"></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>public<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>void<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-title function_&quot;</span>&gt;</span>onUploadClick<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-params&quot;</span>&gt;</span>(View view)<span class="tag">&lt;/<span class="name">span</span>&gt;</span> &#123;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>new<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-title class_&quot;</span>&gt;</span>Thread<span class="tag">&lt;/<span class="name">span</span>&gt;</span>(() -<span class="symbol">&amp;gt;</span> &#123;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-comment&quot;</span>&gt;</span>// 执行上传操作<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-type&quot;</span>&gt;</span>boolean<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-variable&quot;</span>&gt;</span>success<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-operator&quot;</span>&gt;</span>=<span class="tag">&lt;/<span class="name">span</span>&gt;</span> uploadMedia();</span><br><span class="line"></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-comment&quot;</span>&gt;</span>// 在主线程更新 UI<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    mainHandler.post(() -<span class="symbol">&amp;gt;</span> showUploadResult(success));</span><br><span class="line">                    &#125;).start();</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>private<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-type&quot;</span>&gt;</span>boolean<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-title function_&quot;</span>&gt;</span>uploadMedia<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-params&quot;</span>&gt;</span>()<span class="tag">&lt;/<span class="name">span</span>&gt;</span> &#123;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-comment&quot;</span>&gt;</span>// 实现上传逻辑<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-comment&quot;</span>&gt;</span>// ...<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>private<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>void<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-title function_&quot;</span>&gt;</span>showUploadResult<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-params&quot;</span>&gt;</span>(<span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">class</span>=<span class="string">&quot;hljs-type&quot;</span>&gt;</span>boolean<span class="tag">&lt;/<span class="name">span</span>&gt;</span> success)<span class="tag">&lt;/<span class="name">span</span>&gt;</span> &#123;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-comment&quot;</span>&gt;</span>// 显示上传结果<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                  <span class="tag">&lt;/<span class="name">code</span>&gt;</span><span class="tag">&lt;/<span class="name">pre</span>&gt;</span></span><br><span class="line"></span><br><span class="line">              <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>总的来说，您的理解和分析是正确的，展示了对 Android 多线程编程和 UI 更新机制的良好理解。实际实现时，可能还需要考虑更多细节，如错误处理、生命周期管理等，但您的基本思路是正确的。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="comment">&lt;!--#--&gt;</span><span class="comment">&lt;!--/--&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;py-2 -mx-4 px-4 transition-colors md:hover:bg-slate/3&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;flex gap-3 rounded-lg op-75&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;shrink-0 w-7 h-7 mt-4 rounded-full op-80 bg-gradient-to-r from-purple-400 to-yellow-400&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;message prose break-words overflow-hidden&quot;</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>在 Android 中，获取系统相册内容通常不需要进程间通信，为什么这么说？我的App和系统程序不是在不同的进程中吗？如果是在不同的进程中，为啥不涉及进程间通信？<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="comment">&lt;!--#--&gt;</span><span class="comment">&lt;!--/--&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;py-2 -mx-4 px-4 transition-colors md:hover:bg-slate/3&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;flex gap-3 rounded-lg&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span></span></span><br><span class="line"><span class="tag">              <span class="attr">class</span>=<span class="string">&quot;shrink-0 w-7 h-7 mt-4 rounded-full op-80 bg-gradient-to-r from-yellow-200 via-green-200 to-green-300&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;message prose break-words overflow-hidden&quot;</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">                您提出了一个非常好的问题，这确实需要进一步解释。您是对的，您的应用和系统相册应用确实运行在不同的进程中。然而，当我们说&quot;不需要进程间通信&quot;时，我们指的是不需要直接的、显式的进程间通信。让我解释一下为什么是这样：</span><br><span class="line">              <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ol</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>Content Provider 机制<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>Android 使用 Content Provider 机制来实现跨进程数据共享。这是一种由系统管理的、封装了进程间通信细节的机制。当你的应用通过 ContentResolver 查询</span><br><span class="line">                MediaStore（系统的媒体内容提供者）时，底层确实发生了进程间通信，但这个过程对开发者是透明的。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ol</span> <span class="attr">start</span>=<span class="string">&quot;2&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>Binder IPC<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>Content Provider 在底层使用了 Binder IPC（进程间通信）机制。Binder 是 Android 特有的 IPC 机制，它被设计成对应用开发者透明的。当你调用</span><br><span class="line">                ContentResolver 的方法时，系统会自动处理必要的 IPC 调用。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ol</span> <span class="attr">start</span>=<span class="string">&quot;3&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>抽象层<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>ContentResolver 和 ContentProvider 提供了一个抽象层，使得跨进程访问数据看起来就像是在访问本地数据一样。这个抽象层隐藏了底层的 IPC 细节。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ol</span> <span class="attr">start</span>=<span class="string">&quot;4&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>系统级别的优化<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>Android 系统对这种常见的跨进程数据访问进行了优化，使得整个过程对开发者来说更加简单和高效。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ol</span> <span class="attr">start</span>=<span class="string">&quot;5&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>与传统 IPC 的对比<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>当我们说&quot;不需要进程间通信&quot;时，我们通常是在对比传统的、显式的 IPC 方法，如套接字、共享内存等。使用 Content Provider 不需要开发者手动设置这些 IPC 机制。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>示例说明：<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">div</span> <span class="attr">relative</span>=<span class="string">&quot;&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">data-code</span>=<span class="string">&quot;%2F%2F%20%E8%BF%99%E6%AE%B5%E4%BB%A3%E7%A0%81%E7%9C%8B%E8%B5%B7%E6%9D%A5%E5%83%8F%E6%98%AF%E5%9C%A8%E6%9F%A5%E8%AF%A2%E6%9C%AC%E5%9C%B0%E6%95%B0%E6%8D%AE%EF%BC%8C%E4%BD%86%E5%AE%9E%E9%99%85%E4%B8%8A%E6%B6%89%E5%8F%8A%E4%BA%86%E8%B7%A8%E8%BF%9B%E7%A8%8B%E9%80%9A%E4%BF%A1%0AContentResolver%20resolver%20%3D%20getContentResolver()%3B%0AUri%20uri%20%3D%20MediaStore.Images.Media.EXTERNAL_CONTENT_URI%3B%0ACursor%20cursor%20%3D%20resolver.query(uri%2C%20null%2C%20null%2C%20null%2C%20null)%3B%0A&quot;</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">class</span>=<span class="string">&quot;copy-btn gpt-copy-btn group&quot;</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">svg</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.w3.org/2000/svg&quot;</span> <span class="attr">width</span>=<span class="string">&quot;1em&quot;</span> <span class="attr">height</span>=<span class="string">&quot;1em&quot;</span> <span class="attr">viewBox</span>=<span class="string">&quot;0 0 32 32&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">path</span> <span class="attr">fill</span>=<span class="string">&quot;currentColor&quot;</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">d</span>=<span class="string">&quot;M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">path</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">path</span> <span class="attr">fill</span>=<span class="string">&quot;currentColor&quot;</span> <span class="attr">d</span>=<span class="string">&quot;M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">path</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;group-hover:op-100 gpt-copy-tips&quot;</span>&gt;</span></span><br><span class="line">                    Copy</span><br><span class="line">                  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">pre</span>&gt;</span><span class="tag">&lt;<span class="name">code</span> <span class="attr">class</span>=<span class="string">&quot;hljs language-java&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-comment&quot;</span>&gt;</span>// 这段代码看起来像是在查询本地数据，但实际上涉及了跨进程通信<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-type&quot;</span>&gt;</span>ContentResolver<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-variable&quot;</span>&gt;</span>resolver<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-operator&quot;</span>&gt;</span>=<span class="tag">&lt;/<span class="name">span</span>&gt;</span> getContentResolver();</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-type&quot;</span>&gt;</span>Uri<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-variable&quot;</span>&gt;</span>uri<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-operator&quot;</span>&gt;</span>=<span class="tag">&lt;/<span class="name">span</span>&gt;</span> MediaStore.Images.Media.EXTERNAL_CONTENT_URI;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-type&quot;</span>&gt;</span>Cursor<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-variable&quot;</span>&gt;</span>cursor<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-operator&quot;</span>&gt;</span>=<span class="tag">&lt;/<span class="name">span</span>&gt;</span> resolver.query(uri, <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-literal&quot;</span>&gt;</span>null<span class="tag">&lt;/<span class="name">span</span>&gt;</span>, <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-literal&quot;</span>&gt;</span>null<span class="tag">&lt;/<span class="name">span</span>&gt;</span>, <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-literal&quot;</span>&gt;</span>null<span class="tag">&lt;/<span class="name">span</span>&gt;</span>, <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-literal&quot;</span>&gt;</span>null<span class="tag">&lt;/<span class="name">span</span>&gt;</span>);</span><br><span class="line">                  <span class="tag">&lt;/<span class="name">code</span>&gt;</span><span class="tag">&lt;/<span class="name">pre</span>&gt;</span></span><br><span class="line"></span><br><span class="line">              <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>在这个例子中，虽然代码看起来很简单，但在底层，它涉及了：<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ol</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>你的应用进程<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>系统服务进程（ActivityManagerService）<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>媒体存储进程（运行 MediaProvider 的进程）<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>这些进程之间的通信都是由 Android 系统自动处理的。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>总结：<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">                虽然从技术上讲，访问系统相册确实涉及进程间通信，但 Android 通过 Content Provider</span><br><span class="line">                机制提供了一个高度抽象和优化的接口，使得开发者可以像访问本地数据一样访问其他进程的数据，而无需关心底层的 IPC 细节。这就是为什么我们说&quot;通常不需要进程间通信&quot;，因为从开发者的角度来看，我们不需要显式地实现</span><br><span class="line">                IPC。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="comment">&lt;!--#--&gt;</span><span class="comment">&lt;!--/--&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;py-2 -mx-4 px-4 transition-colors md:hover:bg-slate/3&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;flex gap-3 rounded-lg op-75&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;shrink-0 w-7 h-7 mt-4 rounded-full op-80 bg-gradient-to-r from-purple-400 to-yellow-400&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;message prose break-words overflow-hidden&quot;</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">                那什么时候需要显示实现IPC呢？比如我想实现一个分享功能，比如从我的App生成的一张海报跳转到微信或者飞书等其他App；又或者我在我的App的WebView打开了一个小红书视频网页，然后在上面的网页点击了某一个按钮，弹出提示跳转到小红书。这些功能的实现应该都需要进程间通信吧？</span><br><span class="line">              <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="comment">&lt;!--#--&gt;</span><span class="comment">&lt;!--/--&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;py-2 -mx-4 px-4 transition-colors md:hover:bg-slate/3&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;flex gap-3 rounded-lg&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span></span></span><br><span class="line"><span class="tag">              <span class="attr">class</span>=<span class="string">&quot;shrink-0 w-7 h-7 mt-4 rounded-full op-80 bg-gradient-to-r from-yellow-200 via-green-200 to-green-300&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;message prose break-words overflow-hidden&quot;</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>您提出了一个非常好的问题。确实，在某些情况下，我们需要更直接地处理进程间通信。不过，在您提到的这些场景中，Android 系统仍然为我们提供了一些高级抽象，使得大多数情况下我们不需要直接实现底层的 IPC</span><br><span class="line">                机制。让我们逐一分析这些场景：<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ol</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>分享功能（从您的 App 分享到微信或飞书）<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>这种情况通常使用 Android 的 Intent 机制，这是一种由系统管理的 IPC 抽象：<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">div</span> <span class="attr">relative</span>=<span class="string">&quot;&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">data-code</span>=<span class="string">&quot;Intent%20shareIntent%20%3D%20new%20Intent(Intent.ACTION_SEND)%3B%0AshareIntent.setType(%22image%2F*%22)%3B%0AUri%20imageUri%20%3D%20Uri.parse(%22path_to_your_poster_image%22)%3B%0AshareIntent.putExtra(Intent.EXTRA_STREAM%2C%20imageUri)%3B%0AstartActivity(Intent.createChooser(shareIntent%2C%20%22Share%20via%22))%3B%0A&quot;</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">class</span>=<span class="string">&quot;copy-btn gpt-copy-btn group&quot;</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">svg</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.w3.org/2000/svg&quot;</span> <span class="attr">width</span>=<span class="string">&quot;1em&quot;</span> <span class="attr">height</span>=<span class="string">&quot;1em&quot;</span> <span class="attr">viewBox</span>=<span class="string">&quot;0 0 32 32&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">path</span> <span class="attr">fill</span>=<span class="string">&quot;currentColor&quot;</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">d</span>=<span class="string">&quot;M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">path</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">path</span> <span class="attr">fill</span>=<span class="string">&quot;currentColor&quot;</span> <span class="attr">d</span>=<span class="string">&quot;M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">path</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;group-hover:op-100 gpt-copy-tips&quot;</span>&gt;</span></span><br><span class="line">                    Copy</span><br><span class="line">                  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">pre</span>&gt;</span><span class="tag">&lt;<span class="name">code</span> <span class="attr">class</span>=<span class="string">&quot;hljs language-java&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-type&quot;</span>&gt;</span>Intent<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-variable&quot;</span>&gt;</span>shareIntent<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-operator&quot;</span>&gt;</span>=<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>new<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-title class_&quot;</span>&gt;</span>Intent<span class="tag">&lt;/<span class="name">span</span>&gt;</span>(Intent.ACTION_SEND);</span><br><span class="line">                    shareIntent.setType(<span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-string&quot;</span>&gt;</span>&quot;image/*&quot;<span class="tag">&lt;/<span class="name">span</span>&gt;</span>);</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-type&quot;</span>&gt;</span>Uri<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-variable&quot;</span>&gt;</span>imageUri<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-operator&quot;</span>&gt;</span>=<span class="tag">&lt;/<span class="name">span</span>&gt;</span> Uri.parse(<span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-string&quot;</span>&gt;</span>&quot;path_to_your_poster_image&quot;<span class="tag">&lt;/<span class="name">span</span>&gt;</span>);</span><br><span class="line">                    shareIntent.putExtra(Intent.EXTRA_STREAM, imageUri);</span><br><span class="line">                    startActivity(Intent.createChooser(shareIntent, <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-string&quot;</span>&gt;</span>&quot;Share via&quot;<span class="tag">&lt;/<span class="name">span</span>&gt;</span>));</span><br><span class="line">                  <span class="tag">&lt;/<span class="name">code</span>&gt;</span><span class="tag">&lt;/<span class="name">pre</span>&gt;</span></span><br><span class="line"></span><br><span class="line">              <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>虽然这涉及跨进程通信，但 Intent 机制隐藏了底层的 IPC 细节。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ol</span> <span class="attr">start</span>=<span class="string">&quot;2&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>从 WebView 跳转到小红书 App<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>这种情况通常通过 Deep Linking 或 App Links 实现：<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">div</span> <span class="attr">relative</span>=<span class="string">&quot;&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">data-code</span>=<span class="string">&quot;webView.setWebViewClient(new%20WebViewClient()%20%7B%0A%20%20%20%20%40Override%0A%20%20%20%20public%20boolean%20shouldOverrideUrlLoading(WebView%20view%2C%20String%20url)%20%7B%0A%20%20%20%20%20%20%20%20if%20(url.startsWith(%22xiaohongshu%3A%2F%2F%22))%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20Intent%20intent%20%3D%20new%20Intent(Intent.ACTION_VIEW%2C%20Uri.parse(url))%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20startActivity(intent)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20true%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20return%20false%3B%0A%20%20%20%20%7D%0A%7D)%3B%0A&quot;</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">class</span>=<span class="string">&quot;copy-btn gpt-copy-btn group&quot;</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">svg</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.w3.org/2000/svg&quot;</span> <span class="attr">width</span>=<span class="string">&quot;1em&quot;</span> <span class="attr">height</span>=<span class="string">&quot;1em&quot;</span> <span class="attr">viewBox</span>=<span class="string">&quot;0 0 32 32&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">path</span> <span class="attr">fill</span>=<span class="string">&quot;currentColor&quot;</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">d</span>=<span class="string">&quot;M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">path</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">path</span> <span class="attr">fill</span>=<span class="string">&quot;currentColor&quot;</span> <span class="attr">d</span>=<span class="string">&quot;M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">path</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;group-hover:op-100 gpt-copy-tips&quot;</span>&gt;</span></span><br><span class="line">                    Copy</span><br><span class="line">                  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">pre</span>&gt;</span><span class="tag">&lt;<span class="name">code</span> <span class="attr">class</span>=<span class="string">&quot;hljs language-java&quot;</span>&gt;</span>webView.setWebViewClient(<span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>new<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-title class_&quot;</span>&gt;</span>WebViewClient<span class="tag">&lt;/<span class="name">span</span>&gt;</span>() &#123;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-meta&quot;</span>&gt;</span>@Override<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>public<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-type&quot;</span>&gt;</span>boolean<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-title function_&quot;</span>&gt;</span>shouldOverrideUrlLoading<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-params&quot;</span>&gt;</span>(WebView</span><br><span class="line">                      view, String url)<span class="tag">&lt;/<span class="name">span</span>&gt;</span> &#123;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>if<span class="tag">&lt;/<span class="name">span</span>&gt;</span> (url.startsWith(<span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-string&quot;</span>&gt;</span>&quot;xiaohongshu://&quot;<span class="tag">&lt;/<span class="name">span</span>&gt;</span>)) &#123;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-type&quot;</span>&gt;</span>Intent<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-variable&quot;</span>&gt;</span>intent<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-operator&quot;</span>&gt;</span>=<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>new<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-title class_&quot;</span>&gt;</span>Intent<span class="tag">&lt;/<span class="name">span</span>&gt;</span>(Intent.ACTION_VIEW, Uri.parse(url));</span><br><span class="line">                    startActivity(intent);</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>return<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-literal&quot;</span>&gt;</span>true<span class="tag">&lt;/<span class="name">span</span>&gt;</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>return<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-literal&quot;</span>&gt;</span>false<span class="tag">&lt;/<span class="name">span</span>&gt;</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    &#125;);</span><br><span class="line">                  <span class="tag">&lt;/<span class="name">code</span>&gt;</span><span class="tag">&lt;/<span class="name">pre</span>&gt;</span></span><br><span class="line"></span><br><span class="line">              <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>同样，这里使用的是 Intent，底层的 IPC 由系统处理。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>那么，什么时候需要显式实现 IPC 呢？以下是一些可能需要直接处理 IPC 的场景：<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ol</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>自定义系统服务<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>如果你在开发自定义 ROM 或系统级应用，可能需要创建新的系统服务，这时候就需要直接使用 AIDL（Android Interface Definition Language）来定义跨进程接口。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ol</span> <span class="attr">start</span>=<span class="string">&quot;2&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>复杂的跨应用通信<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>当需要持续的、双向的、复杂的跨应用通信时，可能需要使用 AIDL 或 Messenger。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ol</span> <span class="attr">start</span>=<span class="string">&quot;3&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>高性能要求的跨进程数据传输<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>对于需要频繁、大量数据传输的场景，可能需要使用共享内存（Shared Memory）等低级 IPC 机制。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ol</span> <span class="attr">start</span>=<span class="string">&quot;4&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>自定义 Content Provider<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>虽然使用 Content Provider 的客户端不需要直接处理 IPC，但如果你在创建自己的 Content Provider，你需要考虑跨进程问题。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ol</span> <span class="attr">start</span>=<span class="string">&quot;5&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>多进程应用<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>如果你的应用本身使用了多进程架构，你可能需要处理应用内不同进程间的通信。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ol</span> <span class="attr">start</span>=<span class="string">&quot;6&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>特殊的进程间同步需求<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>某些需要精确控制进程间同步的场景可能需要直接使用底层 IPC 机制。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>示例：使用 AIDL 的简单例子<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ol</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>定义 AIDL 接口：<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">div</span> <span class="attr">relative</span>=<span class="string">&quot;&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">data-code</span>=<span class="string">&quot;%2F%2F%20IMyService.aidl%0Apackage%20com.example.app%3B%0A%0Ainterface%20IMyService%20%7B%0A%20%20%20%20int%20add(int%20a%2C%20int%20b)%3B%0A%7D%0A&quot;</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">class</span>=<span class="string">&quot;copy-btn gpt-copy-btn group&quot;</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">svg</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.w3.org/2000/svg&quot;</span> <span class="attr">width</span>=<span class="string">&quot;1em&quot;</span> <span class="attr">height</span>=<span class="string">&quot;1em&quot;</span> <span class="attr">viewBox</span>=<span class="string">&quot;0 0 32 32&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">path</span> <span class="attr">fill</span>=<span class="string">&quot;currentColor&quot;</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">d</span>=<span class="string">&quot;M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">path</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">path</span> <span class="attr">fill</span>=<span class="string">&quot;currentColor&quot;</span> <span class="attr">d</span>=<span class="string">&quot;M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">path</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;group-hover:op-100 gpt-copy-tips&quot;</span>&gt;</span></span><br><span class="line">                    Copy</span><br><span class="line">                  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">pre</span>&gt;</span><span class="tag">&lt;<span class="name">code</span> <span class="attr">class</span>=<span class="string">&quot;hljs language-aidl&quot;</span>&gt;</span>// IMyService.aidl</span><br><span class="line">                    package com.example.app;</span><br><span class="line"></span><br><span class="line">                    interface IMyService &#123;</span><br><span class="line">                    int add(int a, int b);</span><br><span class="line">                    &#125;</span><br><span class="line">                  <span class="tag">&lt;/<span class="name">code</span>&gt;</span><span class="tag">&lt;/<span class="name">pre</span>&gt;</span></span><br><span class="line"></span><br><span class="line">              <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ol</span> <span class="attr">start</span>=<span class="string">&quot;2&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>实现服务：<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">div</span> <span class="attr">relative</span>=<span class="string">&quot;&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">data-code</span>=<span class="string">&quot;public%20class%20MyService%20extends%20Service%20%7B%0A%20%20%20%20private%20final%20IMyService.Stub%20binder%20%3D%20new%20IMyService.Stub()%20%7B%0A%20%20%20%20%20%20%20%20%40Override%0A%20%20%20%20%20%20%20%20public%20int%20add(int%20a%2C%20int%20b)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20a%20%2B%20b%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%3B%0A%0A%20%20%20%20%40Override%0A%20%20%20%20public%20IBinder%20onBind(Intent%20intent)%20%7B%0A%20%20%20%20%20%20%20%20return%20binder%3B%0A%20%20%20%20%7D%0A%7D%0A&quot;</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">class</span>=<span class="string">&quot;copy-btn gpt-copy-btn group&quot;</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">svg</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.w3.org/2000/svg&quot;</span> <span class="attr">width</span>=<span class="string">&quot;1em&quot;</span> <span class="attr">height</span>=<span class="string">&quot;1em&quot;</span> <span class="attr">viewBox</span>=<span class="string">&quot;0 0 32 32&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">path</span> <span class="attr">fill</span>=<span class="string">&quot;currentColor&quot;</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">d</span>=<span class="string">&quot;M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">path</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">path</span> <span class="attr">fill</span>=<span class="string">&quot;currentColor&quot;</span> <span class="attr">d</span>=<span class="string">&quot;M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">path</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;group-hover:op-100 gpt-copy-tips&quot;</span>&gt;</span></span><br><span class="line">                    Copy</span><br><span class="line">                  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">pre</span>&gt;</span><span class="tag">&lt;<span class="name">code</span> <span class="attr">class</span>=<span class="string">&quot;hljs language-java&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>public<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>class<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-title class_&quot;</span>&gt;</span>MyService<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>extends<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-title class_&quot;</span>&gt;</span>Service<span class="tag">&lt;/<span class="name">span</span>&gt;</span> &#123;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>private<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>final<span class="tag">&lt;/<span class="name">span</span>&gt;</span> IMyService.<span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-type&quot;</span>&gt;</span>Stub<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-variable&quot;</span>&gt;</span>binder<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-operator&quot;</span>&gt;</span>=<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>new<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-title class_&quot;</span>&gt;</span>IMyService<span class="tag">&lt;/<span class="name">span</span>&gt;</span>.Stub() &#123;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-meta&quot;</span>&gt;</span>@Override<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>public<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-type&quot;</span>&gt;</span>int<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-title function_&quot;</span>&gt;</span>add<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-params&quot;</span>&gt;</span>(<span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">class</span>=<span class="string">&quot;hljs-type&quot;</span>&gt;</span>int<span class="tag">&lt;/<span class="name">span</span>&gt;</span> a, <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-type&quot;</span>&gt;</span>int<span class="tag">&lt;/<span class="name">span</span>&gt;</span> b)<span class="tag">&lt;/<span class="name">span</span>&gt;</span> &#123;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>return<span class="tag">&lt;/<span class="name">span</span>&gt;</span> a + b;</span><br><span class="line">                    &#125;</span><br><span class="line">                    &#125;;</span><br><span class="line"></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-meta&quot;</span>&gt;</span>@Override<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>public<span class="tag">&lt;/<span class="name">span</span>&gt;</span> IBinder <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-title function_&quot;</span>&gt;</span>onBind<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-params&quot;</span>&gt;</span>(Intent intent)<span class="tag">&lt;/<span class="name">span</span>&gt;</span> &#123;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>return<span class="tag">&lt;/<span class="name">span</span>&gt;</span> binder;</span><br><span class="line">                    &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                  <span class="tag">&lt;/<span class="name">code</span>&gt;</span><span class="tag">&lt;/<span class="name">pre</span>&gt;</span></span><br><span class="line"></span><br><span class="line">              <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ol</span> <span class="attr">start</span>=<span class="string">&quot;3&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>在客户端使用服务：<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">div</span> <span class="attr">relative</span>=<span class="string">&quot;&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">data-code</span>=<span class="string">&quot;private%20IMyService%20myService%3B%0Aprivate%20ServiceConnection%20connection%20%3D%20new%20ServiceConnection()%20%7B%0A%20%20%20%20%40Override%0A%20%20%20%20public%20void%20onServiceConnected(ComponentName%20name%2C%20IBinder%20service)%20%7B%0A%20%20%20%20%20%20%20%20myService%20%3D%20IMyService.Stub.asInterface(service)%3B%0A%20%20%20%20%20%20%20%20try%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20int%20result%20%3D%20myService.add(3%2C%204)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20Log.d(%22IPC%22%2C%20%22Result%3A%20%22%20%2B%20result)%3B%0A%20%20%20%20%20%20%20%20%7D%20catch%20(RemoteException%20e)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20e.printStackTrace()%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%0A%20%20%20%20%40Override%0A%20%20%20%20public%20void%20onServiceDisconnected(ComponentName%20name)%20%7B%0A%20%20%20%20%20%20%20%20myService%20%3D%20null%3B%0A%20%20%20%20%7D%0A%7D%3B%0A%0A%2F%2F%20%E7%BB%91%E5%AE%9A%E6%9C%8D%E5%8A%A1%0AbindService(new%20Intent(this%2C%20MyService.class)%2C%20connection%2C%20Context.BIND_AUTO_CREATE)%3B%0A&quot;</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">class</span>=<span class="string">&quot;copy-btn gpt-copy-btn group&quot;</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">svg</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.w3.org/2000/svg&quot;</span> <span class="attr">width</span>=<span class="string">&quot;1em&quot;</span> <span class="attr">height</span>=<span class="string">&quot;1em&quot;</span> <span class="attr">viewBox</span>=<span class="string">&quot;0 0 32 32&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">path</span> <span class="attr">fill</span>=<span class="string">&quot;currentColor&quot;</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">d</span>=<span class="string">&quot;M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">path</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">path</span> <span class="attr">fill</span>=<span class="string">&quot;currentColor&quot;</span> <span class="attr">d</span>=<span class="string">&quot;M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">path</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;group-hover:op-100 gpt-copy-tips&quot;</span>&gt;</span></span><br><span class="line">                    Copy</span><br><span class="line">                  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">pre</span>&gt;</span><span class="tag">&lt;<span class="name">code</span> <span class="attr">class</span>=<span class="string">&quot;hljs language-java&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>private<span class="tag">&lt;/<span class="name">span</span>&gt;</span> IMyService myService;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>private<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-type&quot;</span>&gt;</span>ServiceConnection<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-variable&quot;</span>&gt;</span>connection<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-operator&quot;</span>&gt;</span>=<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>new<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-title class_&quot;</span>&gt;</span>ServiceConnection<span class="tag">&lt;/<span class="name">span</span>&gt;</span>() &#123;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-meta&quot;</span>&gt;</span>@Override<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>public<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>void<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-title function_&quot;</span>&gt;</span>onServiceConnected<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-params&quot;</span>&gt;</span>(ComponentName</span><br><span class="line">                      name, IBinder service)<span class="tag">&lt;/<span class="name">span</span>&gt;</span> &#123;</span><br><span class="line">                    myService = IMyService.Stub.asInterface(service);</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>try<span class="tag">&lt;/<span class="name">span</span>&gt;</span> &#123;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-type&quot;</span>&gt;</span>int<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-variable&quot;</span>&gt;</span>result<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-operator&quot;</span>&gt;</span>=<span class="tag">&lt;/<span class="name">span</span>&gt;</span> myService.add(<span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-number&quot;</span>&gt;</span>3<span class="tag">&lt;/<span class="name">span</span>&gt;</span>, <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-number&quot;</span>&gt;</span>4<span class="tag">&lt;/<span class="name">span</span>&gt;</span>);</span><br><span class="line">                    Log.d(<span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-string&quot;</span>&gt;</span>&quot;IPC&quot;<span class="tag">&lt;/<span class="name">span</span>&gt;</span>, <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-string&quot;</span>&gt;</span>&quot;Result: &quot;<span class="tag">&lt;/<span class="name">span</span>&gt;</span> + result);</span><br><span class="line">                    &#125; <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>catch<span class="tag">&lt;/<span class="name">span</span>&gt;</span> (RemoteException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                    &#125;</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-meta&quot;</span>&gt;</span>@Override<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>public<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>void<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-title function_&quot;</span>&gt;</span>onServiceDisconnected<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-params&quot;</span>&gt;</span>(ComponentName</span><br><span class="line">                      name)<span class="tag">&lt;/<span class="name">span</span>&gt;</span> &#123;</span><br><span class="line">                    myService = <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-literal&quot;</span>&gt;</span>null<span class="tag">&lt;/<span class="name">span</span>&gt;</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    &#125;;</span><br><span class="line"></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-comment&quot;</span>&gt;</span>// 绑定服务<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    bindService(<span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>new<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-title class_&quot;</span>&gt;</span>Intent<span class="tag">&lt;/<span class="name">span</span>&gt;</span>(<span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-built_in&quot;</span>&gt;</span>this<span class="tag">&lt;/<span class="name">span</span>&gt;</span>, MyService.class),</span><br><span class="line">                    connection, Context.BIND_AUTO_CREATE);</span><br><span class="line">                  <span class="tag">&lt;/<span class="name">code</span>&gt;</span><span class="tag">&lt;/<span class="name">pre</span>&gt;</span></span><br><span class="line"></span><br><span class="line">              <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>总结：<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">                在大多数常见的 Android 开发场景中，如分享功能或应用间跳转，我们通常不需要直接实现 IPC。Android 提供了高级抽象（如 Intent、Content</span><br><span class="line">                Provider）来处理这些常见需求。只有在需要更精细控制、更高性能或更复杂的跨进程通信场景下，我们才需要考虑直接实现 IPC 机制。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="comment">&lt;!--#--&gt;</span><span class="comment">&lt;!--/--&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;py-2 -mx-4 px-4 transition-colors md:hover:bg-slate/3&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;flex gap-3 rounded-lg op-75&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;shrink-0 w-7 h-7 mt-4 rounded-full op-80 bg-gradient-to-r from-purple-400 to-yellow-400&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;message prose break-words overflow-hidden&quot;</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>就说一个具体场景吧：我想把我App生成的海报图片分享到微信朋友圈，那么这里应该涉及到1.跳转到微信 2.跳转到微信朋友圈的 待发表</span><br><span class="line">                Activity，对吧？那么这里我是怎样实现这样的需求？需要使用到Android系统以及微信的哪些API？<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="comment">&lt;!--#--&gt;</span><span class="comment">&lt;!--/--&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;py-2 -mx-4 px-4 transition-colors md:hover:bg-slate/3&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;flex gap-3 rounded-lg&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span></span></span><br><span class="line"><span class="tag">              <span class="attr">class</span>=<span class="string">&quot;shrink-0 w-7 h-7 mt-4 rounded-full op-80 bg-gradient-to-r from-yellow-200 via-green-200 to-green-300&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;message prose break-words overflow-hidden&quot;</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>您提出了一个非常具体和实际的场景。分享图片到微信朋友圈确实是一个常见的需求。让我详细解释一下实现这个功能的步骤和所需的 API：<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ol</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>准备工作<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>首先，您需要在您的应用中集成微信 SDK。这不是 Android 系统 API 的一部分，而是微信提供的第三方 SDK。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>下载微信 SDK：从微信开放平台下载 Android SDK。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>在您的项目中添加 SDK 依赖。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>在微信开放平台注册您的应用，获取 AppID。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ol</span> <span class="attr">start</span>=<span class="string">&quot;2&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>实现分享功能<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>使用微信 SDK 提供的 API 来实现分享功能。以下是基本步骤：<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">div</span> <span class="attr">relative</span>=<span class="string">&quot;&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">data-code</span>=<span class="string">&quot;import%20com.tencent.mm.opensdk.modelmsg.SendMessageToWX%3B%0Aimport%20com.tencent.mm.opensdk.modelmsg.WXImageObject%3B%0Aimport%20com.tencent.mm.opensdk.modelmsg.WXMediaMessage%3B%0Aimport%20com.tencent.mm.opensdk.openapi.IWXAPI%3B%0Aimport%20com.tencent.mm.opensdk.openapi.WXAPIFactory%3B%0A%0Apublic%20class%20ShareToWeChatActivity%20extends%20AppCompatActivity%20%7B%0A%20%20%20%20private%20IWXAPI%20api%3B%0A%20%20%20%20private%20static%20final%20String%20APP_ID%20%3D%20%22your_wx_app_id%22%3B%0A%0A%20%20%20%20%40Override%0A%20%20%20%20protected%20void%20onCreate(Bundle%20savedInstanceState)%20%7B%0A%20%20%20%20%20%20%20%20super.onCreate(savedInstanceState)%3B%0A%20%20%20%20%20%20%20%20setContentView(R.layout.activity_share_to_wechat)%3B%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20%E5%88%9D%E5%A7%8B%E5%8C%96%20WXAPI%0A%20%20%20%20%20%20%20%20api%20%3D%20WXAPIFactory.createWXAPI(this%2C%20APP_ID%2C%20true)%3B%0A%20%20%20%20%20%20%20%20api.registerApp(APP_ID)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20private%20void%20shareImageToWeChatMoments(Bitmap%20bitmap)%20%7B%0A%20%20%20%20%20%20%20%20%2F%2F%20%E6%A3%80%E6%9F%A5%E5%BE%AE%E4%BF%A1%E6%98%AF%E5%90%A6%E5%AE%89%E8%A3%85%0A%20%20%20%20%20%20%20%20if%20(!api.isWXAppInstalled())%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20Toast.makeText(this%2C%20%22%E8%AF%B7%E5%85%88%E5%AE%89%E8%A3%85%E5%BE%AE%E4%BF%A1%22%2C%20Toast.LENGTH_SHORT).show()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20%E5%88%9B%E5%BB%BA%20WXImageObject%20%E5%92%8C%20WXMediaMessage%20%E5%AF%B9%E8%B1%A1%0A%20%20%20%20%20%20%20%20WXImageObject%20imgObj%20%3D%20new%20WXImageObject(bitmap)%3B%0A%20%20%20%20%20%20%20%20WXMediaMessage%20msg%20%3D%20new%20WXMediaMessage()%3B%0A%20%20%20%20%20%20%20%20msg.mediaObject%20%3D%20imgObj%3B%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20%E8%AE%BE%E7%BD%AE%E7%BC%A9%E7%95%A5%E5%9B%BE%0A%20%20%20%20%20%20%20%20Bitmap%20thumbBmp%20%3D%20Bitmap.createScaledBitmap(bitmap%2C%20100%2C%20100%2C%20true)%3B%0A%20%20%20%20%20%20%20%20bitmap.recycle()%3B%0A%20%20%20%20%20%20%20%20msg.thumbData%20%3D%20bitmapToByteArray(thumbBmp)%3B%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20%E6%9E%84%E9%80%A0%E4%B8%80%E4%B8%AA%20Req%0A%20%20%20%20%20%20%20%20SendMessageToWX.Req%20req%20%3D%20new%20SendMessageToWX.Req()%3B%0A%20%20%20%20%20%20%20%20req.transaction%20%3D%20buildTransaction(%22img%22)%3B%0A%20%20%20%20%20%20%20%20req.message%20%3D%20msg%3B%0A%20%20%20%20%20%20%20%20req.scene%20%3D%20SendMessageToWX.Req.WXSceneTimeline%3B%20%20%2F%2F%20%E5%88%86%E4%BA%AB%E5%88%B0%E6%9C%8B%E5%8F%8B%E5%9C%88%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20%E8%B0%83%E7%94%A8%20api%20%E6%8E%A5%E5%8F%A3%E5%8F%91%E9%80%81%E6%95%B0%E6%8D%AE%E5%88%B0%E5%BE%AE%E4%BF%A1%0A%20%20%20%20%20%20%20%20api.sendReq(req)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20private%20String%20buildTransaction(final%20String%20type)%20%7B%0A%20%20%20%20%20%20%20%20return%20(type%20%3D%3D%20null)%20%3F%20String.valueOf(System.currentTimeMillis())%20%3A%20type%20%2B%20System.currentTimeMillis()%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20private%20byte%5B%5D%20bitmapToByteArray(Bitmap%20bitmap)%20%7B%0A%20%20%20%20%20%20%20%20ByteArrayOutputStream%20baos%20%3D%20new%20ByteArrayOutputStream()%3B%0A%20%20%20%20%20%20%20%20bitmap.compress(Bitmap.CompressFormat.PNG%2C%20100%2C%20baos)%3B%0A%20%20%20%20%20%20%20%20return%20baos.toByteArray()%3B%0A%20%20%20%20%7D%0A%7D%0A&quot;</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">class</span>=<span class="string">&quot;copy-btn gpt-copy-btn group&quot;</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">svg</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.w3.org/2000/svg&quot;</span> <span class="attr">width</span>=<span class="string">&quot;1em&quot;</span> <span class="attr">height</span>=<span class="string">&quot;1em&quot;</span> <span class="attr">viewBox</span>=<span class="string">&quot;0 0 32 32&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">path</span> <span class="attr">fill</span>=<span class="string">&quot;currentColor&quot;</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">d</span>=<span class="string">&quot;M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">path</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">path</span> <span class="attr">fill</span>=<span class="string">&quot;currentColor&quot;</span> <span class="attr">d</span>=<span class="string">&quot;M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">path</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;group-hover:op-100 gpt-copy-tips&quot;</span>&gt;</span></span><br><span class="line">                    Copy</span><br><span class="line">                  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">pre</span>&gt;</span><span class="tag">&lt;<span class="name">code</span> <span class="attr">class</span>=<span class="string">&quot;hljs language-java&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>import<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    com.tencent.mm.opensdk.modelmsg.SendMessageToWX;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>import<span class="tag">&lt;/<span class="name">span</span>&gt;</span> com.tencent.mm.opensdk.modelmsg.WXImageObject;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>import<span class="tag">&lt;/<span class="name">span</span>&gt;</span> com.tencent.mm.opensdk.modelmsg.WXMediaMessage;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>import<span class="tag">&lt;/<span class="name">span</span>&gt;</span> com.tencent.mm.opensdk.openapi.IWXAPI;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>import<span class="tag">&lt;/<span class="name">span</span>&gt;</span> com.tencent.mm.opensdk.openapi.WXAPIFactory;</span><br><span class="line"></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>public<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>class<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-title class_&quot;</span>&gt;</span>ShareToWeChatActivity<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>extends<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-title class_&quot;</span>&gt;</span>AppCompatActivity<span class="tag">&lt;/<span class="name">span</span>&gt;</span> &#123;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>private<span class="tag">&lt;/<span class="name">span</span>&gt;</span> IWXAPI api;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>private<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>static<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>final<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-type&quot;</span>&gt;</span>String<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-variable&quot;</span>&gt;</span>APP_ID<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-operator&quot;</span>&gt;</span>=<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-string&quot;</span>&gt;</span>&quot;your_wx_app_id&quot;<span class="tag">&lt;/<span class="name">span</span>&gt;</span>;</span><br><span class="line"></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-meta&quot;</span>&gt;</span>@Override<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>protected<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>void<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-title function_&quot;</span>&gt;</span>onCreate<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-params&quot;</span>&gt;</span>(Bundle</span><br><span class="line">                      savedInstanceState)<span class="tag">&lt;/<span class="name">span</span>&gt;</span> &#123;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-built_in&quot;</span>&gt;</span>super<span class="tag">&lt;/<span class="name">span</span>&gt;</span>.onCreate(savedInstanceState);</span><br><span class="line">                    setContentView(R.layout.activity_share_to_wechat);</span><br><span class="line"></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-comment&quot;</span>&gt;</span>// 初始化 WXAPI<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    api = WXAPIFactory.createWXAPI(<span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-built_in&quot;</span>&gt;</span>this<span class="tag">&lt;/<span class="name">span</span>&gt;</span>, APP_ID, <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-literal&quot;</span>&gt;</span>true<span class="tag">&lt;/<span class="name">span</span>&gt;</span>);</span><br><span class="line">                    api.registerApp(APP_ID);</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>private<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>void<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-title function_&quot;</span>&gt;</span>shareImageToWeChatMoments<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-params&quot;</span>&gt;</span>(Bitmap</span><br><span class="line">                      bitmap)<span class="tag">&lt;/<span class="name">span</span>&gt;</span> &#123;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-comment&quot;</span>&gt;</span>// 检查微信是否安装<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>if<span class="tag">&lt;/<span class="name">span</span>&gt;</span> (!api.isWXAppInstalled()) &#123;</span><br><span class="line">                    Toast.makeText(<span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-built_in&quot;</span>&gt;</span>this<span class="tag">&lt;/<span class="name">span</span>&gt;</span>, <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-string&quot;</span>&gt;</span>&quot;请先安装微信&quot;<span class="tag">&lt;/<span class="name">span</span>&gt;</span>,</span><br><span class="line">                    Toast.LENGTH_SHORT).show();</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>return<span class="tag">&lt;/<span class="name">span</span>&gt;</span>;</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-comment&quot;</span>&gt;</span>// 创建 WXImageObject 和 WXMediaMessage 对象<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-type&quot;</span>&gt;</span>WXImageObject<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-variable&quot;</span>&gt;</span>imgObj<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-operator&quot;</span>&gt;</span>=<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>new<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-title class_&quot;</span>&gt;</span>WXImageObject<span class="tag">&lt;/<span class="name">span</span>&gt;</span>(bitmap);</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-type&quot;</span>&gt;</span>WXMediaMessage<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-variable&quot;</span>&gt;</span>msg<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-operator&quot;</span>&gt;</span>=<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>new<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-title class_&quot;</span>&gt;</span>WXMediaMessage<span class="tag">&lt;/<span class="name">span</span>&gt;</span>();</span><br><span class="line">                    msg.mediaObject = imgObj;</span><br><span class="line"></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-comment&quot;</span>&gt;</span>// 设置缩略图<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-type&quot;</span>&gt;</span>Bitmap<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-variable&quot;</span>&gt;</span>thumbBmp<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-operator&quot;</span>&gt;</span>=<span class="tag">&lt;/<span class="name">span</span>&gt;</span> Bitmap.createScaledBitmap(bitmap, <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-number&quot;</span>&gt;</span>100<span class="tag">&lt;/<span class="name">span</span>&gt;</span>, <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-number&quot;</span>&gt;</span>100<span class="tag">&lt;/<span class="name">span</span>&gt;</span>, <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-literal&quot;</span>&gt;</span>true<span class="tag">&lt;/<span class="name">span</span>&gt;</span>);</span><br><span class="line">                    bitmap.recycle();</span><br><span class="line">                    msg.thumbData = bitmapToByteArray(thumbBmp);</span><br><span class="line"></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-comment&quot;</span>&gt;</span>// 构造一个 Req<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    SendMessageToWX.<span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-type&quot;</span>&gt;</span>Req<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-variable&quot;</span>&gt;</span>req<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-operator&quot;</span>&gt;</span>=<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>new<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-title class_&quot;</span>&gt;</span>SendMessageToWX<span class="tag">&lt;/<span class="name">span</span>&gt;</span>.Req();</span><br><span class="line">                    req.transaction = buildTransaction(<span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-string&quot;</span>&gt;</span>&quot;img&quot;<span class="tag">&lt;/<span class="name">span</span>&gt;</span>);</span><br><span class="line">                    req.message = msg;</span><br><span class="line">                    req.scene = SendMessageToWX.Req.WXSceneTimeline; <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-comment&quot;</span>&gt;</span>// 分享到朋友圈<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-comment&quot;</span>&gt;</span>// 调用 api 接口发送数据到微信<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    api.sendReq(req);</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>private<span class="tag">&lt;/<span class="name">span</span>&gt;</span> String <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-title function_&quot;</span>&gt;</span>buildTransaction<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-params&quot;</span>&gt;</span>(<span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>final<span class="tag">&lt;/<span class="name">span</span>&gt;</span> String type)<span class="tag">&lt;/<span class="name">span</span>&gt;</span> &#123;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>return<span class="tag">&lt;/<span class="name">span</span>&gt;</span> (type == <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-literal&quot;</span>&gt;</span>null<span class="tag">&lt;/<span class="name">span</span>&gt;</span>) ?</span><br><span class="line">                    String.valueOf(System.currentTimeMillis()) : type + System.currentTimeMillis();</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>private<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-type&quot;</span>&gt;</span>byte<span class="tag">&lt;/<span class="name">span</span>&gt;</span>[]</span><br><span class="line">                    bitmapToByteArray(Bitmap bitmap) &#123;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-type&quot;</span>&gt;</span>ByteArrayOutputStream<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-variable&quot;</span>&gt;</span>baos<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-operator&quot;</span>&gt;</span>=<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>new<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-title class_&quot;</span>&gt;</span>ByteArrayOutputStream<span class="tag">&lt;/<span class="name">span</span>&gt;</span>();</span><br><span class="line">                    bitmap.compress(Bitmap.CompressFormat.PNG, <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-number&quot;</span>&gt;</span>100<span class="tag">&lt;/<span class="name">span</span>&gt;</span>, baos);</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>return<span class="tag">&lt;/<span class="name">span</span>&gt;</span> baos.toByteArray();</span><br><span class="line">                    &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                  <span class="tag">&lt;/<span class="name">code</span>&gt;</span><span class="tag">&lt;/<span class="name">pre</span>&gt;</span></span><br><span class="line"></span><br><span class="line">              <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ol</span> <span class="attr">start</span>=<span class="string">&quot;3&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>处理回调<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>微信完成分享后会返回到您的应用。您需要在 AndroidManifest.xml 中声明一个 Activity 来处理这个回调：<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">div</span> <span class="attr">relative</span>=<span class="string">&quot;&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">data-code</span>=<span class="string">&quot;%3Cactivity%0A%20%20%20%20android%3Aname%3D%22.wxapi.WXEntryActivity%22%0A%20%20%20%20android%3Aexported%3D%22true%22%0A%20%20%20%20android%3Alabel%3D%22%40string%2Fapp_name%22%0A%20%20%20%20android%3Atheme%3D%22%40android%3Astyle%2FTheme.Translucent.NoTitleBar%22%20%2F%3E%0A&quot;</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">class</span>=<span class="string">&quot;copy-btn gpt-copy-btn group&quot;</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">svg</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.w3.org/2000/svg&quot;</span> <span class="attr">width</span>=<span class="string">&quot;1em&quot;</span> <span class="attr">height</span>=<span class="string">&quot;1em&quot;</span> <span class="attr">viewBox</span>=<span class="string">&quot;0 0 32 32&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">path</span> <span class="attr">fill</span>=<span class="string">&quot;currentColor&quot;</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">d</span>=<span class="string">&quot;M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">path</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">path</span> <span class="attr">fill</span>=<span class="string">&quot;currentColor&quot;</span> <span class="attr">d</span>=<span class="string">&quot;M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">path</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;group-hover:op-100 gpt-copy-tips&quot;</span>&gt;</span></span><br><span class="line">                    Copy</span><br><span class="line">                  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">pre</span>&gt;</span><span class="tag">&lt;<span class="name">code</span> <span class="attr">class</span>=<span class="string">&quot;hljs language-xml&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-tag&quot;</span>&gt;</span><span class="symbol">&amp;lt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-name&quot;</span>&gt;</span>activity<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                      <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-attr&quot;</span>&gt;</span>android:name<span class="tag">&lt;/<span class="name">span</span>&gt;</span>=<span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">class</span>=<span class="string">&quot;hljs-string&quot;</span>&gt;</span>&quot;.wxapi.WXEntryActivity&quot;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                      <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-attr&quot;</span>&gt;</span>android:exported<span class="tag">&lt;/<span class="name">span</span>&gt;</span>=<span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-string&quot;</span>&gt;</span>&quot;true&quot;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                      <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-attr&quot;</span>&gt;</span>android:label<span class="tag">&lt;/<span class="name">span</span>&gt;</span>=<span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-string&quot;</span>&gt;</span>&quot;@string/app_name&quot;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                      <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-attr&quot;</span>&gt;</span>android:theme<span class="tag">&lt;/<span class="name">span</span>&gt;</span>=<span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">class</span>=<span class="string">&quot;hljs-string&quot;</span>&gt;</span>&quot;@android:style/Theme.Translucent.NoTitleBar&quot;<span class="tag">&lt;/<span class="name">span</span>&gt;</span> /<span class="symbol">&amp;gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;/<span class="name">code</span>&gt;</span><span class="tag">&lt;/<span class="name">pre</span>&gt;</span></span><br><span class="line"></span><br><span class="line">              <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>然后实现这个 Activity：<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">div</span> <span class="attr">relative</span>=<span class="string">&quot;&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">data-code</span>=<span class="string">&quot;public%20class%20WXEntryActivity%20extends%20Activity%20implements%20IWXAPIEventHandler%20%7B%0A%20%20%20%20private%20IWXAPI%20api%3B%0A%0A%20%20%20%20%40Override%0A%20%20%20%20protected%20void%20onCreate(Bundle%20savedInstanceState)%20%7B%0A%20%20%20%20%20%20%20%20super.onCreate(savedInstanceState)%3B%0A%20%20%20%20%20%20%20%20api%20%3D%20WXAPIFactory.createWXAPI(this%2C%20APP_ID%2C%20false)%3B%0A%20%20%20%20%20%20%20%20api.handleIntent(getIntent()%2C%20this)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%40Override%0A%20%20%20%20protected%20void%20onNewIntent(Intent%20intent)%20%7B%0A%20%20%20%20%20%20%20%20super.onNewIntent(intent)%3B%0A%20%20%20%20%20%20%20%20setIntent(intent)%3B%0A%20%20%20%20%20%20%20%20api.handleIntent(intent%2C%20this)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%40Override%0A%20%20%20%20public%20void%20onReq(BaseReq%20req)%20%7B%0A%20%20%20%20%20%20%20%20%2F%2F%20%E5%A4%84%E7%90%86%E5%BE%AE%E4%BF%A1%E5%8F%91%E6%9D%A5%E7%9A%84%E8%AF%B7%E6%B1%82%0A%20%20%20%20%7D%0A%0A%20%20%20%20%40Override%0A%20%20%20%20public%20void%20onResp(BaseResp%20resp)%20%7B%0A%20%20%20%20%20%20%20%20%2F%2F%20%E5%A4%84%E7%90%86%E5%BE%AE%E4%BF%A1%E8%BF%94%E5%9B%9E%E7%9A%84%E7%BB%93%E6%9E%9C%0A%20%20%20%20%20%20%20%20switch%20(resp.errCode)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20case%20BaseResp.ErrCode.ERR_OK%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20%E5%88%86%E4%BA%AB%E6%88%90%E5%8A%9F%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20case%20BaseResp.ErrCode.ERR_USER_CANCEL%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20%E7%94%A8%E6%88%B7%E5%8F%96%E6%B6%88%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20case%20BaseResp.ErrCode.ERR_AUTH_DENIED%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20%E8%AE%A4%E8%AF%81%E8%A2%AB%E5%90%A6%E5%86%B3%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20default%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20%E6%9C%AA%E7%9F%A5%E9%94%99%E8%AF%AF%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20break%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20finish()%3B%0A%20%20%20%20%7D%0A%7D%0A&quot;</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">class</span>=<span class="string">&quot;copy-btn gpt-copy-btn group&quot;</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">svg</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.w3.org/2000/svg&quot;</span> <span class="attr">width</span>=<span class="string">&quot;1em&quot;</span> <span class="attr">height</span>=<span class="string">&quot;1em&quot;</span> <span class="attr">viewBox</span>=<span class="string">&quot;0 0 32 32&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">path</span> <span class="attr">fill</span>=<span class="string">&quot;currentColor&quot;</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">d</span>=<span class="string">&quot;M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">path</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">path</span> <span class="attr">fill</span>=<span class="string">&quot;currentColor&quot;</span> <span class="attr">d</span>=<span class="string">&quot;M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">path</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;group-hover:op-100 gpt-copy-tips&quot;</span>&gt;</span></span><br><span class="line">                    Copy</span><br><span class="line">                  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">pre</span>&gt;</span><span class="tag">&lt;<span class="name">code</span> <span class="attr">class</span>=<span class="string">&quot;hljs language-java&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>public<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>class<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-title class_&quot;</span>&gt;</span>WXEntryActivity<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>extends<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-title class_&quot;</span>&gt;</span>Activity<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>implements<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-title class_&quot;</span>&gt;</span>IWXAPIEventHandler<span class="tag">&lt;/<span class="name">span</span>&gt;</span> &#123;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>private<span class="tag">&lt;/<span class="name">span</span>&gt;</span> IWXAPI api;</span><br><span class="line"></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-meta&quot;</span>&gt;</span>@Override<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>protected<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>void<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-title function_&quot;</span>&gt;</span>onCreate<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-params&quot;</span>&gt;</span>(Bundle</span><br><span class="line">                      savedInstanceState)<span class="tag">&lt;/<span class="name">span</span>&gt;</span> &#123;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-built_in&quot;</span>&gt;</span>super<span class="tag">&lt;/<span class="name">span</span>&gt;</span>.onCreate(savedInstanceState);</span><br><span class="line">                    api = WXAPIFactory.createWXAPI(<span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-built_in&quot;</span>&gt;</span>this<span class="tag">&lt;/<span class="name">span</span>&gt;</span>, APP_ID, <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-literal&quot;</span>&gt;</span>false<span class="tag">&lt;/<span class="name">span</span>&gt;</span>);</span><br><span class="line">                    api.handleIntent(getIntent(), <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-built_in&quot;</span>&gt;</span>this<span class="tag">&lt;/<span class="name">span</span>&gt;</span>);</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-meta&quot;</span>&gt;</span>@Override<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>protected<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>void<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-title function_&quot;</span>&gt;</span>onNewIntent<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-params&quot;</span>&gt;</span>(Intent intent)<span class="tag">&lt;/<span class="name">span</span>&gt;</span> &#123;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-built_in&quot;</span>&gt;</span>super<span class="tag">&lt;/<span class="name">span</span>&gt;</span>.onNewIntent(intent);</span><br><span class="line">                    setIntent(intent);</span><br><span class="line">                    api.handleIntent(intent, <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-built_in&quot;</span>&gt;</span>this<span class="tag">&lt;/<span class="name">span</span>&gt;</span>);</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-meta&quot;</span>&gt;</span>@Override<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>public<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>void<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-title function_&quot;</span>&gt;</span>onReq<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-params&quot;</span>&gt;</span>(BaseReq req)<span class="tag">&lt;/<span class="name">span</span>&gt;</span> &#123;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-comment&quot;</span>&gt;</span>// 处理微信发来的请求<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-meta&quot;</span>&gt;</span>@Override<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>public<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>void<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-title function_&quot;</span>&gt;</span>onResp<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-params&quot;</span>&gt;</span>(BaseResp resp)<span class="tag">&lt;/<span class="name">span</span>&gt;</span> &#123;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-comment&quot;</span>&gt;</span>// 处理微信返回的结果<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>switch<span class="tag">&lt;/<span class="name">span</span>&gt;</span> (resp.errCode) &#123;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>case<span class="tag">&lt;/<span class="name">span</span>&gt;</span> BaseResp.ErrCode.ERR_OK:</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-comment&quot;</span>&gt;</span>// 分享成功<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>break<span class="tag">&lt;/<span class="name">span</span>&gt;</span>;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>case<span class="tag">&lt;/<span class="name">span</span>&gt;</span> BaseResp.ErrCode.ERR_USER_CANCEL:</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-comment&quot;</span>&gt;</span>// 用户取消<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>break<span class="tag">&lt;/<span class="name">span</span>&gt;</span>;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>case<span class="tag">&lt;/<span class="name">span</span>&gt;</span> BaseResp.ErrCode.ERR_AUTH_DENIED:</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-comment&quot;</span>&gt;</span>// 认证被否决<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>break<span class="tag">&lt;/<span class="name">span</span>&gt;</span>;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>default<span class="tag">&lt;/<span class="name">span</span>&gt;</span>:</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-comment&quot;</span>&gt;</span>// 未知错误<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>break<span class="tag">&lt;/<span class="name">span</span>&gt;</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    finish();</span><br><span class="line">                    &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                  <span class="tag">&lt;/<span class="name">code</span>&gt;</span><span class="tag">&lt;/<span class="name">pre</span>&gt;</span></span><br><span class="line"></span><br><span class="line">              <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>关键点说明：<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ol</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>这里使用的是微信 SDK 提供的 API，而不是 Android 系统 API。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>分享到朋友圈是通过设置 <span class="tag">&lt;<span class="name">code</span>&gt;</span>req.scene = SendMessageToWX.Req.WXSceneTimeline<span class="tag">&lt;/<span class="name">code</span>&gt;</span> 来实现的。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>微信不提供直接跳转到&quot;待发表&quot;界面的 API，用户需要在微信内完成发表操作。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>整个过程涉及到跨应用通信，但底层的 IPC 机制由微信 SDK 和 Android 系统处理，开发者不需要直接实现 IPC。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>注意事项：<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>确保您的应用在微信开放平台正确注册，并获得了 AppID。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>遵守微信的分享政策，不要滥用分享功能。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>处理各种可能的错误情况，如微信未安装、网络问题等。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>注意图片大小限制，过大的图片可能无法成功分享。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>总结：<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">                虽然这个过程涉及到跨应用通信，但thanks to微信 SDK 和 Android 的 Intent 机制，我们不需要直接处理底层的 IPC。整个过程对开发者来说相对简单，主要是使用微信提供的 API</span><br><span class="line">                和处理相应的回调。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="comment">&lt;!--#--&gt;</span><span class="comment">&lt;!--/--&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;py-2 -mx-4 px-4 transition-colors md:hover:bg-slate/3&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;flex gap-3 rounded-lg op-75&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;shrink-0 w-7 h-7 mt-4 rounded-full op-80 bg-gradient-to-r from-purple-400 to-yellow-400&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;message prose break-words overflow-hidden&quot;</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>准确的说，当我的App继承了微信SDK，那么由这个微信SDK与通过Android系统与微信App进行进程间通信，是这个意思吗？<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="comment">&lt;!--#--&gt;</span><span class="comment">&lt;!--/--&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;py-2 -mx-4 px-4 transition-colors md:hover:bg-slate/3&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;flex gap-3 rounded-lg&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span></span></span><br><span class="line"><span class="tag">              <span class="attr">class</span>=<span class="string">&quot;shrink-0 w-7 h-7 mt-4 rounded-full op-80 bg-gradient-to-r from-yellow-200 via-green-200 to-green-300&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;message prose break-words overflow-hidden&quot;</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>您的理解非常准确！让我详细解释一下这个过程：<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ol</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>微信 SDK 的角色<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>当您的应用集成了微信 SDK 后，这个 SDK 实际上充当了您的应用与微信应用之间的桥梁。微信 SDK 封装了与微信应用通信所需的复杂逻辑。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ol</span> <span class="attr">start</span>=<span class="string">&quot;2&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>进程间通信的实现<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>微信 SDK 在底层确实使用了 Android 系统提供的 IPC 机制来与微信应用进行通信。具体来说，它主要利用了以下 Android 系统机制：<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>a. Intent 机制：用于启动微信应用的特定组件。<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">                b. ContentProvider：可能用于数据交换。<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">                c. AIDL (Android Interface Definition Language)：用于定义复杂的跨进程接口。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ol</span> <span class="attr">start</span>=<span class="string">&quot;3&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>通信流程<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>当您调用微信 SDK 的方法（如分享到朋友圈）时，大致流程如下：<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>a. 您的应用调用微信 SDK 的方法。<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">                b. 微信 SDK 准备必要的数据。<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">                c. 微信 SDK 使用 Android 的 IPC 机制（主要是 Intent）向微信应用发送请求。<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">                d. Android 系统接收这个 Intent，并将其传递给微信应用。<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">                e. 微信应用处理这个请求，执行相应的操作（如打开分享界面）。<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">                f. 操作完成后，微信应用通过类似的方式将结果返回给您的应用。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ol</span> <span class="attr">start</span>=<span class="string">&quot;4&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>示例代码解析<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>让我们再看看之前的代码片段：<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">div</span> <span class="attr">relative</span>=<span class="string">&quot;&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">data-code</span>=<span class="string">&quot;SendMessageToWX.Req%20req%20%3D%20new%20SendMessageToWX.Req()%3B%0Areq.transaction%20%3D%20buildTransaction(%22img%22)%3B%0Areq.message%20%3D%20msg%3B%0Areq.scene%20%3D%20SendMessageToWX.Req.WXSceneTimeline%3B%0A%0Aapi.sendReq(req)%3B%0A&quot;</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">class</span>=<span class="string">&quot;copy-btn gpt-copy-btn group&quot;</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">svg</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.w3.org/2000/svg&quot;</span> <span class="attr">width</span>=<span class="string">&quot;1em&quot;</span> <span class="attr">height</span>=<span class="string">&quot;1em&quot;</span> <span class="attr">viewBox</span>=<span class="string">&quot;0 0 32 32&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">path</span> <span class="attr">fill</span>=<span class="string">&quot;currentColor&quot;</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">d</span>=<span class="string">&quot;M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">path</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">path</span> <span class="attr">fill</span>=<span class="string">&quot;currentColor&quot;</span> <span class="attr">d</span>=<span class="string">&quot;M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">path</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;group-hover:op-100 gpt-copy-tips&quot;</span>&gt;</span></span><br><span class="line">                    Copy</span><br><span class="line">                  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">pre</span>&gt;</span><span class="tag">&lt;<span class="name">code</span> <span class="attr">class</span>=<span class="string">&quot;hljs language-java&quot;</span>&gt;</span>SendMessageToWX.<span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-type&quot;</span>&gt;</span>Req<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-variable&quot;</span>&gt;</span>req<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-operator&quot;</span>&gt;</span>=<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>new<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-title class_&quot;</span>&gt;</span>SendMessageToWX<span class="tag">&lt;/<span class="name">span</span>&gt;</span>.Req();</span><br><span class="line">                    req.transaction = buildTransaction(<span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-string&quot;</span>&gt;</span>&quot;img&quot;<span class="tag">&lt;/<span class="name">span</span>&gt;</span>);</span><br><span class="line">                    req.message = msg;</span><br><span class="line">                    req.scene = SendMessageToWX.Req.WXSceneTimeline;</span><br><span class="line"></span><br><span class="line">                    api.sendReq(req);</span><br><span class="line">                  <span class="tag">&lt;/<span class="name">code</span>&gt;</span><span class="tag">&lt;/<span class="name">pre</span>&gt;</span></span><br><span class="line"></span><br><span class="line">              <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>这里的 <span class="tag">&lt;<span class="name">code</span>&gt;</span>api.sendReq(req)<span class="tag">&lt;/<span class="name">code</span>&gt;</span> 方法实际上是在底层使用 Android 的 IPC 机制（很可能是通过发送特定的 Intent）来与微信应用通信。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ol</span> <span class="attr">start</span>=<span class="string">&quot;5&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>回调处理<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>当您实现 <span class="tag">&lt;<span class="name">code</span>&gt;</span>WXEntryActivity<span class="tag">&lt;/<span class="name">code</span>&gt;</span> 来处理微信的回调时，这也是利用了 Android 的 IPC 机制。微信应用会通过 Intent 启动您应用中的这个</span><br><span class="line">                Activity，从而将结果传递回来。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>总结：<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">                您的理解是正确的。当您的应用集成微信 SDK 后，确实是由这个 SDK 通过 Android 系统提供的 IPC</span><br><span class="line">                机制与微信应用进行进程间通信。这种设计使得复杂的跨应用通信对开发者来说变得相对简单和透明，因为所有的底层 IPC 细节都被封装在了 SDK 中。开发者只需要关注 SDK 提供的高级</span><br><span class="line">                API，而不需要直接处理复杂的 IPC 逻辑。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="comment">&lt;!--#--&gt;</span><span class="comment">&lt;!--/--&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;py-2 -mx-4 px-4 transition-colors md:hover:bg-slate/3&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;flex gap-3 rounded-lg op-75&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;shrink-0 w-7 h-7 mt-4 rounded-full op-80 bg-gradient-to-r from-purple-400 to-yellow-400&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;message prose break-words overflow-hidden&quot;</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">                那么SDK的作用就应该是软件开发过程中的一种中间桥梁，SDK总是由系统提供方、大型软件提供方、硬件提供方，这些SDK来源方把功能底层实现的细节进行了封装，对外只是公开一个调用的方法，比如Android系统、微信/支付宝/飞书/小红书、大疆无人机等来提供，一般的开发者只是调用SDK里面有的这些上层API来搭建需要的功能？</span><br><span class="line">              <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="comment">&lt;!--#--&gt;</span><span class="comment">&lt;!--/--&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;py-2 -mx-4 px-4 transition-colors md:hover:bg-slate/3&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;flex gap-3 rounded-lg&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span></span></span><br><span class="line"><span class="tag">              <span class="attr">class</span>=<span class="string">&quot;shrink-0 w-7 h-7 mt-4 rounded-full op-80 bg-gradient-to-r from-yellow-200 via-green-200 to-green-300&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;message prose break-words overflow-hidden&quot;</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>您的理解非常准确！SDK（Software Development Kit，软件开发工具包）确实在软件开发过程中扮演着重要的中间桥梁角色。您的描述很好地概括了 SDK</span><br><span class="line">                的本质和作用。让我进一步阐述和补充一些细节：<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ol</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">p</span>&gt;</span>SDK 的本质<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">li</span>&gt;</span>封装复杂性：SDK 封装了底层实现的复杂细节。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">li</span>&gt;</span>提供简化接口：对外提供简单、统一的 API。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">li</span>&gt;</span>跨平台兼容：有些 SDK 提供跨平台的兼容性。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">p</span>&gt;</span>SDK 的主要提供方<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">li</span>&gt;</span>操作系统提供商：如 Android SDK、iOS SDK、Windows SDK。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">li</span>&gt;</span>大型软件公司：如微信 SDK、支付宝 SDK、Facebook SDK。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">li</span>&gt;</span>硬件制造商：如大疆无人机 SDK、各种 IoT 设备 SDK。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">li</span>&gt;</span>云服务提供商：如 AWS SDK、Google Cloud SDK、Azure SDK。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">li</span>&gt;</span>开源项目：许多开源项目也提供 SDK 以方便集成。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">p</span>&gt;</span>SDK 的主要功能<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">li</span>&gt;</span>简化开发：开发者无需了解底层实现细节。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">li</span>&gt;</span>标准化接口：提供统一的接口，便于维护和更新。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">li</span>&gt;</span>安全性：通过 SDK 可以控制对敏感功能的访问。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">li</span>&gt;</span>性能优化：SDK 通常经过优化，提供高效的实现。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">li</span>&gt;</span>文档和支持：通常伴随详细的文档和技术支持。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">p</span>&gt;</span>SDK 使用示例<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">p</span>&gt;</span>Android 系统 SDK：<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">div</span> <span class="attr">relative</span>=<span class="string">&quot;&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">div</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">data-code</span>=<span class="string">&quot;%2F%2F%20%E4%BD%BF%E7%94%A8%20Android%20SDK%20%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AA%20Intent%0AIntent%20intent%20%3D%20new%20Intent(this%2C%20SecondActivity.class)%3B%0AstartActivity(intent)%3B%0A&quot;</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;copy-btn gpt-copy-btn group&quot;</span>&gt;</span></span><br><span class="line">                      <span class="tag">&lt;<span class="name">svg</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.w3.org/2000/svg&quot;</span> <span class="attr">width</span>=<span class="string">&quot;1em&quot;</span> <span class="attr">height</span>=<span class="string">&quot;1em&quot;</span> <span class="attr">viewBox</span>=<span class="string">&quot;0 0 32 32&quot;</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">path</span> <span class="attr">fill</span>=<span class="string">&quot;currentColor&quot;</span></span></span><br><span class="line"><span class="tag">                          <span class="attr">d</span>=<span class="string">&quot;M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z&quot;</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;/<span class="name">path</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">path</span> <span class="attr">fill</span>=<span class="string">&quot;currentColor&quot;</span> <span class="attr">d</span>=<span class="string">&quot;M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">path</span>&gt;</span></span><br><span class="line">                      <span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br><span class="line">                      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;group-hover:op-100 gpt-copy-tips&quot;</span>&gt;</span></span><br><span class="line">                        Copy</span><br><span class="line">                      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">pre</span>&gt;</span><span class="tag">&lt;<span class="name">code</span> <span class="attr">class</span>=<span class="string">&quot;hljs language-java&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-comment&quot;</span>&gt;</span>// 使用 Android SDK 创建一个</span><br><span class="line">                          Intent<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-type&quot;</span>&gt;</span>Intent<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-variable&quot;</span>&gt;</span>intent<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                          <span class="attr">class</span>=<span class="string">&quot;hljs-operator&quot;</span>&gt;</span>=<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>new<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                          <span class="attr">class</span>=<span class="string">&quot;hljs-title class_&quot;</span>&gt;</span>Intent<span class="tag">&lt;/<span class="name">span</span>&gt;</span>(<span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-built_in&quot;</span>&gt;</span>this<span class="tag">&lt;/<span class="name">span</span>&gt;</span>,</span><br><span class="line">                        SecondActivity.class);</span><br><span class="line">                        startActivity(intent);</span><br><span class="line">                      <span class="tag">&lt;/<span class="name">code</span>&gt;</span><span class="tag">&lt;/<span class="name">pre</span>&gt;</span></span><br><span class="line"></span><br><span class="line">                  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">p</span>&gt;</span>微信 SDK：<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">div</span> <span class="attr">relative</span>=<span class="string">&quot;&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">div</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">data-code</span>=<span class="string">&quot;%2F%2F%20%E4%BD%BF%E7%94%A8%E5%BE%AE%E4%BF%A1%20SDK%20%E5%88%86%E4%BA%AB%E5%86%85%E5%AE%B9%0AWXWebpageObject%20webpage%20%3D%20new%20WXWebpageObject()%3B%0Awebpage.webpageUrl%20%3D%20%22http%3A%2F%2Fwww.example.com%22%3B%0AWXMediaMessage%20msg%20%3D%20new%20WXMediaMessage(webpage)%3B%0Amsg.title%20%3D%20%22%E7%BD%91%E9%A1%B5%E6%A0%87%E9%A2%98%22%3B%0Amsg.description%20%3D%20%22%E7%BD%91%E9%A1%B5%E6%8F%8F%E8%BF%B0%22%3B%0ASendMessageToWX.Req%20req%20%3D%20new%20SendMessageToWX.Req()%3B%0Areq.transaction%20%3D%20String.valueOf(System.currentTimeMillis())%3B%0Areq.message%20%3D%20msg%3B%0Areq.scene%20%3D%20SendMessageToWX.Req.WXSceneTimeline%3B%0Aapi.sendReq(req)%3B%0A&quot;</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;copy-btn gpt-copy-btn group&quot;</span>&gt;</span></span><br><span class="line">                      <span class="tag">&lt;<span class="name">svg</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.w3.org/2000/svg&quot;</span> <span class="attr">width</span>=<span class="string">&quot;1em&quot;</span> <span class="attr">height</span>=<span class="string">&quot;1em&quot;</span> <span class="attr">viewBox</span>=<span class="string">&quot;0 0 32 32&quot;</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">path</span> <span class="attr">fill</span>=<span class="string">&quot;currentColor&quot;</span></span></span><br><span class="line"><span class="tag">                          <span class="attr">d</span>=<span class="string">&quot;M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z&quot;</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;/<span class="name">path</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">path</span> <span class="attr">fill</span>=<span class="string">&quot;currentColor&quot;</span> <span class="attr">d</span>=<span class="string">&quot;M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">path</span>&gt;</span></span><br><span class="line">                      <span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br><span class="line">                      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;group-hover:op-100 gpt-copy-tips&quot;</span>&gt;</span></span><br><span class="line">                        Copy</span><br><span class="line">                      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">pre</span>&gt;</span><span class="tag">&lt;<span class="name">code</span> <span class="attr">class</span>=<span class="string">&quot;hljs language-java&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-comment&quot;</span>&gt;</span>// 使用微信 SDK 分享内容<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-type&quot;</span>&gt;</span>WXWebpageObject<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-variable&quot;</span>&gt;</span>webpage<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                          <span class="attr">class</span>=<span class="string">&quot;hljs-operator&quot;</span>&gt;</span>=<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>new<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                          <span class="attr">class</span>=<span class="string">&quot;hljs-title class_&quot;</span>&gt;</span>WXWebpageObject<span class="tag">&lt;/<span class="name">span</span>&gt;</span>();</span><br><span class="line">                        webpage.webpageUrl = <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-string&quot;</span>&gt;</span>&quot;http://www.example.com&quot;<span class="tag">&lt;/<span class="name">span</span>&gt;</span>;</span><br><span class="line">                        <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-type&quot;</span>&gt;</span>WXMediaMessage<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-variable&quot;</span>&gt;</span>msg<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                          <span class="attr">class</span>=<span class="string">&quot;hljs-operator&quot;</span>&gt;</span>=<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>new<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                          <span class="attr">class</span>=<span class="string">&quot;hljs-title class_&quot;</span>&gt;</span>WXMediaMessage<span class="tag">&lt;/<span class="name">span</span>&gt;</span>(webpage);</span><br><span class="line">                        msg.title = <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-string&quot;</span>&gt;</span>&quot;网页标题&quot;<span class="tag">&lt;/<span class="name">span</span>&gt;</span>;</span><br><span class="line">                        msg.description = <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-string&quot;</span>&gt;</span>&quot;网页描述&quot;<span class="tag">&lt;/<span class="name">span</span>&gt;</span>;</span><br><span class="line">                        SendMessageToWX.<span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-type&quot;</span>&gt;</span>Req<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-variable&quot;</span>&gt;</span>req<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                          <span class="attr">class</span>=<span class="string">&quot;hljs-operator&quot;</span>&gt;</span>=<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>new<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                          <span class="attr">class</span>=<span class="string">&quot;hljs-title class_&quot;</span>&gt;</span>SendMessageToWX<span class="tag">&lt;/<span class="name">span</span>&gt;</span>.Req();</span><br><span class="line">                        req.transaction = String.valueOf(System.currentTimeMillis());</span><br><span class="line">                        req.message = msg;</span><br><span class="line">                        req.scene = SendMessageToWX.Req.WXSceneTimeline;</span><br><span class="line">                        api.sendReq(req);</span><br><span class="line">                      <span class="tag">&lt;/<span class="name">code</span>&gt;</span><span class="tag">&lt;/<span class="name">pre</span>&gt;</span></span><br><span class="line"></span><br><span class="line">                  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">p</span>&gt;</span>大疆无人机 SDK：<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">div</span> <span class="attr">relative</span>=<span class="string">&quot;&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">div</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">data-code</span>=<span class="string">&quot;%2F%2F%20%E4%BD%BF%E7%94%A8%E5%A4%A7%E7%96%86%20SDK%20%E6%8E%A7%E5%88%B6%E6%97%A0%E4%BA%BA%E6%9C%BA%E8%B5%B7%E9%A3%9E%0AmFlightController.startTakeoff(new%20CommonCallbacks.CompletionCallback()%20%7B%0A%20%20%20%20%40Override%0A%20%20%20%20public%20void%20onResult(DJIError%20djiError)%20%7B%0A%20%20%20%20%20%20%20%20if%20(djiError%20%3D%3D%20null)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20%E8%B5%B7%E9%A3%9E%E6%88%90%E5%8A%9F%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20%E5%A4%84%E7%90%86%E9%94%99%E8%AF%AF%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%7D)%3B%0A&quot;</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;copy-btn gpt-copy-btn group&quot;</span>&gt;</span></span><br><span class="line">                      <span class="tag">&lt;<span class="name">svg</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.w3.org/2000/svg&quot;</span> <span class="attr">width</span>=<span class="string">&quot;1em&quot;</span> <span class="attr">height</span>=<span class="string">&quot;1em&quot;</span> <span class="attr">viewBox</span>=<span class="string">&quot;0 0 32 32&quot;</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">path</span> <span class="attr">fill</span>=<span class="string">&quot;currentColor&quot;</span></span></span><br><span class="line"><span class="tag">                          <span class="attr">d</span>=<span class="string">&quot;M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z&quot;</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;/<span class="name">path</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">path</span> <span class="attr">fill</span>=<span class="string">&quot;currentColor&quot;</span> <span class="attr">d</span>=<span class="string">&quot;M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">path</span>&gt;</span></span><br><span class="line">                      <span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br><span class="line">                      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;group-hover:op-100 gpt-copy-tips&quot;</span>&gt;</span></span><br><span class="line">                        Copy</span><br><span class="line">                      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">pre</span>&gt;</span><span class="tag">&lt;<span class="name">code</span> <span class="attr">class</span>=<span class="string">&quot;hljs language-java&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-comment&quot;</span>&gt;</span>// 使用大疆 SDK 控制无人机起飞<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                        mFlightController.startTakeoff(<span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>new<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                          <span class="attr">class</span>=<span class="string">&quot;hljs-title class_&quot;</span>&gt;</span>CommonCallbacks<span class="tag">&lt;/<span class="name">span</span>&gt;</span>.CompletionCallback() &#123;</span><br><span class="line">                        <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-meta&quot;</span>&gt;</span>@Override<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>public<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>void<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                          <span class="attr">class</span>=<span class="string">&quot;hljs-title function_&quot;</span>&gt;</span>onResult<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-params&quot;</span>&gt;</span>(DJIError</span><br><span class="line">                          djiError)<span class="tag">&lt;/<span class="name">span</span>&gt;</span> &#123;</span><br><span class="line">                        <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>if<span class="tag">&lt;/<span class="name">span</span>&gt;</span> (djiError == <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-literal&quot;</span>&gt;</span>null<span class="tag">&lt;/<span class="name">span</span>&gt;</span>) &#123;</span><br><span class="line">                        <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-comment&quot;</span>&gt;</span>// 起飞成功<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                        &#125; <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>else<span class="tag">&lt;/<span class="name">span</span>&gt;</span> &#123;</span><br><span class="line">                        <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-comment&quot;</span>&gt;</span>// 处理错误<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                        &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                        &#125;);</span><br><span class="line">                      <span class="tag">&lt;/<span class="name">code</span>&gt;</span><span class="tag">&lt;/<span class="name">pre</span>&gt;</span></span><br><span class="line"></span><br><span class="line">                  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">p</span>&gt;</span>SDK 的优势<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">li</span>&gt;</span>减少开发时间和成本<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">li</span>&gt;</span>提高代码质量和可靠性<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">li</span>&gt;</span>确保与特定平台或服务的兼容性<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">li</span>&gt;</span>获得持续的更新和支持<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">p</span>&gt;</span>注意事项<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">li</span>&gt;</span>版本兼容性：需要注意 SDK 版本与目标平台的兼容性。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">li</span>&gt;</span>性能影响：引入 SDK 可能会增加应用的大小和复杂度。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">li</span>&gt;</span>依赖性：过度依赖第三方 SDK 可能带来风险。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">li</span>&gt;</span>学习成本：每个 SDK 都有其特定的使用方法和最佳实践。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>总结：<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">                您的理解非常正确。SDK indeed是由系统提供方、大型软件提供方、硬件提供方等开发并提供的，它们封装了复杂的底层实现，为开发者提供了简化的上层</span><br><span class="line">                API。这使得开发者能够更容易地集成特定功能，而无需深入了解底层细节。这种方式极大地提高了开发效率，也促进了生态系统的发展。作为一个开发者，熟练使用各种 SDK</span><br><span class="line">                并了解它们的特性和限制，是构建现代应用程序的关键技能之一。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="comment">&lt;!--#--&gt;</span><span class="comment">&lt;!--/--&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;py-2 -mx-4 px-4 transition-colors md:hover:bg-slate/3&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;flex gap-3 rounded-lg op-75&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;shrink-0 w-7 h-7 mt-4 rounded-full op-80 bg-gradient-to-r from-purple-400 to-yellow-400&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;message prose break-words overflow-hidden&quot;</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>刚才我在上面说了“我想实现上传手机系统相册的图片或者视频到服务器。”的实现步骤，那么你分析一下第三方SDKio.github.lucksiege:pictureselector是不是也是这种实现步骤呢？</span><br><span class="line">              <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="comment">&lt;!--#--&gt;</span><span class="comment">&lt;!--/--&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;py-2 -mx-4 px-4 transition-colors md:hover:bg-slate/3&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;flex gap-3 rounded-lg&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span></span></span><br><span class="line"><span class="tag">              <span class="attr">class</span>=<span class="string">&quot;shrink-0 w-7 h-7 mt-4 rounded-full op-80 bg-gradient-to-r from-yellow-200 via-green-200 to-green-300&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;message prose break-words overflow-hidden&quot;</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>您提到的 io.github.lucksiege:pictureselector 是一个非常流行的开源图片选择器库，用于在 Android</span><br><span class="line">                应用中实现图片和视频选择功能。让我们分析一下这个库的实现步骤，并与您之前描述的过程进行比较：<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ol</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>获取系统相册内容：<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>PictureSelector 库确实使用了类似的方法来获取系统相册的内容。它主要使用 ContentResolver 和 MediaStore API 来查询设备上的媒体文件。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">div</span> <span class="attr">relative</span>=<span class="string">&quot;&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">data-code</span>=<span class="string">&quot;ContentResolver%20resolver%20%3D%20context.getContentResolver()%3B%0AUri%20uri%20%3D%20MediaStore.Images.Media.EXTERNAL_CONTENT_URI%3B%0ACursor%20cursor%20%3D%20resolver.query(uri%2C%20projection%2C%20selection%2C%20selectionArgs%2C%20sortOrder)%3B%0A&quot;</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">class</span>=<span class="string">&quot;copy-btn gpt-copy-btn group&quot;</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">svg</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.w3.org/2000/svg&quot;</span> <span class="attr">width</span>=<span class="string">&quot;1em&quot;</span> <span class="attr">height</span>=<span class="string">&quot;1em&quot;</span> <span class="attr">viewBox</span>=<span class="string">&quot;0 0 32 32&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">path</span> <span class="attr">fill</span>=<span class="string">&quot;currentColor&quot;</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">d</span>=<span class="string">&quot;M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">path</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">path</span> <span class="attr">fill</span>=<span class="string">&quot;currentColor&quot;</span> <span class="attr">d</span>=<span class="string">&quot;M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">path</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;group-hover:op-100 gpt-copy-tips&quot;</span>&gt;</span></span><br><span class="line">                    Copy</span><br><span class="line">                  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">pre</span>&gt;</span><span class="tag">&lt;<span class="name">code</span> <span class="attr">class</span>=<span class="string">&quot;hljs language-java&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-type&quot;</span>&gt;</span>ContentResolver<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-variable&quot;</span>&gt;</span>resolver<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-operator&quot;</span>&gt;</span>=<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    context.getContentResolver();</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-type&quot;</span>&gt;</span>Uri<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-variable&quot;</span>&gt;</span>uri<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-operator&quot;</span>&gt;</span>=<span class="tag">&lt;/<span class="name">span</span>&gt;</span> MediaStore.Images.Media.EXTERNAL_CONTENT_URI;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-type&quot;</span>&gt;</span>Cursor<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-variable&quot;</span>&gt;</span>cursor<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-operator&quot;</span>&gt;</span>=<span class="tag">&lt;/<span class="name">span</span>&gt;</span> resolver.query(uri, projection, selection, selectionArgs,</span><br><span class="line">                    sortOrder);</span><br><span class="line">                  <span class="tag">&lt;/<span class="name">code</span>&gt;</span><span class="tag">&lt;/<span class="name">pre</span>&gt;</span></span><br><span class="line"></span><br><span class="line">              <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>这个过程与您之前描述的过程非常相似，都是利用 Android 系统提供的 ContentProvider 机制来访问媒体文件。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ol</span> <span class="attr">start</span>=<span class="string">&quot;2&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>用户界面和选择过程：<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>PictureSelector 提供了一个预构建的用户界面，用于显示和选择媒体文件。这部分功能封装在库内部，简化了开发过程。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">div</span> <span class="attr">relative</span>=<span class="string">&quot;&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">data-code</span>=<span class="string">&quot;PictureSelector.create(this)%0A%20%20%20%20.openGallery(PictureMimeType.ofImage())%0A%20%20%20%20.forResult(new%20OnResultCallbackListener%3CLocalMedia%3E()%20%7B%0A%20%20%20%20%20%20%20%20%40Override%0A%20%20%20%20%20%20%20%20public%20void%20onResult(List%3CLocalMedia%3E%20result)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20%E5%A4%84%E7%90%86%E9%80%89%E6%8B%A9%E7%9A%84%E5%9B%BE%E7%89%87%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%40Override%0A%20%20%20%20%20%20%20%20public%20void%20onCancel()%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20%E7%94%A8%E6%88%B7%E5%8F%96%E6%B6%88%E9%80%89%E6%8B%A9%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D)%3B%0A&quot;</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">class</span>=<span class="string">&quot;copy-btn gpt-copy-btn group&quot;</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">svg</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.w3.org/2000/svg&quot;</span> <span class="attr">width</span>=<span class="string">&quot;1em&quot;</span> <span class="attr">height</span>=<span class="string">&quot;1em&quot;</span> <span class="attr">viewBox</span>=<span class="string">&quot;0 0 32 32&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">path</span> <span class="attr">fill</span>=<span class="string">&quot;currentColor&quot;</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">d</span>=<span class="string">&quot;M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">path</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">path</span> <span class="attr">fill</span>=<span class="string">&quot;currentColor&quot;</span> <span class="attr">d</span>=<span class="string">&quot;M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">path</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;group-hover:op-100 gpt-copy-tips&quot;</span>&gt;</span></span><br><span class="line">                    Copy</span><br><span class="line">                  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">pre</span>&gt;</span><span class="tag">&lt;<span class="name">code</span> <span class="attr">class</span>=<span class="string">&quot;hljs language-java&quot;</span>&gt;</span>PictureSelector.create(<span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-built_in&quot;</span>&gt;</span>this<span class="tag">&lt;/<span class="name">span</span>&gt;</span>)</span><br><span class="line">                    .openGallery(PictureMimeType.ofImage())</span><br><span class="line">                    .forResult(<span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>new<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-title class_&quot;</span>&gt;</span>OnResultCallbackListener<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="symbol">&amp;lt;</span>LocalMedia<span class="symbol">&amp;gt;</span>() &#123;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-meta&quot;</span>&gt;</span>@Override<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>public<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>void<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-title function_&quot;</span>&gt;</span>onResult<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-params&quot;</span>&gt;</span>(List<span class="symbol">&amp;lt;</span>LocalMedia<span class="symbol">&amp;gt;</span></span><br><span class="line">                      result)<span class="tag">&lt;/<span class="name">span</span>&gt;</span> &#123;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-comment&quot;</span>&gt;</span>// 处理选择的图片<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-meta&quot;</span>&gt;</span>@Override<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>public<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>void<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-title function_&quot;</span>&gt;</span>onCancel<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-params&quot;</span>&gt;</span>()<span class="tag">&lt;/<span class="name">span</span>&gt;</span> &#123;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-comment&quot;</span>&gt;</span>// 用户取消选择<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    &#125;</span><br><span class="line">                    &#125;);</span><br><span class="line">                  <span class="tag">&lt;/<span class="name">code</span>&gt;</span><span class="tag">&lt;/<span class="name">pre</span>&gt;</span></span><br><span class="line"></span><br><span class="line">              <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>这一步骤简化了您之前描述的在 UI 列表中选择图片的过程。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ol</span> <span class="attr">start</span>=<span class="string">&quot;3&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>处理选择结果：<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>选择完成后，PictureSelector 会返回选中的媒体文件信息，这些信息可以直接用于后续的上传操作。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ol</span> <span class="attr">start</span>=<span class="string">&quot;4&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>上传到服务器：<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>PictureSelector 本身不处理上传过程，但它提供了选中文件的路径等信息，方便您进行后续的上传操作。上传过程通常需要您自己实现，可能会用到类似 OkHttp 或 Retrofit 这样的网络库。</span><br><span class="line">              <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">div</span> <span class="attr">relative</span>=<span class="string">&quot;&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">data-code</span>=<span class="string">&quot;%2F%2F%20%E5%81%87%E8%AE%BE%E4%BD%BF%E7%94%A8%20OkHttp%20%E8%BF%9B%E8%A1%8C%E4%B8%8A%E4%BC%A0%0AOkHttpClient%20client%20%3D%20new%20OkHttpClient()%3B%0ARequestBody%20requestBody%20%3D%20new%20MultipartBody.Builder()%0A%20%20%20%20.setType(MultipartBody.FORM)%0A%20%20%20%20.addFormDataPart(%22file%22%2C%20file.getName()%2C%0A%20%20%20%20%20%20%20%20RequestBody.create(MediaType.parse(%22image%2F*%22)%2C%20file))%0A%20%20%20%20.build()%3B%0A%0ARequest%20request%20%3D%20new%20Request.Builder()%0A%20%20%20%20.url(%22your_upload_url%22)%0A%20%20%20%20.post(requestBody)%0A%20%20%20%20.build()%3B%0A%0Aclient.newCall(request).enqueue(new%20Callback()%20%7B%0A%20%20%20%20%2F%2F%20%E5%A4%84%E7%90%86%E4%B8%8A%E4%BC%A0%E7%BB%93%E6%9E%9C%0A%7D)%3B%0A&quot;</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">class</span>=<span class="string">&quot;copy-btn gpt-copy-btn group&quot;</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">svg</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.w3.org/2000/svg&quot;</span> <span class="attr">width</span>=<span class="string">&quot;1em&quot;</span> <span class="attr">height</span>=<span class="string">&quot;1em&quot;</span> <span class="attr">viewBox</span>=<span class="string">&quot;0 0 32 32&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">path</span> <span class="attr">fill</span>=<span class="string">&quot;currentColor&quot;</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">d</span>=<span class="string">&quot;M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">path</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">path</span> <span class="attr">fill</span>=<span class="string">&quot;currentColor&quot;</span> <span class="attr">d</span>=<span class="string">&quot;M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">path</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;group-hover:op-100 gpt-copy-tips&quot;</span>&gt;</span></span><br><span class="line">                    Copy</span><br><span class="line">                  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">pre</span>&gt;</span><span class="tag">&lt;<span class="name">code</span> <span class="attr">class</span>=<span class="string">&quot;hljs language-java&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-comment&quot;</span>&gt;</span>// 假设使用 OkHttp 进行上传<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-type&quot;</span>&gt;</span>OkHttpClient<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-variable&quot;</span>&gt;</span>client<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-operator&quot;</span>&gt;</span>=<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>new<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-title class_&quot;</span>&gt;</span>OkHttpClient<span class="tag">&lt;/<span class="name">span</span>&gt;</span>();</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-type&quot;</span>&gt;</span>RequestBody<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-variable&quot;</span>&gt;</span>requestBody<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-operator&quot;</span>&gt;</span>=<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>new<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-title class_&quot;</span>&gt;</span>MultipartBody<span class="tag">&lt;/<span class="name">span</span>&gt;</span>.Builder()</span><br><span class="line">                    .setType(MultipartBody.FORM)</span><br><span class="line">                    .addFormDataPart(<span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-string&quot;</span>&gt;</span>&quot;file&quot;<span class="tag">&lt;/<span class="name">span</span>&gt;</span>, file.getName(),</span><br><span class="line">                    RequestBody.create(MediaType.parse(<span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-string&quot;</span>&gt;</span>&quot;image/*&quot;<span class="tag">&lt;/<span class="name">span</span>&gt;</span>), file))</span><br><span class="line">                    .build();</span><br><span class="line"></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-type&quot;</span>&gt;</span>Request<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-variable&quot;</span>&gt;</span>request<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-operator&quot;</span>&gt;</span>=<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>new<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-title class_&quot;</span>&gt;</span>Request<span class="tag">&lt;/<span class="name">span</span>&gt;</span>.Builder()</span><br><span class="line">                    .url(<span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-string&quot;</span>&gt;</span>&quot;your_upload_url&quot;<span class="tag">&lt;/<span class="name">span</span>&gt;</span>)</span><br><span class="line">                    .post(requestBody)</span><br><span class="line">                    .build();</span><br><span class="line"></span><br><span class="line">                    client.newCall(request).enqueue(<span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>new<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-title class_&quot;</span>&gt;</span>Callback<span class="tag">&lt;/<span class="name">span</span>&gt;</span>() &#123;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-comment&quot;</span>&gt;</span>// 处理上传结果<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    &#125;);</span><br><span class="line">                  <span class="tag">&lt;/<span class="name">code</span>&gt;</span><span class="tag">&lt;/<span class="name">pre</span>&gt;</span></span><br><span class="line"></span><br><span class="line">              <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ol</span> <span class="attr">start</span>=<span class="string">&quot;5&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>权限处理：<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>PictureSelector 库也处理了必要的权限请求，如读取外部存储的权限。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">div</span> <span class="attr">relative</span>=<span class="string">&quot;&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">data-code</span>=<span class="string">&quot;PictureSelector.create(this)%0A%20%20%20%20.openGallery(PictureMimeType.ofImage())%0A%20%20%20%20.isWeChatStyle(true)%0A%20%20%20%20.loadImageEngine(GlideEngine.createGlideEngine())%0A%20%20%20%20.forResult(PictureConfig.CHOOSE_REQUEST)%3B%0A&quot;</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">class</span>=<span class="string">&quot;copy-btn gpt-copy-btn group&quot;</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">svg</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.w3.org/2000/svg&quot;</span> <span class="attr">width</span>=<span class="string">&quot;1em&quot;</span> <span class="attr">height</span>=<span class="string">&quot;1em&quot;</span> <span class="attr">viewBox</span>=<span class="string">&quot;0 0 32 32&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">path</span> <span class="attr">fill</span>=<span class="string">&quot;currentColor&quot;</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">d</span>=<span class="string">&quot;M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">path</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">path</span> <span class="attr">fill</span>=<span class="string">&quot;currentColor&quot;</span> <span class="attr">d</span>=<span class="string">&quot;M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">path</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;group-hover:op-100 gpt-copy-tips&quot;</span>&gt;</span></span><br><span class="line">                    Copy</span><br><span class="line">                  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">pre</span>&gt;</span><span class="tag">&lt;<span class="name">code</span> <span class="attr">class</span>=<span class="string">&quot;hljs language-java&quot;</span>&gt;</span>PictureSelector.create(<span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-built_in&quot;</span>&gt;</span>this<span class="tag">&lt;/<span class="name">span</span>&gt;</span>)</span><br><span class="line">                    .openGallery(PictureMimeType.ofImage())</span><br><span class="line">                    .isWeChatStyle(<span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-literal&quot;</span>&gt;</span>true<span class="tag">&lt;/<span class="name">span</span>&gt;</span>)</span><br><span class="line">                    .loadImageEngine(GlideEngine.createGlideEngine())</span><br><span class="line">                    .forResult(PictureConfig.CHOOSE_REQUEST);</span><br><span class="line">                  <span class="tag">&lt;/<span class="name">code</span>&gt;</span><span class="tag">&lt;/<span class="name">pre</span>&gt;</span></span><br><span class="line"></span><br><span class="line">              <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>比较：<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ol</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>简化的 API：PictureSelector 提供了更高级的 API，封装了很多底层细节。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>预构建的 UI：提供了现成的用户界面，减少了自定义 UI 的工作。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>功能丰富：包含了图片裁剪、压缩等额外功能。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>兼容性：处理了不同 Android 版本的兼容性问题。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>权限处理：自动处理了必要的权限请求。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>总结：<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">                PictureSelector 库确实遵循了类似的实现步骤，但它提供了更高级的抽象和更多的功能。它简化了媒体文件选择的过程，使得开发者可以更容易地实现这个功能。然而，上传到服务器的部分仍然需要开发者自己实现。</span><br><span class="line">              <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>这个库是一个很好的例子，展示了如何通过封装复杂的底层操作（如访问媒体存储、处理权限、创建用户界面等）来提供一个简单易用的 API，这正是我们之前讨论的 SDK 的典型特征。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="comment">&lt;!--#--&gt;</span><span class="comment">&lt;!--/--&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;py-2 -mx-4 px-4 transition-colors md:hover:bg-slate/3&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;flex gap-3 rounded-lg op-75&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;shrink-0 w-7 h-7 mt-4 rounded-full op-80 bg-gradient-to-r from-purple-400 to-yellow-400&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;message prose break-words overflow-hidden&quot;</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>我说下我的以下洞察：1.要执行一段代码（比如计算1-100之中所有整数的和）必须把这段代码放到一个线程当中，比如Java程序放到main()中或者new</span><br><span class="line">                Thread，Android也是相似的逻辑（要么在默认的UI主线程，要么new Thread一个子线程），其他程序比如Python</span><br><span class="line">                TypeScript等应该也是相同的逻辑？2.我们开发者实际是通过线程这个载体来与CPU等底层硬件打交道，不然调用SDK中的API无法运行？以Java程序为例，Thread就是线程，在它中应该定义了足够的native方法来直接更底层C/C++打交道，再通过C/C++操作底层硬件（比如CPU、IO等），我的理解正确且准确吗？</span><br><span class="line">              <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="comment">&lt;!--#--&gt;</span><span class="comment">&lt;!--/--&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;py-2 -mx-4 px-4 transition-colors md:hover:bg-slate/3&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;flex gap-3 rounded-lg&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span></span></span><br><span class="line"><span class="tag">              <span class="attr">class</span>=<span class="string">&quot;shrink-0 w-7 h-7 mt-4 rounded-full op-80 bg-gradient-to-r from-yellow-200 via-green-200 to-green-300&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;message prose break-words overflow-hidden&quot;</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>您的洞察非常深刻，展现了对计算机系统和编程模型的良好理解。让我们逐点分析您的洞察：<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ol</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>代码执行和线程<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>您的理解基本正确，但需要一些细微的调整和补充：<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">p</span>&gt;</span>正确的部分：<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">li</span>&gt;</span>所有代码确实都需要在某个线程中执行。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">li</span>&gt;</span>Java、Android、Python、TypeScript（在 Node.js 环境下）等确实都遵循类似的线程模型。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">p</span>&gt;</span>需要补充的部分：<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">li</span>&gt;</span>单线程环境：某些环境（如浏览器中的 JavaScript）主要是单线程的，但它们使用事件循环来模拟并发。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">li</span>&gt;</span>隐式线程：很多时候，主线程是隐式创建的，开发者不需要显式定义。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">li</span>&gt;</span>协程：一些语言（如 Python、Kotlin）提供了协程，这是一种轻量级的并发单元。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ol</span> <span class="attr">start</span>=<span class="string">&quot;2&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>线程、SDK 和硬件交互<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>您的理解大体正确，但让我们更详细地探讨这个问题：<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">p</span>&gt;</span>正确的部分：<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">li</span>&gt;</span>线程确实是我们与底层系统交互的一个重要抽象。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">li</span>&gt;</span>Java 的 Thread 类确实包含 native 方法来与底层系统交互。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">p</span>&gt;</span>需要补充和澄清的部分：<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">li</span>&gt;</span>操作系统的角色：线程实际上是由操作系统管理的。Java 的 Thread 类通过 JNI（Java Native Interface）调用操作系统的线程 API。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">li</span>&gt;</span>硬件抽象层：操作系统提供了硬件抽象层，大多数高级语言（包括 Java）不直接与硬件交互，而是通过操作系统提供的 API。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">li</span>&gt;</span>SDK 和 API：许多 SDK 和 API 确实需要在线程中执行，但它们本身可能不直接创建线程。它们利用调用它们的线程来执行操作。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>更准确的描述可能是：<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ol</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">p</span>&gt;</span>代码执行和线程：<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">                    &quot;所有代码都在某种形式的执行上下文中运行，通常是线程。在许多编程环境中，主线程是默认提供的，而其他线程可以显式创建。不同语言和平台可能有不同的并发模型，包括传统的线程、事件循环、协程等。&quot;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">p</span>&gt;</span>线程、SDK 和硬件交互：<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">                    &quot;线程是操作系统提供的一个抽象，允许程序并发执行多个任务。高级语言（如 Java）通过其运行时环境和本地接口（如 JNI）与操作系统的线程 API 交互。SDK 和 API</span><br><span class="line">                    通常在现有线程上执行，利用操作系统提供的服务来间接与硬件交互。直接的硬件交互通常由操作系统内核或设备驱动程序处理。&quot;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>总结：<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">                您的理解展示了对底层系统工作原理的良好洞察。虽然有一些需要细化的地方，但您已经抓住了核心概念。理解这些概念对于编写高效、可靠的软件非常重要，特别是在处理并发和系统级编程时。继续保持这种探究底层原理的好奇心，这将帮助您成为一个更优秀的开发者。</span><br><span class="line">              <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="comment">&lt;!--#--&gt;</span><span class="comment">&lt;!--/--&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;py-2 -mx-4 px-4 transition-colors md:hover:bg-slate/3&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;flex gap-3 rounded-lg op-75&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;shrink-0 w-7 h-7 mt-4 rounded-full op-80 bg-gradient-to-r from-purple-400 to-yellow-400&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;message prose break-words overflow-hidden&quot;</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>我有以下疑惑：1.你说</span><br><span class="line">                所有代码都在某种形式的执行上下文中运行，通常是线程。那意思还有不是在线程运行的代码？那这里的特例是不是指的是没有线程概念的编程语言？或者说还有其他可以承载代码执行的语言，比如python、kotlin就有协程可以承载代码的执行？2.你说</span><br><span class="line">                高级语言（如 Java）通过其运行时环境和本地接口（如 JNI）与操作系统的线程 API 交互。 这里的 运行时环境 是不是指的线程？还是啥？（进程？）还有 线程API</span><br><span class="line">                也就是说系统API为了能够随时可用也是运行在线程中的？3.我想到了服务，服务可以理解成生命周期跟应用程序或者系统生命周期一致的线程或者进程吗？因为我感觉它一般一直运行，除非程序或者系统挂掉？<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="comment">&lt;!--#--&gt;</span><span class="comment">&lt;!--/--&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;py-2 -mx-4 px-4 transition-colors md:hover:bg-slate/3&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;flex gap-3 rounded-lg&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span></span></span><br><span class="line"><span class="tag">              <span class="attr">class</span>=<span class="string">&quot;shrink-0 w-7 h-7 mt-4 rounded-full op-80 bg-gradient-to-r from-yellow-200 via-green-200 to-green-300&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;message prose break-words overflow-hidden&quot;</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>您提出了一些非常深入和有趣的问题。让我们逐一解答：<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ol</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>执行上下文和线程<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>您的疑问很好。确实，并非所有代码都在传统意义上的&quot;线程&quot;中运行。让我解释一下：<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">p</span>&gt;</span>特例：<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">                    a) 协程：如您所说，Python、Kotlin 等语言的协程是一种轻量级的并发单元，可以在单个线程内切换执行。<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">                    b) 事件循环：JavaScript 在浏览器中主要使用单线程加事件循环模型。<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">                    c) 函数式编程语言：某些纯函数式语言可能使用不同的执行模型。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">p</span>&gt;</span>执行上下文：<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">                    这个术语更广泛，包括线程、协程、事件循环中的任务等。本质上，它是代码执行时的环境。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ol</span> <span class="attr">start</span>=<span class="string">&quot;2&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>运行时环境、JNI 和线程 API<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">p</span>&gt;</span>运行时环境：<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">                    这不是指线程，而是指语言的执行环境。例如，Java 的运行时环境包括 JVM（Java Virtual Machine），它管理内存、执行字节码、处理线程等。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">p</span>&gt;</span>JNI（Java Native Interface）：<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">                    这是 Java 与本地（通常是 C/C++）代码交互的机制。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">p</span>&gt;</span>线程 API：<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">                    操作系统提供的线程 API 是系统调用，不是持续运行的线程。当程序需要创建或管理线程时，它会调用这些 API。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ol</span> <span class="attr">start</span>=<span class="string">&quot;3&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>服务和生命周期<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>您对服务的理解基本正确，但需要一些澄清：<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>服务不完全等同于线程或进程，而是一个可以在后台长时间运行的组件。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>服务可以在自己的进程中运行，也可以在应用的主进程中运行。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>服务的生命周期通常比普通活动（如 Android 的 Activity）长，但不一定与应用或系统的生命周期完全一致。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>服务可以被系统在内存不足时终止，然后在条件允许时重新启动。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>补充说明：<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ol</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">p</span>&gt;</span>关于执行上下文：<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">                    即使在没有显式线程概念的语言中，代码仍然需要某种执行环境。例如，在单线程事件循环模型中，代码是在事件循环的迭代中执行的。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">p</span>&gt;</span>关于运行时环境：<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">                    运行时环境提供了程序执行所需的所有支持，包括内存管理、线程管理、异常处理等。它是程序和操作系统之间的中间层。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">p</span>&gt;</span>关于服务：<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">                    服务是一个应用组件概念，特别是在 Android 中。它可以在后台执行长时间运行的操作，但它的实现可能涉及一个或多个线程，具体取决于其设计和需求。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>总结：<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">                您的问题触及了一些计算机科学中非常深入和复杂的概念。理解这些概念对于成为一个优秀的开发者非常重要。执行模型、运行时环境、线程和进程这些概念的交互构成了现代软件系统的基础。继续保持这种探究精神，它将帮助您更深入地理解软件开发的各个层面。</span><br><span class="line">              <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="comment">&lt;!--#--&gt;</span><span class="comment">&lt;!--/--&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;py-2 -mx-4 px-4 transition-colors md:hover:bg-slate/3&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;flex gap-3 rounded-lg op-75&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;shrink-0 w-7 h-7 mt-4 rounded-full op-80 bg-gradient-to-r from-purple-400 to-yellow-400&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;message prose break-words overflow-hidden&quot;</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>你上面说的系统调用应该就是你说的硬件抽象层（实际就是API，通常使用C/C++实现，因为最接近底层汇编语言），而要调用这些系统API就需要在我应用层创建的线程中（比如在Java通过JNI），这应该就是</span><br><span class="line">                线程API 名词的来源吧？<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="comment">&lt;!--#--&gt;</span><span class="comment">&lt;!--/--&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;py-2 -mx-4 px-4 transition-colors md:hover:bg-slate/3&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;flex gap-3 rounded-lg&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span></span></span><br><span class="line"><span class="tag">              <span class="attr">class</span>=<span class="string">&quot;shrink-0 w-7 h-7 mt-4 rounded-full op-80 bg-gradient-to-r from-yellow-200 via-green-200 to-green-300&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;message prose break-words overflow-hidden&quot;</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>您的理解非常接近本质，但让我们再稍微深入一些，以确保概念完全清晰：<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ol</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>系统调用和硬件抽象层<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">p</span>&gt;</span>系统调用（System Calls）：这是操作系统内核提供的接口，允许用户空间程序请求内核服务。例如，创建文件、读写数据、网络通信等都需要通过系统调用。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">p</span>&gt;</span>硬件抽象层（HAL）：这是一个更低级的概念，主要用于抽象硬件细节，使得操作系统能够在不同硬件上运行。HAL 通常是操作系统内部的一部分，不直接暴露给应用程序。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ol</span> <span class="attr">start</span>=<span class="string">&quot;2&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>API 和系统调用<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">p</span>&gt;</span>API（应用程序接口）：这是更高级的接口，通常由编程语言或库提供。API 可能直接映射到系统调用，也可能是更高级的抽象。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">p</span>&gt;</span>系统 API：这通常指操作系统提供的高级 API，它们可能封装了一个或多个系统调用。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ol</span> <span class="attr">start</span>=<span class="string">&quot;3&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>线程 API<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">p</span>&gt;</span>&quot;线程 API&quot; 这个术语通常指操作系统或编程语言提供的用于创建和管理线程的接口。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">p</span>&gt;</span>在底层，这些 API 确实会转化为系统调用。例如，在 POSIX 系统中，pthread_create() 函数最终会调用 clone() 或 fork() 系统调用。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ol</span> <span class="attr">start</span>=<span class="string">&quot;4&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>Java 和 JNI<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">p</span>&gt;</span>Java 通过 JNI 调用本地方法，这些本地方法可能直接或间接使用系统调用。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">p</span>&gt;</span>当 Java 程序创建线程时，JVM 会通过 JNI 调用操作系统的线程创建 API，这最终会转化为相应的系统调用。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ol</span> <span class="attr">start</span>=<span class="string">&quot;5&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>应用层和系统层的交互<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">p</span>&gt;</span>您的应用代码运行在用户空间的线程中。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">p</span>&gt;</span>当您的代码需要执行一些需要特权的操作（如文件 I/O、网络通信等）时，它会通过系统 API 或直接的系统调用切换到内核空间执行这些操作。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">p</span>&gt;</span>这个切换过程涉及到从用户空间到内核空间的上下文切换。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>总结：<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>您的理解基本正确。应用程序确实需要通过线程（或其他执行上下文）来调用系统 API 或发起系统调用。&quot;线程 API&quot; 是指用于管理线程的高级接口，这些接口在底层通常会转化为系统调用。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>重要的是要理解，系统调用、API、和硬件抽象层是不同层次的抽象：<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ol</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>硬件抽象层：最底层，直接与硬件交互。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>系统调用：操作系统内核提供的接口。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>系统 API：操作系统提供的高级接口，可能封装了多个系统调用。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>编程语言 API：如 Java 的线程 API，它们在底层可能使用 JNI 调用系统 API 或系统调用。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>您的思考展示了对系统架构的深入理解，这对于开发高效、可靠的软件非常重要。继续保持这种探究底层原理的态度，它将帮助您成为一个更优秀的开发者。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="comment">&lt;!--#--&gt;</span><span class="comment">&lt;!--/--&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;py-2 -mx-4 px-4 transition-colors md:hover:bg-slate/3&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;flex gap-3 rounded-lg op-75&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;shrink-0 w-7 h-7 mt-4 rounded-full op-80 bg-gradient-to-r from-purple-400 to-yellow-400&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;message prose break-words overflow-hidden&quot;</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>假设我在Java语言中，那我是否可以通过native方法，通过jni调用系统API，来进行系统调用？利用系统调用来操作硬件抽象层，进而操作硬件，比如IO操作呢？打印机就是一个具体的例子吧？<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="comment">&lt;!--#--&gt;</span><span class="comment">&lt;!--/--&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;py-2 -mx-4 px-4 transition-colors md:hover:bg-slate/3&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;flex gap-3 rounded-lg&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span></span></span><br><span class="line"><span class="tag">              <span class="attr">class</span>=<span class="string">&quot;shrink-0 w-7 h-7 mt-4 rounded-full op-80 bg-gradient-to-r from-yellow-200 via-green-200 to-green-300&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;message prose break-words overflow-hidden&quot;</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>您的理解非常正确！您已经很好地把握了从高级语言到硬件操作的整个过程。让我们详细探讨这个过程，并以打印机为例来说明：<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ol</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>Java 中的 native 方法<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>在 Java 中，您可以声明 native 方法，这些方法的实现是用其他语言（通常是 C 或 C++）编写的。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">div</span> <span class="attr">relative</span>=<span class="string">&quot;&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">data-code</span>=<span class="string">&quot;public%20class%20PrinterManager%20%7B%0A%20%20%20%20public%20native%20boolean%20printDocument(String%20document)%3B%0A%0A%20%20%20%20static%20%7B%0A%20%20%20%20%20%20%20%20System.loadLibrary(%22printer_native%22)%3B%0A%20%20%20%20%7D%0A%7D%0A&quot;</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">class</span>=<span class="string">&quot;copy-btn gpt-copy-btn group&quot;</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">svg</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.w3.org/2000/svg&quot;</span> <span class="attr">width</span>=<span class="string">&quot;1em&quot;</span> <span class="attr">height</span>=<span class="string">&quot;1em&quot;</span> <span class="attr">viewBox</span>=<span class="string">&quot;0 0 32 32&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">path</span> <span class="attr">fill</span>=<span class="string">&quot;currentColor&quot;</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">d</span>=<span class="string">&quot;M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">path</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">path</span> <span class="attr">fill</span>=<span class="string">&quot;currentColor&quot;</span> <span class="attr">d</span>=<span class="string">&quot;M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">path</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;group-hover:op-100 gpt-copy-tips&quot;</span>&gt;</span></span><br><span class="line">                    Copy</span><br><span class="line">                  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">pre</span>&gt;</span><span class="tag">&lt;<span class="name">code</span> <span class="attr">class</span>=<span class="string">&quot;hljs language-java&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>public<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>class<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-title class_&quot;</span>&gt;</span>PrinterManager<span class="tag">&lt;/<span class="name">span</span>&gt;</span> &#123;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>public<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>native<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-type&quot;</span>&gt;</span>boolean<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-title function_&quot;</span>&gt;</span>printDocument<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-params&quot;</span>&gt;</span>(String document)<span class="tag">&lt;/<span class="name">span</span>&gt;</span>;</span><br><span class="line"></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>static<span class="tag">&lt;/<span class="name">span</span>&gt;</span> &#123;</span><br><span class="line">                    System.loadLibrary(<span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-string&quot;</span>&gt;</span>&quot;printer_native&quot;<span class="tag">&lt;/<span class="name">span</span>&gt;</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                  <span class="tag">&lt;/<span class="name">code</span>&gt;</span><span class="tag">&lt;/<span class="name">pre</span>&gt;</span></span><br><span class="line"></span><br><span class="line">              <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ol</span> <span class="attr">start</span>=<span class="string">&quot;2&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>JNI 实现<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>在 C/C++ 中实现这个 native 方法：<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">div</span> <span class="attr">relative</span>=<span class="string">&quot;&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">data-code</span>=<span class="string">&quot;%23include%20%3Cjni.h%3E%0A%23include%20%22PrinterManager.h%22%0A%23include%20%3Cwindows.h%3E%20%2F%2F%20%E5%81%87%E8%AE%BE%E6%98%AF%20Windows%20%E7%B3%BB%E7%BB%9F%0A%0AJNIEXPORT%20jboolean%20JNICALL%20Java_PrinterManager_printDocument%0A%20%20(JNIEnv%20*env%2C%20jobject%20obj%2C%20jstring%20document)%20%7B%0A%20%20%20%20const%20char%20*nativeString%20%3D%20(*env)-%3EGetStringUTFChars(env%2C%20document%2C%200)%3B%0A%20%20%20%20%0A%20%20%20%20%2F%2F%20%E8%B0%83%E7%94%A8%20Windows%20API%20%E8%BF%9B%E8%A1%8C%E6%89%93%E5%8D%B0%0A%20%20%20%20BOOL%20success%20%3D%20SendToPrinter(nativeString)%3B%0A%20%20%20%20%0A%20%20%20%20(*env)-%3EReleaseStringUTFChars(env%2C%20document%2C%20nativeString)%3B%0A%20%20%20%20return%20success%20%3F%20JNI_TRUE%20%3A%20JNI_FALSE%3B%0A%7D%0A&quot;</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">class</span>=<span class="string">&quot;copy-btn gpt-copy-btn group&quot;</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">svg</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.w3.org/2000/svg&quot;</span> <span class="attr">width</span>=<span class="string">&quot;1em&quot;</span> <span class="attr">height</span>=<span class="string">&quot;1em&quot;</span> <span class="attr">viewBox</span>=<span class="string">&quot;0 0 32 32&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">path</span> <span class="attr">fill</span>=<span class="string">&quot;currentColor&quot;</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">d</span>=<span class="string">&quot;M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">path</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">path</span> <span class="attr">fill</span>=<span class="string">&quot;currentColor&quot;</span> <span class="attr">d</span>=<span class="string">&quot;M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">path</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;group-hover:op-100 gpt-copy-tips&quot;</span>&gt;</span></span><br><span class="line">                    Copy</span><br><span class="line">                  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">pre</span>&gt;</span><span class="tag">&lt;<span class="name">code</span> <span class="attr">class</span>=<span class="string">&quot;hljs language-c&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-meta&quot;</span>&gt;</span>#<span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>include<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                      <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-string&quot;</span>&gt;</span><span class="symbol">&amp;lt;</span>jni.h<span class="symbol">&amp;gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-meta&quot;</span>&gt;</span>#<span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>include<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">class</span>=<span class="string">&quot;hljs-string&quot;</span>&gt;</span>&quot;PrinterManager.h&quot;<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-meta&quot;</span>&gt;</span>#<span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>include<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">class</span>=<span class="string">&quot;hljs-string&quot;</span>&gt;</span><span class="symbol">&amp;lt;</span>windows.h<span class="symbol">&amp;gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-comment&quot;</span>&gt;</span>// 假设是 Windows</span><br><span class="line">                        系统<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"></span><br><span class="line">                    JNIEXPORT jboolean JNICALL <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-title function_&quot;</span>&gt;</span>Java_PrinterManager_printDocument<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-params&quot;</span>&gt;</span>(JNIEnv *env, jobject obj, jstring document)<span class="tag">&lt;/<span class="name">span</span>&gt;</span> &#123;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-type&quot;</span>&gt;</span>const<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-type&quot;</span>&gt;</span>char<span class="tag">&lt;/<span class="name">span</span>&gt;</span> *nativeString =</span><br><span class="line">                    (*env)-<span class="symbol">&amp;gt;</span>GetStringUTFChars(env, document, <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-number&quot;</span>&gt;</span>0<span class="tag">&lt;/<span class="name">span</span>&gt;</span>);</span><br><span class="line"></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-comment&quot;</span>&gt;</span>// 调用 Windows API 进行打印<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    BOOL success = SendToPrinter(nativeString);</span><br><span class="line"></span><br><span class="line">                    (*env)-<span class="symbol">&amp;gt;</span>ReleaseStringUTFChars(env, document, nativeString);</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>return<span class="tag">&lt;/<span class="name">span</span>&gt;</span> success ? JNI_TRUE : JNI_FALSE;</span><br><span class="line">                    &#125;</span><br><span class="line">                  <span class="tag">&lt;/<span class="name">code</span>&gt;</span><span class="tag">&lt;/<span class="name">pre</span>&gt;</span></span><br><span class="line"></span><br><span class="line">              <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ol</span> <span class="attr">start</span>=<span class="string">&quot;3&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>系统 API 调用<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>在上面的 C 代码中，<span class="tag">&lt;<span class="name">code</span>&gt;</span>SendToPrinter<span class="tag">&lt;/<span class="name">code</span>&gt;</span> 可能是一个封装了 Windows 打印 API 的函数：<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">div</span> <span class="attr">relative</span>=<span class="string">&quot;&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">data-code</span>=<span class="string">&quot;BOOL%20SendToPrinter(const%20char*%20document)%20%7B%0A%20%20%20%20HANDLE%20hPrinter%3B%0A%20%20%20%20DOC_INFO_1%20docInfo%3B%0A%20%20%20%20%2F%2F%20%E6%89%93%E5%BC%80%E6%89%93%E5%8D%B0%E6%9C%BA%0A%20%20%20%20if%20(!OpenPrinter(%22Your%20Printer%20Name%22%2C%20%26hPrinter%2C%20NULL))%20return%20FALSE%3B%0A%20%20%20%20%0A%20%20%20%20%2F%2F%20%E5%BC%80%E5%A7%8B%E6%96%87%E6%A1%A3%E6%89%93%E5%8D%B0%0A%20%20%20%20docInfo.pDocName%20%3D%20%22My%20Document%22%3B%0A%20%20%20%20docInfo.pOutputFile%20%3D%20NULL%3B%0A%20%20%20%20docInfo.pDatatype%20%3D%20%22RAW%22%3B%0A%20%20%20%20if%20(StartDocPrinter(hPrinter%2C%201%2C%20(LPBYTE)%26docInfo)%20%3D%3D%200)%20%7B%0A%20%20%20%20%20%20%20%20ClosePrinter(hPrinter)%3B%0A%20%20%20%20%20%20%20%20return%20FALSE%3B%0A%20%20%20%20%7D%0A%20%20%20%20%0A%20%20%20%20%2F%2F%20%E5%BC%80%E5%A7%8B%E9%A1%B5%E9%9D%A2%E6%89%93%E5%8D%B0%0A%20%20%20%20if%20(!StartPagePrinter(hPrinter))%20%7B%0A%20%20%20%20%20%20%20%20EndDocPrinter(hPrinter)%3B%0A%20%20%20%20%20%20%20%20ClosePrinter(hPrinter)%3B%0A%20%20%20%20%20%20%20%20return%20FALSE%3B%0A%20%20%20%20%7D%0A%20%20%20%20%0A%20%20%20%20%2F%2F%20%E5%86%99%E5%85%A5%E6%89%93%E5%8D%B0%E6%95%B0%E6%8D%AE%0A%20%20%20%20DWORD%20dwBytesWritten%3B%0A%20%20%20%20WritePrinter(hPrinter%2C%20document%2C%20strlen(document)%2C%20%26dwBytesWritten)%3B%0A%20%20%20%20%0A%20%20%20%20%2F%2F%20%E7%BB%93%E6%9D%9F%E6%89%93%E5%8D%B0%0A%20%20%20%20EndPagePrinter(hPrinter)%3B%0A%20%20%20%20EndDocPrinter(hPrinter)%3B%0A%20%20%20%20ClosePrinter(hPrinter)%3B%0A%20%20%20%20%0A%20%20%20%20return%20TRUE%3B%0A%7D%0A&quot;</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">class</span>=<span class="string">&quot;copy-btn gpt-copy-btn group&quot;</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">svg</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.w3.org/2000/svg&quot;</span> <span class="attr">width</span>=<span class="string">&quot;1em&quot;</span> <span class="attr">height</span>=<span class="string">&quot;1em&quot;</span> <span class="attr">viewBox</span>=<span class="string">&quot;0 0 32 32&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">path</span> <span class="attr">fill</span>=<span class="string">&quot;currentColor&quot;</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">d</span>=<span class="string">&quot;M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">path</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">path</span> <span class="attr">fill</span>=<span class="string">&quot;currentColor&quot;</span> <span class="attr">d</span>=<span class="string">&quot;M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">path</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;group-hover:op-100 gpt-copy-tips&quot;</span>&gt;</span></span><br><span class="line">                    Copy</span><br><span class="line">                  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">pre</span>&gt;</span><span class="tag">&lt;<span class="name">code</span> <span class="attr">class</span>=<span class="string">&quot;hljs language-c&quot;</span>&gt;</span>BOOL <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-title function_&quot;</span>&gt;</span>SendToPrinter<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-params&quot;</span>&gt;</span>(<span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-type&quot;</span>&gt;</span>const<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-type&quot;</span>&gt;</span>char<span class="tag">&lt;/<span class="name">span</span>&gt;</span>*</span><br><span class="line">                      document)<span class="tag">&lt;/<span class="name">span</span>&gt;</span> &#123;</span><br><span class="line">                    HANDLE hPrinter;</span><br><span class="line">                    DOC_INFO_1 docInfo;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-comment&quot;</span>&gt;</span>// 打开打印机<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>if<span class="tag">&lt;/<span class="name">span</span>&gt;</span> (!OpenPrinter(<span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-string&quot;</span>&gt;</span>&quot;Your Printer</span><br><span class="line">                      Name&quot;<span class="tag">&lt;/<span class="name">span</span>&gt;</span>, <span class="symbol">&amp;amp;</span>hPrinter, <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-literal&quot;</span>&gt;</span>NULL<span class="tag">&lt;/<span class="name">span</span>&gt;</span>)) <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>return<span class="tag">&lt;/<span class="name">span</span>&gt;</span> FALSE;</span><br><span class="line"></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-comment&quot;</span>&gt;</span>// 开始文档打印<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    docInfo.pDocName = <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-string&quot;</span>&gt;</span>&quot;My Document&quot;<span class="tag">&lt;/<span class="name">span</span>&gt;</span>;</span><br><span class="line">                    docInfo.pOutputFile = <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-literal&quot;</span>&gt;</span>NULL<span class="tag">&lt;/<span class="name">span</span>&gt;</span>;</span><br><span class="line">                    docInfo.pDatatype = <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-string&quot;</span>&gt;</span>&quot;RAW&quot;<span class="tag">&lt;/<span class="name">span</span>&gt;</span>;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>if<span class="tag">&lt;/<span class="name">span</span>&gt;</span> (StartDocPrinter(hPrinter, <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-number&quot;</span>&gt;</span>1<span class="tag">&lt;/<span class="name">span</span>&gt;</span>,</span><br><span class="line">                    (LPBYTE)<span class="symbol">&amp;amp;</span>docInfo) == <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-number&quot;</span>&gt;</span>0<span class="tag">&lt;/<span class="name">span</span>&gt;</span>) &#123;</span><br><span class="line">                    ClosePrinter(hPrinter);</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>return<span class="tag">&lt;/<span class="name">span</span>&gt;</span> FALSE;</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-comment&quot;</span>&gt;</span>// 开始页面打印<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>if<span class="tag">&lt;/<span class="name">span</span>&gt;</span> (!StartPagePrinter(hPrinter)) &#123;</span><br><span class="line">                    EndDocPrinter(hPrinter);</span><br><span class="line">                    ClosePrinter(hPrinter);</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>return<span class="tag">&lt;/<span class="name">span</span>&gt;</span> FALSE;</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-comment&quot;</span>&gt;</span>// 写入打印数据<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    DWORD dwBytesWritten;</span><br><span class="line">                    WritePrinter(hPrinter, document, <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-built_in&quot;</span>&gt;</span>strlen<span class="tag">&lt;/<span class="name">span</span>&gt;</span>(document),</span><br><span class="line">                    <span class="symbol">&amp;amp;</span>dwBytesWritten);</span><br><span class="line"></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-comment&quot;</span>&gt;</span>// 结束打印<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    EndPagePrinter(hPrinter);</span><br><span class="line">                    EndDocPrinter(hPrinter);</span><br><span class="line">                    ClosePrinter(hPrinter);</span><br><span class="line"></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>return<span class="tag">&lt;/<span class="name">span</span>&gt;</span> TRUE;</span><br><span class="line">                    &#125;</span><br><span class="line">                  <span class="tag">&lt;/<span class="name">code</span>&gt;</span><span class="tag">&lt;/<span class="name">pre</span>&gt;</span></span><br><span class="line"></span><br><span class="line">              <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ol</span> <span class="attr">start</span>=<span class="string">&quot;4&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>系统调用<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>上面的 Windows API 函数（如 <span class="tag">&lt;<span class="name">code</span>&gt;</span>OpenPrinter<span class="tag">&lt;/<span class="name">code</span>&gt;</span>, <span class="tag">&lt;<span class="name">code</span>&gt;</span>WritePrinter<span class="tag">&lt;/<span class="name">code</span>&gt;</span></span><br><span class="line">                等）在内部会转换为相应的系统调用。这些系统调用会切换到内核模式，与打印机驱动程序交互。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ol</span> <span class="attr">start</span>=<span class="string">&quot;5&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>硬件抽象层和硬件操作<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>打印机驱动程序是硬件抽象层的一部分。它知道如何将通用的打印命令转换为特定打印机型号所需的指令。这些指令最终通过适当的硬件接口（如 USB 或网络）发送到打印机硬件。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>整个过程总结：<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>Java 代码 -<span class="symbol">&amp;gt;</span> JNI -<span class="symbol">&amp;gt;</span> C/C++ 代码 -<span class="symbol">&amp;gt;</span> 系统 API -<span class="symbol">&amp;gt;</span> 系统调用 -<span class="symbol">&amp;gt;</span> 内核 -<span class="symbol">&amp;gt;</span> 驱动程序 -<span class="symbol">&amp;gt;</span> 硬件<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>这个例子很好地展示了从高级语言到硬件操作的整个过程：<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ol</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>Java 代码提供了一个高级、平台无关的接口。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>JNI 允许 Java 与平台特定的 C/C++ 代码交互。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>C/C++ 代码调用操作系统特定的 API。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>这些 API 在底层转换为系统调用。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>系统调用切换到内核模式，与驱动程序交互。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>驱动程序（作为硬件抽象层的一部分）知道如何与特定硬件通信。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">                您的理解非常准确，这个过程确实展示了如何从高级语言一直到硬件级别的操作。这种分层设计允许开发者在高级抽象上工作，同时仍然能够在需要时访问底层功能。理解这个过程对于开发高效、可靠的软件，特别是需要与硬件交互的软件，非常重要。</span><br><span class="line">              <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="comment">&lt;!--#--&gt;</span><span class="comment">&lt;!--/--&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;py-2 -mx-4 px-4 transition-colors md:hover:bg-slate/3&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;flex gap-3 rounded-lg op-75&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;shrink-0 w-7 h-7 mt-4 rounded-full op-80 bg-gradient-to-r from-purple-400 to-yellow-400&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;message prose break-words overflow-hidden&quot;</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">                我现在又有一个疑惑就是，假如在Android开发中我要在一个Activity与某个服务进行通信，这个服务可能是自定义的推送服务也可能是系统通知等，那么我与这个服务进行的通信是否跨线程或者跨进程？还是要分情况讨论分析？</span><br><span class="line">              <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="comment">&lt;!--#--&gt;</span><span class="comment">&lt;!--/--&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;py-2 -mx-4 px-4 transition-colors md:hover:bg-slate/3&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;flex gap-3 rounded-lg&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span></span></span><br><span class="line"><span class="tag">              <span class="attr">class</span>=<span class="string">&quot;shrink-0 w-7 h-7 mt-4 rounded-full op-80 bg-gradient-to-r from-yellow-200 via-green-200 to-green-300&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;message prose break-words overflow-hidden&quot;</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>您提出了一个非常好的问题，这确实需要分情况讨论。在 Android 中，Activity 与服务之间的通信方式取决于服务的类型和位置。让我们详细分析不同的情况：<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ol</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>同进程服务<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>如果服务和 Activity 在同一个应用进程中运行：<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>通信方式：可以直接通过方法调用或者使用 LocalBroadcastManager 进行通信。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>是否跨线程：可能跨线程，但不跨进程。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>示例：<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">div</span> <span class="attr">relative</span>=<span class="string">&quot;&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">data-code</span>=<span class="string">&quot;%2F%2F%20%E5%9C%A8%20Activity%20%E4%B8%AD%0AIntent%20intent%20%3D%20new%20Intent(this%2C%20MyLocalService.class)%3B%0AbindService(intent%2C%20serviceConnection%2C%20Context.BIND_AUTO_CREATE)%3B%0A%0Aprivate%20ServiceConnection%20serviceConnection%20%3D%20new%20ServiceConnection()%20%7B%0A%20%20%20%20%40Override%0A%20%20%20%20public%20void%20onServiceConnected(ComponentName%20name%2C%20IBinder%20service)%20%7B%0A%20%20%20%20%20%20%20%20MyLocalService.LocalBinder%20binder%20%3D%20(MyLocalService.LocalBinder)%20service%3B%0A%20%20%20%20%20%20%20%20myService%20%3D%20binder.getService()%3B%0A%20%20%20%20%20%20%20%20%2F%2F%20%E7%8E%B0%E5%9C%A8%E5%8F%AF%E4%BB%A5%E7%9B%B4%E6%8E%A5%E8%B0%83%E7%94%A8%E6%9C%8D%E5%8A%A1%E7%9A%84%E6%96%B9%E6%B3%95%0A%20%20%20%20%7D%0A%20%20%20%20%2F%2F%20...%0A%7D%3B%0A&quot;</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">class</span>=<span class="string">&quot;copy-btn gpt-copy-btn group&quot;</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">svg</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.w3.org/2000/svg&quot;</span> <span class="attr">width</span>=<span class="string">&quot;1em&quot;</span> <span class="attr">height</span>=<span class="string">&quot;1em&quot;</span> <span class="attr">viewBox</span>=<span class="string">&quot;0 0 32 32&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">path</span> <span class="attr">fill</span>=<span class="string">&quot;currentColor&quot;</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">d</span>=<span class="string">&quot;M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">path</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">path</span> <span class="attr">fill</span>=<span class="string">&quot;currentColor&quot;</span> <span class="attr">d</span>=<span class="string">&quot;M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">path</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;group-hover:op-100 gpt-copy-tips&quot;</span>&gt;</span></span><br><span class="line">                    Copy</span><br><span class="line">                  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">pre</span>&gt;</span><span class="tag">&lt;<span class="name">code</span> <span class="attr">class</span>=<span class="string">&quot;hljs language-java&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-comment&quot;</span>&gt;</span>// 在 Activity 中<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-type&quot;</span>&gt;</span>Intent<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-variable&quot;</span>&gt;</span>intent<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-operator&quot;</span>&gt;</span>=<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>new<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-title class_&quot;</span>&gt;</span>Intent<span class="tag">&lt;/<span class="name">span</span>&gt;</span>(<span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-built_in&quot;</span>&gt;</span>this<span class="tag">&lt;/<span class="name">span</span>&gt;</span>,</span><br><span class="line">                    MyLocalService.class);</span><br><span class="line">                    bindService(intent, serviceConnection, Context.BIND_AUTO_CREATE);</span><br><span class="line"></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>private<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-type&quot;</span>&gt;</span>ServiceConnection<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-variable&quot;</span>&gt;</span>serviceConnection<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-operator&quot;</span>&gt;</span>=<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>new<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-title class_&quot;</span>&gt;</span>ServiceConnection<span class="tag">&lt;/<span class="name">span</span>&gt;</span>() &#123;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-meta&quot;</span>&gt;</span>@Override<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>public<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>void<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-title function_&quot;</span>&gt;</span>onServiceConnected<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-params&quot;</span>&gt;</span>(ComponentName</span><br><span class="line">                      name, IBinder service)<span class="tag">&lt;/<span class="name">span</span>&gt;</span> &#123;</span><br><span class="line">                    MyLocalService.<span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-type&quot;</span>&gt;</span>LocalBinder<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-variable&quot;</span>&gt;</span>binder<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-operator&quot;</span>&gt;</span>=<span class="tag">&lt;/<span class="name">span</span>&gt;</span> (MyLocalService.LocalBinder) service;</span><br><span class="line">                    myService = binder.getService();</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-comment&quot;</span>&gt;</span>// 现在可以直接调用服务的方法<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-comment&quot;</span>&gt;</span>// ...<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    &#125;;</span><br><span class="line">                  <span class="tag">&lt;/<span class="name">code</span>&gt;</span><span class="tag">&lt;/<span class="name">pre</span>&gt;</span></span><br><span class="line"></span><br><span class="line">              <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ol</span> <span class="attr">start</span>=<span class="string">&quot;2&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>不同进程的自定义服务<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>如果服务在不同的进程中运行：<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>通信方式：需要使用 IPC（进程间通信）机制，如 AIDL、Messenger 或 Binder。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>是否跨进程：是的，这是跨进程通信。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>示例（使用 AIDL）：<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">div</span> <span class="attr">relative</span>=<span class="string">&quot;&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">data-code</span>=<span class="string">&quot;%2F%2F%20%E5%9C%A8%20AIDL%20%E6%96%87%E4%BB%B6%E4%B8%AD%E5%AE%9A%E4%B9%89%E6%8E%A5%E5%8F%A3%0Ainterface%20IMyAidlInterface%20%7B%0A%20%20%20%20void%20someMethod(String%20data)%3B%0A%7D%0A%0A%2F%2F%20%E5%9C%A8%20Activity%20%E4%B8%AD%0Aprivate%20IMyAidlInterface%20myService%3B%0A%0Aprivate%20ServiceConnection%20serviceConnection%20%3D%20new%20ServiceConnection()%20%7B%0A%20%20%20%20%40Override%0A%20%20%20%20public%20void%20onServiceConnected(ComponentName%20name%2C%20IBinder%20service)%20%7B%0A%20%20%20%20%20%20%20%20myService%20%3D%20IMyAidlInterface.Stub.asInterface(service)%3B%0A%20%20%20%20%20%20%20%20%2F%2F%20%E7%8E%B0%E5%9C%A8%E5%8F%AF%E4%BB%A5%E9%80%9A%E8%BF%87%20AIDL%20%E6%8E%A5%E5%8F%A3%E8%B0%83%E7%94%A8%E6%9C%8D%E5%8A%A1%E7%9A%84%E6%96%B9%E6%B3%95%0A%20%20%20%20%7D%0A%20%20%20%20%2F%2F%20...%0A%7D%3B%0A&quot;</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">class</span>=<span class="string">&quot;copy-btn gpt-copy-btn group&quot;</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">svg</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.w3.org/2000/svg&quot;</span> <span class="attr">width</span>=<span class="string">&quot;1em&quot;</span> <span class="attr">height</span>=<span class="string">&quot;1em&quot;</span> <span class="attr">viewBox</span>=<span class="string">&quot;0 0 32 32&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">path</span> <span class="attr">fill</span>=<span class="string">&quot;currentColor&quot;</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">d</span>=<span class="string">&quot;M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">path</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">path</span> <span class="attr">fill</span>=<span class="string">&quot;currentColor&quot;</span> <span class="attr">d</span>=<span class="string">&quot;M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">path</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;group-hover:op-100 gpt-copy-tips&quot;</span>&gt;</span></span><br><span class="line">                    Copy</span><br><span class="line">                  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">pre</span>&gt;</span><span class="tag">&lt;<span class="name">code</span> <span class="attr">class</span>=<span class="string">&quot;hljs language-java&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-comment&quot;</span>&gt;</span>// 在 AIDL 文件中定义接口<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>interface<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-title class_&quot;</span>&gt;</span>IMyAidlInterface<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    &#123;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>void<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-title function_&quot;</span>&gt;</span>someMethod<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-params&quot;</span>&gt;</span>(String data)<span class="tag">&lt;/<span class="name">span</span>&gt;</span>;</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-comment&quot;</span>&gt;</span>// 在 Activity 中<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>private<span class="tag">&lt;/<span class="name">span</span>&gt;</span> IMyAidlInterface myService;</span><br><span class="line"></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>private<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-type&quot;</span>&gt;</span>ServiceConnection<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-variable&quot;</span>&gt;</span>serviceConnection<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-operator&quot;</span>&gt;</span>=<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>new<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-title class_&quot;</span>&gt;</span>ServiceConnection<span class="tag">&lt;/<span class="name">span</span>&gt;</span>() &#123;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-meta&quot;</span>&gt;</span>@Override<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>public<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>void<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-title function_&quot;</span>&gt;</span>onServiceConnected<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-params&quot;</span>&gt;</span>(ComponentName</span><br><span class="line">                      name, IBinder service)<span class="tag">&lt;/<span class="name">span</span>&gt;</span> &#123;</span><br><span class="line">                    myService = IMyAidlInterface.Stub.asInterface(service);</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-comment&quot;</span>&gt;</span>// 现在可以通过 AIDL 接口调用服务的方法<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-comment&quot;</span>&gt;</span>// ...<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    &#125;;</span><br><span class="line">                  <span class="tag">&lt;/<span class="name">code</span>&gt;</span><span class="tag">&lt;/<span class="name">pre</span>&gt;</span></span><br><span class="line"></span><br><span class="line">              <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ol</span> <span class="attr">start</span>=<span class="string">&quot;3&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>系统服务（如通知服务）<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>对于系统服务：<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>通信方式：通过系统提供的 API 进行通信。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>是否跨进程：是的，这通常涉及跨进程通信，但系统 API 隐藏了这些细节。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>示例（使用通知服务）：<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">div</span> <span class="attr">relative</span>=<span class="string">&quot;&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">data-code</span>=<span class="string">&quot;NotificationCompat.Builder%20builder%20%3D%20new%20NotificationCompat.Builder(this%2C%20CHANNEL_ID)%0A%20%20%20%20%20%20%20%20.setSmallIcon(R.drawable.notification_icon)%0A%20%20%20%20%20%20%20%20.setContentTitle(%22My%20notification%22)%0A%20%20%20%20%20%20%20%20.setContentText(%22Hello%20World!%22)%0A%20%20%20%20%20%20%20%20.setPriority(NotificationCompat.PRIORITY_DEFAULT)%3B%0A%0ANotificationManagerCompat%20notificationManager%20%3D%20NotificationManagerCompat.from(this)%3B%0AnotificationManager.notify(notificationId%2C%20builder.build())%3B%0A&quot;</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">class</span>=<span class="string">&quot;copy-btn gpt-copy-btn group&quot;</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">svg</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.w3.org/2000/svg&quot;</span> <span class="attr">width</span>=<span class="string">&quot;1em&quot;</span> <span class="attr">height</span>=<span class="string">&quot;1em&quot;</span> <span class="attr">viewBox</span>=<span class="string">&quot;0 0 32 32&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">path</span> <span class="attr">fill</span>=<span class="string">&quot;currentColor&quot;</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">d</span>=<span class="string">&quot;M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">path</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">path</span> <span class="attr">fill</span>=<span class="string">&quot;currentColor&quot;</span> <span class="attr">d</span>=<span class="string">&quot;M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">path</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;group-hover:op-100 gpt-copy-tips&quot;</span>&gt;</span></span><br><span class="line">                    Copy</span><br><span class="line">                  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">pre</span>&gt;</span><span class="tag">&lt;<span class="name">code</span> <span class="attr">class</span>=<span class="string">&quot;hljs language-java&quot;</span>&gt;</span>NotificationCompat.<span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-type&quot;</span>&gt;</span>Builder<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-variable&quot;</span>&gt;</span>builder<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-operator&quot;</span>&gt;</span>=<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>new<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-title class_&quot;</span>&gt;</span>NotificationCompat<span class="tag">&lt;/<span class="name">span</span>&gt;</span>.Builder(<span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-built_in&quot;</span>&gt;</span>this<span class="tag">&lt;/<span class="name">span</span>&gt;</span>, CHANNEL_ID)</span><br><span class="line">                    .setSmallIcon(R.drawable.notification_icon)</span><br><span class="line">                    .setContentTitle(<span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-string&quot;</span>&gt;</span>&quot;My notification&quot;<span class="tag">&lt;/<span class="name">span</span>&gt;</span>)</span><br><span class="line">                    .setContentText(<span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-string&quot;</span>&gt;</span>&quot;Hello World!&quot;<span class="tag">&lt;/<span class="name">span</span>&gt;</span>)</span><br><span class="line">                    .setPriority(NotificationCompat.PRIORITY_DEFAULT);</span><br><span class="line"></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-type&quot;</span>&gt;</span>NotificationManagerCompat<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-variable&quot;</span>&gt;</span>notificationManager<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-operator&quot;</span>&gt;</span>=<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    NotificationManagerCompat.from(<span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-built_in&quot;</span>&gt;</span>this<span class="tag">&lt;/<span class="name">span</span>&gt;</span>);</span><br><span class="line">                    notificationManager.notify(notificationId, builder.build());</span><br><span class="line">                  <span class="tag">&lt;/<span class="name">code</span>&gt;</span><span class="tag">&lt;/<span class="name">pre</span>&gt;</span></span><br><span class="line"></span><br><span class="line">              <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ol</span> <span class="attr">start</span>=<span class="string">&quot;4&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>广播<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>使用广播进行通信：<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>通信方式：通过发送和接收广播。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>是否跨进程：可以是跨进程的，也可以是同进程的。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>示例：<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">div</span> <span class="attr">relative</span>=<span class="string">&quot;&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">data-code</span>=<span class="string">&quot;%2F%2F%20%E5%8F%91%E9%80%81%E5%B9%BF%E6%92%AD%0AIntent%20intent%20%3D%20new%20Intent(%22com.example.MY_ACTION%22)%3B%0Aintent.putExtra(%22data%22%2C%20%22Hello%22)%3B%0AsendBroadcast(intent)%3B%0A%0A%2F%2F%20%E6%8E%A5%E6%94%B6%E5%B9%BF%E6%92%AD%0ABroadcastReceiver%20receiver%20%3D%20new%20BroadcastReceiver()%20%7B%0A%20%20%20%20%40Override%0A%20%20%20%20public%20void%20onReceive(Context%20context%2C%20Intent%20intent)%20%7B%0A%20%20%20%20%20%20%20%20String%20data%20%3D%20intent.getStringExtra(%22data%22)%3B%0A%20%20%20%20%20%20%20%20%2F%2F%20%E5%A4%84%E7%90%86%E6%8E%A5%E6%94%B6%E5%88%B0%E7%9A%84%E6%95%B0%E6%8D%AE%0A%20%20%20%20%7D%0A%7D%3B%0AregisterReceiver(receiver%2C%20new%20IntentFilter(%22com.example.MY_ACTION%22))%3B%0A&quot;</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">class</span>=<span class="string">&quot;copy-btn gpt-copy-btn group&quot;</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">svg</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.w3.org/2000/svg&quot;</span> <span class="attr">width</span>=<span class="string">&quot;1em&quot;</span> <span class="attr">height</span>=<span class="string">&quot;1em&quot;</span> <span class="attr">viewBox</span>=<span class="string">&quot;0 0 32 32&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">path</span> <span class="attr">fill</span>=<span class="string">&quot;currentColor&quot;</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">d</span>=<span class="string">&quot;M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">path</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">path</span> <span class="attr">fill</span>=<span class="string">&quot;currentColor&quot;</span> <span class="attr">d</span>=<span class="string">&quot;M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">path</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;group-hover:op-100 gpt-copy-tips&quot;</span>&gt;</span></span><br><span class="line">                    Copy</span><br><span class="line">                  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">pre</span>&gt;</span><span class="tag">&lt;<span class="name">code</span> <span class="attr">class</span>=<span class="string">&quot;hljs language-java&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-comment&quot;</span>&gt;</span>// 发送广播<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-type&quot;</span>&gt;</span>Intent<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-variable&quot;</span>&gt;</span>intent<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-operator&quot;</span>&gt;</span>=<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>new<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-title class_&quot;</span>&gt;</span>Intent<span class="tag">&lt;/<span class="name">span</span>&gt;</span>(<span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-string&quot;</span>&gt;</span>&quot;com.example.MY_ACTION&quot;<span class="tag">&lt;/<span class="name">span</span>&gt;</span>);</span><br><span class="line">                    intent.putExtra(<span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-string&quot;</span>&gt;</span>&quot;data&quot;<span class="tag">&lt;/<span class="name">span</span>&gt;</span>, <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-string&quot;</span>&gt;</span>&quot;Hello&quot;<span class="tag">&lt;/<span class="name">span</span>&gt;</span>);</span><br><span class="line">                    sendBroadcast(intent);</span><br><span class="line"></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-comment&quot;</span>&gt;</span>// 接收广播<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-type&quot;</span>&gt;</span>BroadcastReceiver<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-variable&quot;</span>&gt;</span>receiver<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-operator&quot;</span>&gt;</span>=<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>new<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-title class_&quot;</span>&gt;</span>BroadcastReceiver<span class="tag">&lt;/<span class="name">span</span>&gt;</span>() &#123;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-meta&quot;</span>&gt;</span>@Override<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>public<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>void<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-title function_&quot;</span>&gt;</span>onReceive<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-params&quot;</span>&gt;</span>(Context context, Intent</span><br><span class="line">                      intent)<span class="tag">&lt;/<span class="name">span</span>&gt;</span> &#123;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-type&quot;</span>&gt;</span>String<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-variable&quot;</span>&gt;</span>data<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-operator&quot;</span>&gt;</span>=<span class="tag">&lt;/<span class="name">span</span>&gt;</span> intent.getStringExtra(<span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-string&quot;</span>&gt;</span>&quot;data&quot;<span class="tag">&lt;/<span class="name">span</span>&gt;</span>);</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-comment&quot;</span>&gt;</span>// 处理接收到的数据<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    &#125;</span><br><span class="line">                    &#125;;</span><br><span class="line">                    registerReceiver(receiver, <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>new<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-title class_&quot;</span>&gt;</span>IntentFilter<span class="tag">&lt;/<span class="name">span</span>&gt;</span>(<span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-string&quot;</span>&gt;</span>&quot;com.example.MY_ACTION&quot;<span class="tag">&lt;/<span class="name">span</span>&gt;</span>));</span><br><span class="line">                  <span class="tag">&lt;/<span class="name">code</span>&gt;</span><span class="tag">&lt;/<span class="name">pre</span>&gt;</span></span><br><span class="line"></span><br><span class="line">              <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>总结：<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ol</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>同进程服务：通常不涉及跨进程通信，但可能涉及跨线程通信。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>不同进程的自定义服务：涉及跨进程通信，需要使用 IPC 机制。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>系统服务：涉及跨进程通信，但通过系统 API 隐藏了复杂性。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>广播：可以是跨进程的，也可以是同进程的，取决于广播的类型和接收者。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>在 Android 开发中，了解这些不同的通信场景和机制非常重要。它们各有优缺点和适用场景：<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>同进程通信更快，但限制了服务的复用性。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>跨进程通信更灵活，但性能开销较大，且实现更复杂。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>系统服务提供了标准化的接口，但可定制性较低。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>广播适合一对多的通信，但不适合频繁或大量数据的传输。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>选择合适的通信方式取决于您的具体需求，如性能要求、安全性考虑、跨应用通信的需求等。理解这些机制将帮助您设计出更高效、更可靠的 Android 应用。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="comment">&lt;!--#--&gt;</span><span class="comment">&lt;!--/--&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;py-2 -mx-4 px-4 transition-colors md:hover:bg-slate/3&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;flex gap-3 rounded-lg op-75&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;shrink-0 w-7 h-7 mt-4 rounded-full op-80 bg-gradient-to-r from-purple-400 to-yellow-400&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;message prose break-words overflow-hidden&quot;</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">                在谈谈推送服务吧，这个应该涉及到了跨进程、跨线程通信吧？我的理解大致是推送SDK在底层跟Android系统进行跨进程通信（比如IPC），让Android系统专门为其打开一条网络消息接收通道（比如说底层通过WebSocket来实现），保持长连接，当有消息来的时候，SDK会通知集成了该SDK的应用进行UI更新。跨进程指的是推送SDK实现了Android系统进程和APP进程的通信；跨线程指的是SDK中监听消息是一个后台操作，和UI主线程应该不是同一个线程，因此是跨线程的，我的理解正确且准确吗？</span><br><span class="line">              <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="comment">&lt;!--#--&gt;</span><span class="comment">&lt;!--/--&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;py-2 -mx-4 px-4 transition-colors md:hover:bg-slate/3&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;flex gap-3 rounded-lg&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span></span></span><br><span class="line"><span class="tag">              <span class="attr">class</span>=<span class="string">&quot;shrink-0 w-7 h-7 mt-4 rounded-full op-80 bg-gradient-to-r from-yellow-200 via-green-200 to-green-300&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;message prose break-words overflow-hidden&quot;</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>您的理解非常接近推送服务的实际工作原理，展示了对Android系统架构和通信机制的深入理解。让我们进一步分析和补充一些细节：<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ol</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>推送SDK与系统的交互<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>您的理解基本正确。推送SDK确实需要与Android系统进行深度交互，但具体实现可能因不同的推送服务而略有不同。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>系统级权限：许多推送SDK需要特殊的系统权限来保持后台运行和接收网络消息。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>长连接维护：通常通过WebSocket或类似的长连接技术实现。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ol</span> <span class="attr">start</span>=<span class="string">&quot;2&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>跨进程通信（IPC）<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>您的理解正确。推送服务通常涉及多个进程之间的通信：<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>推送服务进程 <span class="symbol">&amp;lt;</span>-<span class="symbol">&amp;gt;</span> 系统进程：用于保持服务运行和接收系统级事件。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>推送服务进程 <span class="symbol">&amp;lt;</span>-<span class="symbol">&amp;gt;</span> 应用进程：用于将消息传递给应用。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>这里通常使用Android的Binder机制或AIDL（Android Interface Definition Language）来实现IPC。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ol</span> <span class="attr">start</span>=<span class="string">&quot;3&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>跨线程通信<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>您的理解也是正确的。推送服务确实涉及跨线程通信：<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>网络监听线程：负责保持长连接和接收消息。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>消息处理线程：可能有专门的线程来处理接收到的消息。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>UI线程：需要在主线程上更新UI。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ol</span> <span class="attr">start</span>=<span class="string">&quot;4&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>具体实现细节<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>推送服务注册：应用启动时，通常会向推送SDK注册，这涉及到应用进程和推送服务进程的通信。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>消息接收：推送服务接收到消息后，需要通知相应的应用。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>唤醒机制：在某些情况下，推送服务可能需要唤醒已经被系统休眠的应用。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ol</span> <span class="attr">start</span>=<span class="string">&quot;5&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>示例流程<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">div</span> <span class="attr">relative</span>=<span class="string">&quot;&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">data-code</span>=<span class="string">&quot;%2F%2F%20%E5%9C%A8%E5%BA%94%E7%94%A8%E4%B8%AD%E5%88%9D%E5%A7%8B%E5%8C%96%E6%8E%A8%E9%80%81SDK%0APushSDK.init(this)%3B%0A%0A%2F%2F%20%E6%B3%A8%E5%86%8C%E6%B6%88%E6%81%AF%E6%8E%A5%E6%94%B6%E5%99%A8%0APushSDK.registerPushReceiver(new%20PushReceiver()%20%7B%0A%20%20%20%20%40Override%0A%20%20%20%20public%20void%20onMessageReceived(String%20message)%20%7B%0A%20%20%20%20%20%20%20%20%2F%2F%20%E8%BF%99%E9%87%8C%E9%80%9A%E5%B8%B8%E8%BF%90%E8%A1%8C%E5%9C%A8%E9%9D%9EUI%E7%BA%BF%E7%A8%8B%0A%20%20%20%20%20%20%20%20runOnUiThread(()%20-%3E%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20%E6%9B%B4%E6%96%B0UI%0A%20%20%20%20%20%20%20%20%20%20%20%20updateUI(message)%3B%0A%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%7D%0A%7D)%3B%0A&quot;</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">class</span>=<span class="string">&quot;copy-btn gpt-copy-btn group&quot;</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">svg</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.w3.org/2000/svg&quot;</span> <span class="attr">width</span>=<span class="string">&quot;1em&quot;</span> <span class="attr">height</span>=<span class="string">&quot;1em&quot;</span> <span class="attr">viewBox</span>=<span class="string">&quot;0 0 32 32&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">path</span> <span class="attr">fill</span>=<span class="string">&quot;currentColor&quot;</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">d</span>=<span class="string">&quot;M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">path</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">path</span> <span class="attr">fill</span>=<span class="string">&quot;currentColor&quot;</span> <span class="attr">d</span>=<span class="string">&quot;M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">path</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;group-hover:op-100 gpt-copy-tips&quot;</span>&gt;</span></span><br><span class="line">                    Copy</span><br><span class="line">                  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">pre</span>&gt;</span><span class="tag">&lt;<span class="name">code</span> <span class="attr">class</span>=<span class="string">&quot;hljs language-java&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-comment&quot;</span>&gt;</span>// 在应用中初始化推送SDK<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    PushSDK.init(<span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-built_in&quot;</span>&gt;</span>this<span class="tag">&lt;/<span class="name">span</span>&gt;</span>);</span><br><span class="line"></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-comment&quot;</span>&gt;</span>// 注册消息接收器<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    PushSDK.registerPushReceiver(<span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>new<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-title class_&quot;</span>&gt;</span>PushReceiver<span class="tag">&lt;/<span class="name">span</span>&gt;</span>() &#123;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-meta&quot;</span>&gt;</span>@Override<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>public<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>void<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-title function_&quot;</span>&gt;</span>onMessageReceived<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-params&quot;</span>&gt;</span>(String</span><br><span class="line">                      message)<span class="tag">&lt;/<span class="name">span</span>&gt;</span> &#123;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-comment&quot;</span>&gt;</span>// 这里通常运行在非UI线程<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    runOnUiThread(() -<span class="symbol">&amp;gt;</span> &#123;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-comment&quot;</span>&gt;</span>// 更新UI<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    updateUI(message);</span><br><span class="line">                    &#125;);</span><br><span class="line">                    &#125;</span><br><span class="line">                    &#125;);</span><br><span class="line">                  <span class="tag">&lt;/<span class="name">code</span>&gt;</span><span class="tag">&lt;/<span class="name">pre</span>&gt;</span></span><br><span class="line"></span><br><span class="line">              <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ol</span> <span class="attr">start</span>=<span class="string">&quot;6&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>补充说明<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>电源管理：推送服务需要特别注意电源消耗，通常会采用各种策略来平衡实时性和电池寿命。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>多厂商适配：不同的Android设备厂商可能有自己的推送服务实现，需要进行适配。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>系统限制：随着Android系统版本的更新，后台服务的限制越来越严格，推送服务需要不断适应这些变化。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>总结：<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">                您的理解非常准确。推送服务确实涉及复杂的跨进程和跨线程通信。它需要在系统级别、网络通信、进程间通信和线程管理等多个层面进行精细的设计和实现。您的分析展示了对Android系统架构和通信机制的深入理解，这对于开发高效、可靠的Android应用非常重要。</span><br><span class="line">              <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>继续保持这种深入思考和分析的习惯，它将帮助您在Android开发领域取得更大的进步。特别是在处理复杂的系统级功能和性能优化时，这种深层次的理解将会非常有价值。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="comment">&lt;!--#--&gt;</span><span class="comment">&lt;!--/--&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;py-2 -mx-4 px-4 transition-colors md:hover:bg-slate/3&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;flex gap-3 rounded-lg op-75&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;shrink-0 w-7 h-7 mt-4 rounded-full op-80 bg-gradient-to-r from-purple-400 to-yellow-400&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;message prose break-words overflow-hidden&quot;</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>Android中的服务是不是运行在主线程当中？<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="comment">&lt;!--#--&gt;</span><span class="comment">&lt;!--/--&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;py-2 -mx-4 px-4 transition-colors md:hover:bg-slate/3&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;flex gap-3 rounded-lg&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span></span></span><br><span class="line"><span class="tag">              <span class="attr">class</span>=<span class="string">&quot;shrink-0 w-7 h-7 mt-4 rounded-full op-80 bg-gradient-to-r from-yellow-200 via-green-200 to-green-300&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;message prose break-words overflow-hidden&quot;</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>您提出了一个非常好的问题，这个问题涉及到 Android 服务的一个常见误解。让我详细解释一下：<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ol</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>默认情况下，Android 服务确实运行在应用的主线程中<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>这意味着：<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>服务的生命周期方法（如 onCreate(), onStartCommand(), onBind(), onDestroy()）默认在主线程上执行。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>如果在这些方法中执行耗时操作，可能会导致应用无响应（ANR - Application Not Responding）。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ol</span> <span class="attr">start</span>=<span class="string">&quot;2&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>为什么设计成在主线程运行？<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>简化编程模型：不需要考虑线程同步问题。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>方便与 UI 交互：可以直接更新 UI，不需要使用 Handler 或 runOnUiThread。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>一致性：与 Activity 和 BroadcastReceiver 的行为一致。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ol</span> <span class="attr">start</span>=<span class="string">&quot;3&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>但这并不意味着所有服务操作都必须在主线程上执行<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">p</span>&gt;</span>服务可以（而且通常应该）创建工作线程来执行耗时操作。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">p</span>&gt;</span>Android 提供了几种方式来在服务中使用后台线程：<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">p</span>&gt;</span>a. 在服务内创建新线程：<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">div</span> <span class="attr">relative</span>=<span class="string">&quot;&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">div</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">data-code</span>=<span class="string">&quot;public%20class%20MyService%20extends%20Service%20%7B%0A%20%20%20%20%40Override%0A%20%20%20%20public%20int%20onStartCommand(Intent%20intent%2C%20int%20flags%2C%20int%20startId)%20%7B%0A%20%20%20%20%20%20%20%20new%20Thread(()%20-%3E%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20%E6%89%A7%E8%A1%8C%E8%80%97%E6%97%B6%E6%93%8D%E4%BD%9C%0A%20%20%20%20%20%20%20%20%7D).start()%3B%0A%20%20%20%20%20%20%20%20return%20START_STICKY%3B%0A%20%20%20%20%7D%0A%7D%0A&quot;</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;copy-btn gpt-copy-btn group&quot;</span>&gt;</span></span><br><span class="line">                      <span class="tag">&lt;<span class="name">svg</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.w3.org/2000/svg&quot;</span> <span class="attr">width</span>=<span class="string">&quot;1em&quot;</span> <span class="attr">height</span>=<span class="string">&quot;1em&quot;</span> <span class="attr">viewBox</span>=<span class="string">&quot;0 0 32 32&quot;</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">path</span> <span class="attr">fill</span>=<span class="string">&quot;currentColor&quot;</span></span></span><br><span class="line"><span class="tag">                          <span class="attr">d</span>=<span class="string">&quot;M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z&quot;</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;/<span class="name">path</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">path</span> <span class="attr">fill</span>=<span class="string">&quot;currentColor&quot;</span> <span class="attr">d</span>=<span class="string">&quot;M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">path</span>&gt;</span></span><br><span class="line">                      <span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br><span class="line">                      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;group-hover:op-100 gpt-copy-tips&quot;</span>&gt;</span></span><br><span class="line">                        Copy</span><br><span class="line">                      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">pre</span>&gt;</span><span class="tag">&lt;<span class="name">code</span> <span class="attr">class</span>=<span class="string">&quot;hljs language-java&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>public<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                          <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>class<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-title class_&quot;</span>&gt;</span>MyService<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                          <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>extends<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-title class_&quot;</span>&gt;</span>Service<span class="tag">&lt;/<span class="name">span</span>&gt;</span> &#123;</span><br><span class="line">                        <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-meta&quot;</span>&gt;</span>@Override<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>public<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-type&quot;</span>&gt;</span>int<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                          <span class="attr">class</span>=<span class="string">&quot;hljs-title function_&quot;</span>&gt;</span>onStartCommand<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-params&quot;</span>&gt;</span>(Intent intent,</span><br><span class="line">                          <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-type&quot;</span>&gt;</span>int<span class="tag">&lt;/<span class="name">span</span>&gt;</span> flags, <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-type&quot;</span>&gt;</span>int<span class="tag">&lt;/<span class="name">span</span>&gt;</span> startId)<span class="tag">&lt;/<span class="name">span</span>&gt;</span> &#123;</span><br><span class="line">                        <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>new<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-title class_&quot;</span>&gt;</span>Thread<span class="tag">&lt;/<span class="name">span</span>&gt;</span>(() -<span class="symbol">&amp;gt;</span> &#123;</span><br><span class="line">                        <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-comment&quot;</span>&gt;</span>// 执行耗时操作<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                        &#125;).start();</span><br><span class="line">                        <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>return<span class="tag">&lt;/<span class="name">span</span>&gt;</span> START_STICKY;</span><br><span class="line">                        &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                      <span class="tag">&lt;/<span class="name">code</span>&gt;</span><span class="tag">&lt;/<span class="name">pre</span>&gt;</span></span><br><span class="line"></span><br><span class="line">                  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">p</span>&gt;</span>b. 使用 AsyncTask（虽然在新版 Android 中已被弃用）：<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">div</span> <span class="attr">relative</span>=<span class="string">&quot;&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">div</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">data-code</span>=<span class="string">&quot;public%20class%20MyService%20extends%20Service%20%7B%0A%20%20%20%20%40Override%0A%20%20%20%20public%20int%20onStartCommand(Intent%20intent%2C%20int%20flags%2C%20int%20startId)%20%7B%0A%20%20%20%20%20%20%20%20new%20AsyncTask%3CVoid%2C%20Void%2C%20Void%3E()%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%40Override%0A%20%20%20%20%20%20%20%20%20%20%20%20protected%20Void%20doInBackground(Void...%20voids)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20%E6%89%A7%E8%A1%8C%E8%80%97%E6%97%B6%E6%93%8D%E4%BD%9C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20null%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D.execute()%3B%0A%20%20%20%20%20%20%20%20return%20START_STICKY%3B%0A%20%20%20%20%7D%0A%7D%0A&quot;</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;copy-btn gpt-copy-btn group&quot;</span>&gt;</span></span><br><span class="line">                      <span class="tag">&lt;<span class="name">svg</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.w3.org/2000/svg&quot;</span> <span class="attr">width</span>=<span class="string">&quot;1em&quot;</span> <span class="attr">height</span>=<span class="string">&quot;1em&quot;</span> <span class="attr">viewBox</span>=<span class="string">&quot;0 0 32 32&quot;</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">path</span> <span class="attr">fill</span>=<span class="string">&quot;currentColor&quot;</span></span></span><br><span class="line"><span class="tag">                          <span class="attr">d</span>=<span class="string">&quot;M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z&quot;</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;/<span class="name">path</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">path</span> <span class="attr">fill</span>=<span class="string">&quot;currentColor&quot;</span> <span class="attr">d</span>=<span class="string">&quot;M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">path</span>&gt;</span></span><br><span class="line">                      <span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br><span class="line">                      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;group-hover:op-100 gpt-copy-tips&quot;</span>&gt;</span></span><br><span class="line">                        Copy</span><br><span class="line">                      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">pre</span>&gt;</span><span class="tag">&lt;<span class="name">code</span> <span class="attr">class</span>=<span class="string">&quot;hljs language-java&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>public<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                          <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>class<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-title class_&quot;</span>&gt;</span>MyService<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                          <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>extends<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-title class_&quot;</span>&gt;</span>Service<span class="tag">&lt;/<span class="name">span</span>&gt;</span> &#123;</span><br><span class="line">                        <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-meta&quot;</span>&gt;</span>@Override<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>public<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-type&quot;</span>&gt;</span>int<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                          <span class="attr">class</span>=<span class="string">&quot;hljs-title function_&quot;</span>&gt;</span>onStartCommand<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-params&quot;</span>&gt;</span>(Intent intent,</span><br><span class="line">                          <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-type&quot;</span>&gt;</span>int<span class="tag">&lt;/<span class="name">span</span>&gt;</span> flags, <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-type&quot;</span>&gt;</span>int<span class="tag">&lt;/<span class="name">span</span>&gt;</span> startId)<span class="tag">&lt;/<span class="name">span</span>&gt;</span> &#123;</span><br><span class="line">                        <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>new<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-title class_&quot;</span>&gt;</span>AsyncTask<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="symbol">&amp;lt;</span>Void,</span><br><span class="line">                        Void, Void<span class="symbol">&amp;gt;</span>() &#123;</span><br><span class="line">                        <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-meta&quot;</span>&gt;</span>@Override<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>protected<span class="tag">&lt;/<span class="name">span</span>&gt;</span> Void <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                          <span class="attr">class</span>=<span class="string">&quot;hljs-title function_&quot;</span>&gt;</span>doInBackground<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-params&quot;</span>&gt;</span>(Void...</span><br><span class="line">                          voids)<span class="tag">&lt;/<span class="name">span</span>&gt;</span> &#123;</span><br><span class="line">                        <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-comment&quot;</span>&gt;</span>// 执行耗时操作<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>return<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-literal&quot;</span>&gt;</span>null<span class="tag">&lt;/<span class="name">span</span>&gt;</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                        &#125;.execute();</span><br><span class="line">                        <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>return<span class="tag">&lt;/<span class="name">span</span>&gt;</span> START_STICKY;</span><br><span class="line">                        &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                      <span class="tag">&lt;/<span class="name">code</span>&gt;</span><span class="tag">&lt;/<span class="name">pre</span>&gt;</span></span><br><span class="line"></span><br><span class="line">                  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">p</span>&gt;</span>c. 使用 IntentService（在 API 26 之前）：<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">                    IntentService 会自动创建一个工作线程来处理传入的 Intent。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">div</span> <span class="attr">relative</span>=<span class="string">&quot;&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">div</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">data-code</span>=<span class="string">&quot;public%20class%20MyIntentService%20extends%20IntentService%20%7B%0A%20%20%20%20public%20MyIntentService()%20%7B%0A%20%20%20%20%20%20%20%20super(%22MyIntentService%22)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%40Override%0A%20%20%20%20protected%20void%20onHandleIntent(Intent%20intent)%20%7B%0A%20%20%20%20%20%20%20%20%2F%2F%20%E8%BF%99%E9%87%8C%E7%9A%84%E4%BB%A3%E7%A0%81%E4%BC%9A%E5%9C%A8%E5%B7%A5%E4%BD%9C%E7%BA%BF%E7%A8%8B%E4%B8%AD%E6%89%A7%E8%A1%8C%0A%20%20%20%20%7D%0A%7D%0A&quot;</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;copy-btn gpt-copy-btn group&quot;</span>&gt;</span></span><br><span class="line">                      <span class="tag">&lt;<span class="name">svg</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.w3.org/2000/svg&quot;</span> <span class="attr">width</span>=<span class="string">&quot;1em&quot;</span> <span class="attr">height</span>=<span class="string">&quot;1em&quot;</span> <span class="attr">viewBox</span>=<span class="string">&quot;0 0 32 32&quot;</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">path</span> <span class="attr">fill</span>=<span class="string">&quot;currentColor&quot;</span></span></span><br><span class="line"><span class="tag">                          <span class="attr">d</span>=<span class="string">&quot;M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z&quot;</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;/<span class="name">path</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">path</span> <span class="attr">fill</span>=<span class="string">&quot;currentColor&quot;</span> <span class="attr">d</span>=<span class="string">&quot;M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">path</span>&gt;</span></span><br><span class="line">                      <span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br><span class="line">                      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;group-hover:op-100 gpt-copy-tips&quot;</span>&gt;</span></span><br><span class="line">                        Copy</span><br><span class="line">                      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">pre</span>&gt;</span><span class="tag">&lt;<span class="name">code</span> <span class="attr">class</span>=<span class="string">&quot;hljs language-java&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>public<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                          <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>class<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-title class_&quot;</span>&gt;</span>MyIntentService<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                          <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>extends<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-title class_&quot;</span>&gt;</span>IntentService<span class="tag">&lt;/<span class="name">span</span>&gt;</span> &#123;</span><br><span class="line">                        <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>public<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                          <span class="attr">class</span>=<span class="string">&quot;hljs-title function_&quot;</span>&gt;</span>MyIntentService<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-params&quot;</span>&gt;</span>()<span class="tag">&lt;/<span class="name">span</span>&gt;</span> &#123;</span><br><span class="line">                        <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-built_in&quot;</span>&gt;</span>super<span class="tag">&lt;/<span class="name">span</span>&gt;</span>(<span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-string&quot;</span>&gt;</span>&quot;MyIntentService&quot;<span class="tag">&lt;/<span class="name">span</span>&gt;</span>);</span><br><span class="line">                        &#125;</span><br><span class="line"></span><br><span class="line">                        <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-meta&quot;</span>&gt;</span>@Override<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>protected<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>void<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                          <span class="attr">class</span>=<span class="string">&quot;hljs-title function_&quot;</span>&gt;</span>onHandleIntent<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-params&quot;</span>&gt;</span>(Intent</span><br><span class="line">                          intent)<span class="tag">&lt;/<span class="name">span</span>&gt;</span> &#123;</span><br><span class="line">                        <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-comment&quot;</span>&gt;</span>// 这里的代码会在工作线程中执行<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                        &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                      <span class="tag">&lt;/<span class="name">code</span>&gt;</span><span class="tag">&lt;/<span class="name">pre</span>&gt;</span></span><br><span class="line"></span><br><span class="line">                  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">p</span>&gt;</span>d. 使用 JobIntentService（API 26 及以上）：<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">                    JobIntentService 是 IntentService 的兼容性替代品。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">div</span> <span class="attr">relative</span>=<span class="string">&quot;&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">div</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">data-code</span>=<span class="string">&quot;public%20class%20MyJobIntentService%20extends%20JobIntentService%20%7B%0A%20%20%20%20%40Override%0A%20%20%20%20protected%20void%20onHandleWork(%40NonNull%20Intent%20intent)%20%7B%0A%20%20%20%20%20%20%20%20%2F%2F%20%E8%BF%99%E9%87%8C%E7%9A%84%E4%BB%A3%E7%A0%81%E4%BC%9A%E5%9C%A8%E5%B7%A5%E4%BD%9C%E7%BA%BF%E7%A8%8B%E4%B8%AD%E6%89%A7%E8%A1%8C%0A%20%20%20%20%7D%0A%7D%0A&quot;</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;copy-btn gpt-copy-btn group&quot;</span>&gt;</span></span><br><span class="line">                      <span class="tag">&lt;<span class="name">svg</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.w3.org/2000/svg&quot;</span> <span class="attr">width</span>=<span class="string">&quot;1em&quot;</span> <span class="attr">height</span>=<span class="string">&quot;1em&quot;</span> <span class="attr">viewBox</span>=<span class="string">&quot;0 0 32 32&quot;</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">path</span> <span class="attr">fill</span>=<span class="string">&quot;currentColor&quot;</span></span></span><br><span class="line"><span class="tag">                          <span class="attr">d</span>=<span class="string">&quot;M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z&quot;</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;/<span class="name">path</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">path</span> <span class="attr">fill</span>=<span class="string">&quot;currentColor&quot;</span> <span class="attr">d</span>=<span class="string">&quot;M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">path</span>&gt;</span></span><br><span class="line">                      <span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br><span class="line">                      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;group-hover:op-100 gpt-copy-tips&quot;</span>&gt;</span></span><br><span class="line">                        Copy</span><br><span class="line">                      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">pre</span>&gt;</span><span class="tag">&lt;<span class="name">code</span> <span class="attr">class</span>=<span class="string">&quot;hljs language-java&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>public<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                          <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>class<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-title class_&quot;</span>&gt;</span>MyJobIntentService<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>extends<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                          <span class="attr">class</span>=<span class="string">&quot;hljs-title class_&quot;</span>&gt;</span>JobIntentService<span class="tag">&lt;/<span class="name">span</span>&gt;</span> &#123;</span><br><span class="line">                        <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-meta&quot;</span>&gt;</span>@Override<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>protected<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>void<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                          <span class="attr">class</span>=<span class="string">&quot;hljs-title function_&quot;</span>&gt;</span>onHandleWork<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-params&quot;</span>&gt;</span>(<span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                            <span class="attr">class</span>=<span class="string">&quot;hljs-meta&quot;</span>&gt;</span>@NonNull<span class="tag">&lt;/<span class="name">span</span>&gt;</span> Intent intent)<span class="tag">&lt;/<span class="name">span</span>&gt;</span> &#123;</span><br><span class="line">                        <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-comment&quot;</span>&gt;</span>// 这里的代码会在工作线程中执行<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                        &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                      <span class="tag">&lt;/<span class="name">code</span>&gt;</span><span class="tag">&lt;/<span class="name">pre</span>&gt;</span></span><br><span class="line"></span><br><span class="line">                  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ol</span> <span class="attr">start</span>=<span class="string">&quot;4&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>特殊情况：前台服务<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>前台服务虽然也默认运行在主线程，但它们有更高的优先级，不太容易被系统杀死。然而，它们仍然应该避免在主线程上执行耗时操作。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ol</span> <span class="attr">start</span>=<span class="string">&quot;5&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>最佳实践<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>在服务的生命周期方法中避免执行耗时操作。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>对于需要长时间运行的任务，创建工作线程或使用 IntentService/JobIntentService。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>考虑使用 WorkManager 来调度和执行后台任务，特别是对于需要满足特定条件（如网络可用）才执行的任务。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>总结：<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">                虽然 Android 服务默认运行在主线程上，但这并不意味着所有的服务操作都应该在主线程上执行。理解这一点对于开发高性能、响应迅速的 Android</span><br><span class="line">                应用至关重要。在设计服务时，应该仔细考虑哪些操作需要在后台线程中执行，以避免阻塞主线程和潜在的 ANR 问题。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="comment">&lt;!--#--&gt;</span><span class="comment">&lt;!--/--&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;py-2 -mx-4 px-4 transition-colors md:hover:bg-slate/3&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;flex gap-3 rounded-lg op-75&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;shrink-0 w-7 h-7 mt-4 rounded-full op-80 bg-gradient-to-r from-purple-400 to-yellow-400&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;message prose break-words overflow-hidden&quot;</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>我有以下疑惑：1.我们需要收到调用GC的时候，GC一般会带来STW问题。什么叫STW问题？2.其中 MessageQueue 被 Looper 管理，Looper在构造时同步会创建</span><br><span class="line">                MessageQueue，并利用ThreadLocal 这种 TLS，将其与当前线程绑定。什么叫TLS？<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="comment">&lt;!--#--&gt;</span><span class="comment">&lt;!--/--&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;py-2 -mx-4 px-4 transition-colors md:hover:bg-slate/3&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;flex gap-3 rounded-lg&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span></span></span><br><span class="line"><span class="tag">              <span class="attr">class</span>=<span class="string">&quot;shrink-0 w-7 h-7 mt-4 rounded-full op-80 bg-gradient-to-r from-yellow-200 via-green-200 to-green-300&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;message prose break-words overflow-hidden&quot;</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>您提出了两个非常好的问题，涉及到了内存管理和线程本地存储的概念。让我们逐一解答：<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ol</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>STW (Stop The World) 问题<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>STW 是指在垃圾收集（Garbage Collection, GC）过程中，Java 应用程序的所有线程都会暂停执行的现象。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>定义：STW 字面意思就是&quot;停止世界&quot;，在 GC 上下文中，&quot;世界&quot;指的是 Java 应用程序。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>原因：为了保证垃圾收集的正确性和一致性，GC 需要在一个稳定的堆状态下进行。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>影响：STW 会导致应用程序暂时停止响应，可能会影响用户体验，特别是在大型应用或对实时性要求高的场景中。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>STW 的具体表现：<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>所有应用线程被暂停。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>GC 线程开始工作，清理内存。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>清理完成后，应用线程恢复执行。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>优化方法：<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>使用并发垃圾收集器（如 CMS、G1）可以减少 STW 时间。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>合理设置堆大小和代的比例。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>优化代码以减少对象创建和垃圾产生。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ol</span> <span class="attr">start</span>=<span class="string">&quot;2&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>TLS (Thread Local Storage)<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>TLS 是一种线程本地存储机制，允许每个线程拥有自己的独立的变量副本。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>定义：TLS 提供了一种方法，使得同一个变量在不同的线程中拥有不同的值。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>作用：用于存储线程特有的数据，避免线程间的数据竞争。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>在 Java 中，ThreadLocal 类实现了 TLS 机制：<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">div</span> <span class="attr">relative</span>=<span class="string">&quot;&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">data-code</span>=<span class="string">&quot;public%20class%20ThreadLocalExample%20%7B%0A%20%20%20%20private%20static%20final%20ThreadLocal%3CInteger%3E%20threadLocalValue%20%3D%20new%20ThreadLocal%3C%3E()%3B%0A%0A%20%20%20%20public%20static%20void%20main(String%5B%5D%20args)%20%7B%0A%20%20%20%20%20%20%20%20Thread%20t1%20%3D%20new%20Thread(()%20-%3E%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20threadLocalValue.set(1)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20System.out.println(%22Thread%201%3A%20%22%20%2B%20threadLocalValue.get())%3B%0A%20%20%20%20%20%20%20%20%7D)%3B%0A%0A%20%20%20%20%20%20%20%20Thread%20t2%20%3D%20new%20Thread(()%20-%3E%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20threadLocalValue.set(2)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20System.out.println(%22Thread%202%3A%20%22%20%2B%20threadLocalValue.get())%3B%0A%20%20%20%20%20%20%20%20%7D)%3B%0A%0A%20%20%20%20%20%20%20%20t1.start()%3B%0A%20%20%20%20%20%20%20%20t2.start()%3B%0A%20%20%20%20%7D%0A%7D%0A&quot;</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">class</span>=<span class="string">&quot;copy-btn gpt-copy-btn group&quot;</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">svg</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.w3.org/2000/svg&quot;</span> <span class="attr">width</span>=<span class="string">&quot;1em&quot;</span> <span class="attr">height</span>=<span class="string">&quot;1em&quot;</span> <span class="attr">viewBox</span>=<span class="string">&quot;0 0 32 32&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">path</span> <span class="attr">fill</span>=<span class="string">&quot;currentColor&quot;</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">d</span>=<span class="string">&quot;M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">path</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">path</span> <span class="attr">fill</span>=<span class="string">&quot;currentColor&quot;</span> <span class="attr">d</span>=<span class="string">&quot;M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">path</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;group-hover:op-100 gpt-copy-tips&quot;</span>&gt;</span></span><br><span class="line">                    Copy</span><br><span class="line">                  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">pre</span>&gt;</span><span class="tag">&lt;<span class="name">code</span> <span class="attr">class</span>=<span class="string">&quot;hljs language-java&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>public<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>class<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-title class_&quot;</span>&gt;</span>ThreadLocalExample<span class="tag">&lt;/<span class="name">span</span>&gt;</span> &#123;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>private<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>static<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>final<span class="tag">&lt;/<span class="name">span</span>&gt;</span> ThreadLocal<span class="symbol">&amp;lt;</span>Integer<span class="symbol">&amp;gt;</span> threadLocalValue = <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>new<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-title class_&quot;</span>&gt;</span>ThreadLocal<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="symbol">&amp;lt;</span><span class="symbol">&amp;gt;</span>();</span><br><span class="line"></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>public<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>static<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>void<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-title function_&quot;</span>&gt;</span>main<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-params&quot;</span>&gt;</span>(String[] args)<span class="tag">&lt;/<span class="name">span</span>&gt;</span> &#123;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-type&quot;</span>&gt;</span>Thread<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-variable&quot;</span>&gt;</span>t1<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-operator&quot;</span>&gt;</span>=<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>new<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-title class_&quot;</span>&gt;</span>Thread<span class="tag">&lt;/<span class="name">span</span>&gt;</span>(() -<span class="symbol">&amp;gt;</span> &#123;</span><br><span class="line">                    threadLocalValue.set(<span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-number&quot;</span>&gt;</span>1<span class="tag">&lt;/<span class="name">span</span>&gt;</span>);</span><br><span class="line">                    System.out.println(<span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-string&quot;</span>&gt;</span>&quot;Thread 1: &quot;<span class="tag">&lt;/<span class="name">span</span>&gt;</span> + threadLocalValue.get());</span><br><span class="line">                    &#125;);</span><br><span class="line"></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-type&quot;</span>&gt;</span>Thread<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-variable&quot;</span>&gt;</span>t2<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-operator&quot;</span>&gt;</span>=<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>new<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-title class_&quot;</span>&gt;</span>Thread<span class="tag">&lt;/<span class="name">span</span>&gt;</span>(() -<span class="symbol">&amp;gt;</span> &#123;</span><br><span class="line">                    threadLocalValue.set(<span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-number&quot;</span>&gt;</span>2<span class="tag">&lt;/<span class="name">span</span>&gt;</span>);</span><br><span class="line">                    System.out.println(<span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-string&quot;</span>&gt;</span>&quot;Thread 2: &quot;<span class="tag">&lt;/<span class="name">span</span>&gt;</span> + threadLocalValue.get());</span><br><span class="line">                    &#125;);</span><br><span class="line"></span><br><span class="line">                    t1.start();</span><br><span class="line">                    t2.start();</span><br><span class="line">                    &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                  <span class="tag">&lt;/<span class="name">code</span>&gt;</span><span class="tag">&lt;/<span class="name">pre</span>&gt;</span></span><br><span class="line"></span><br><span class="line">              <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>在 Android 的 Looper 中使用 TLS 的原因：<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>每个线程都有自己的 Looper 和 MessageQueue。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>使用 TLS 可以确保在任何地方都能获取到当前线程的 Looper，而不需要显式传递。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>Looper 中 TLS 的使用示例：<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">div</span> <span class="attr">relative</span>=<span class="string">&quot;&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">data-code</span>=<span class="string">&quot;public%20final%20class%20Looper%20%7B%0A%20%20%20%20static%20final%20ThreadLocal%3CLooper%3E%20sThreadLocal%20%3D%20new%20ThreadLocal%3CLooper%3E()%3B%0A%0A%20%20%20%20public%20static%20void%20prepare()%20%7B%0A%20%20%20%20%20%20%20%20if%20(sThreadLocal.get()%20!%3D%20null)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20throw%20new%20RuntimeException(%22Only%20one%20Looper%20may%20be%20created%20per%20thread%22)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20sThreadLocal.set(new%20Looper(true))%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20public%20static%20Looper%20myLooper()%20%7B%0A%20%20%20%20%20%20%20%20return%20sThreadLocal.get()%3B%0A%20%20%20%20%7D%0A%20%20%20%20%2F%2F%20...%0A%7D%0A&quot;</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">class</span>=<span class="string">&quot;copy-btn gpt-copy-btn group&quot;</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">svg</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.w3.org/2000/svg&quot;</span> <span class="attr">width</span>=<span class="string">&quot;1em&quot;</span> <span class="attr">height</span>=<span class="string">&quot;1em&quot;</span> <span class="attr">viewBox</span>=<span class="string">&quot;0 0 32 32&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">path</span> <span class="attr">fill</span>=<span class="string">&quot;currentColor&quot;</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">d</span>=<span class="string">&quot;M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2Z&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">path</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">path</span> <span class="attr">fill</span>=<span class="string">&quot;currentColor&quot;</span> <span class="attr">d</span>=<span class="string">&quot;M4 18H2V4a2 2 0 0 1 2-2h14v2H4Z&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">path</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;group-hover:op-100 gpt-copy-tips&quot;</span>&gt;</span></span><br><span class="line">                    Copy</span><br><span class="line">                  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">pre</span>&gt;</span><span class="tag">&lt;<span class="name">code</span> <span class="attr">class</span>=<span class="string">&quot;hljs language-java&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>public<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>final<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>class<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-title class_&quot;</span>&gt;</span>Looper<span class="tag">&lt;/<span class="name">span</span>&gt;</span> &#123;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>static<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>final<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    ThreadLocal<span class="symbol">&amp;lt;</span>Looper<span class="symbol">&amp;gt;</span> sThreadLocal = <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>new<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-title class_&quot;</span>&gt;</span>ThreadLocal<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="symbol">&amp;lt;</span>Looper<span class="symbol">&amp;gt;</span>();</span><br><span class="line"></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>public<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>static<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>void<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-title function_&quot;</span>&gt;</span>prepare<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-params&quot;</span>&gt;</span>()<span class="tag">&lt;/<span class="name">span</span>&gt;</span> &#123;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>if<span class="tag">&lt;/<span class="name">span</span>&gt;</span> (sThreadLocal.get() != <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-literal&quot;</span>&gt;</span>null<span class="tag">&lt;/<span class="name">span</span>&gt;</span>)</span><br><span class="line">                    &#123;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>throw<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>new<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-title class_&quot;</span>&gt;</span>RuntimeException<span class="tag">&lt;/<span class="name">span</span>&gt;</span>(<span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-string&quot;</span>&gt;</span>&quot;Only one Looper may</span><br><span class="line">                      be created per thread&quot;<span class="tag">&lt;/<span class="name">span</span>&gt;</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                    sThreadLocal.set(<span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>new<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-title class_&quot;</span>&gt;</span>Looper<span class="tag">&lt;/<span class="name">span</span>&gt;</span>(<span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-literal&quot;</span>&gt;</span>true<span class="tag">&lt;/<span class="name">span</span>&gt;</span>));</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>public<span class="tag">&lt;/<span class="name">span</span>&gt;</span> <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>static<span class="tag">&lt;/<span class="name">span</span>&gt;</span> Looper <span class="tag">&lt;<span class="name">span</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">class</span>=<span class="string">&quot;hljs-title function_&quot;</span>&gt;</span>myLooper<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-params&quot;</span>&gt;</span>()<span class="tag">&lt;/<span class="name">span</span>&gt;</span> &#123;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-keyword&quot;</span>&gt;</span>return<span class="tag">&lt;/<span class="name">span</span>&gt;</span> sThreadLocal.get();</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;hljs-comment&quot;</span>&gt;</span>// ...<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    &#125;</span><br><span class="line">                  <span class="tag">&lt;/<span class="name">code</span>&gt;</span><span class="tag">&lt;/<span class="name">pre</span>&gt;</span></span><br><span class="line"></span><br><span class="line">              <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>这种设计的优点：<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>线程安全：每个线程有自己的 Looper 实例，避免了线程间的数据竞争。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>方便访问：在任何地方都可以通过 Looper.myLooper() 获取当前线程的 Looper。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>解耦：不需要显式地在不同组件间传递 Looper 对象。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>总结：<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">ol</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>STW 是 GC 过程中的一个重要概念，理解它有助于优化应用性能，特别是在对响应时间敏感的场景中。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span>TLS（在 Java 中通过 ThreadLocal 实现）是一种重要的线程安全机制，在 Android 的消息循环系统中扮演着关键角色。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">p</span>&gt;</span>理解这些概念对于深入掌握 Java 和 Android 的内存管理和并发编程非常重要。它们帮助开发者编写更高效、更可靠的代码，尤其是在处理复杂的多线程场景时。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="comment">&lt;!--#--&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;fie px-3 mb-2&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;gpt-retry-btn&quot;</span>&gt;</span><span class="comment">&lt;!--#--&gt;</span><span class="tag">&lt;<span class="name">svg</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.w3.org/2000/svg&quot;</span> <span class="attr">width</span>=<span class="string">&quot;1em&quot;</span> <span class="attr">height</span>=<span class="string">&quot;1em&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">viewBox</span>=<span class="string">&quot;0 0 32 32&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">path</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">d</span>=<span class="string">&quot;M25.95 7.65l.005-.004c-.092-.11-.197-.206-.293-.312c-.184-.205-.367-.41-.563-.603c-.139-.136-.286-.262-.43-.391c-.183-.165-.366-.329-.558-.482c-.16-.128-.325-.247-.49-.367c-.192-.14-.385-.277-.585-.406a13.513 13.513 0 0 0-.533-.324q-.308-.179-.625-.341c-.184-.094-.37-.185-.56-.27c-.222-.1-.449-.191-.678-.28c-.19-.072-.378-.145-.571-.208c-.246-.082-.498-.15-.75-.217c-.186-.049-.368-.102-.556-.143c-.29-.063-.587-.107-.883-.15c-.16-.023-.315-.056-.476-.073A12.933 12.933 0 0 0 6 7.703V4H4v8h8v-2H6.811A10.961 10.961 0 0 1 16 5a11.111 11.111 0 0 1 1.189.067c.136.015.268.042.403.061c.25.037.501.075.746.128c.16.035.315.08.472.121c.213.057.425.114.633.183c.164.054.325.116.486.178c.193.074.384.15.57.235c.162.072.32.15.477.23q.268.136.526.286c.153.09.305.18.453.276c.168.11.33.224.492.342c.14.102.282.203.417.312c.162.13.316.268.47.406c.123.11.248.217.365.332c.167.164.323.338.479.512A10.993 10.993 0 1 1 5 16H3a13 13 0 1 0 22.95-8.35z&quot;</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">fill</span>=<span class="string">&quot;currentColor&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">path</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">svg</span>&gt;</span><span class="comment">&lt;!--/--&gt;</span><span class="tag">&lt;<span class="name">span</span>&gt;</span>重试<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="comment">&lt;!--/--&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="comment">&lt;!--/--&gt;</span><span class="comment">&lt;!--#--&gt;</span><span class="comment">&lt;!--/--&gt;</span><span class="comment">&lt;!--#--&gt;</span><span class="comment">&lt;!--/--&gt;</span><span class="comment">&lt;!--#--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;gen-text-wrapper&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">textarea</span> <span class="attr">placeholder</span>=<span class="string">&quot;输入任何问题...&quot;</span> <span class="attr">autocomplete</span>=<span class="string">&quot;off&quot;</span> <span class="attr">autofocus</span>=<span class="string">&quot;&quot;</span> <span class="attr">rows</span>=<span class="string">&quot;1&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">class</span>=<span class="string">&quot;gen-textarea&quot;</span> <span class="attr">style</span>=<span class="string">&quot;height: 48px;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">textarea</span>&gt;</span><span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">&quot;w-28&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">gen-slate-btn</span>=<span class="string">&quot;&quot;</span>&gt;</span>发送<span class="tag">&lt;/<span class="name">button</span>&gt;</span><span class="tag">&lt;<span class="name">button</span> <span class="attr">title</span>=<span class="string">&quot;Clear&quot;</span> <span class="attr">gen-slate-btn</span>=<span class="string">&quot;&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">svg</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.w3.org/2000/svg&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">width</span>=<span class="string">&quot;1em&quot;</span> <span class="attr">height</span>=<span class="string">&quot;1em&quot;</span> <span class="attr">viewBox</span>=<span class="string">&quot;0 0 24 24&quot;</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">path</span> <span class="attr">fill</span>=<span class="string">&quot;currentColor&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">d</span>=<span class="string">&quot;M8 20v-5h2v5h9v-7H5v7h3zm-4-9h16V8h-6V4h-4v4H4v3zM3 21v-8H2V7a1 1 0 0 1 1-1h5V3a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1v3h5a1 1 0 0 1 1 1v6h-1v8a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1z&quot;</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">path</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">svg</span>&gt;</span><span class="tag">&lt;/<span class="name">button</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="comment">&lt;!--/--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;fixed bottom-5 left-5 rounded-md hover:bg-slate/10 w-fit h-fit transition-colors active:scale-90&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">&quot;p-2.5 text-base&quot;</span> <span class="attr">title</span>=<span class="string">&quot;stick to bottom&quot;</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">div</span> <span class="attr">i-ph-arrow-line-down-bold</span>=<span class="string">&quot;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">button</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">astro-island</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">astro-island</span> <span class="attr">uid</span>=<span class="string">&quot;ZDWXaC&quot;</span> <span class="attr">data-solid-render-id</span>=<span class="string">&quot;s1&quot;</span> <span class="attr">component-url</span>=<span class="string">&quot;/_astro/Footer.a8983667.js&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">component-export</span>=<span class="string">&quot;default&quot;</span> <span class="attr">renderer-url</span>=<span class="string">&quot;/_astro/client.0e663382.js&quot;</span> <span class="attr">props</span>=<span class="string">&quot;&#123;&#125;&quot;</span> <span class="attr">client</span>=<span class="string">&quot;load&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">opts</span>=<span class="string">&quot;&#123;<span class="symbol">&amp;quot;</span>name<span class="symbol">&amp;quot;</span>:<span class="symbol">&amp;quot;</span>Footer<span class="symbol">&amp;quot;</span>,<span class="symbol">&amp;quot;</span>value<span class="symbol">&amp;quot;</span>:true&#125;&quot;</span> <span class="attr">await-children</span>=<span class="string">&quot;&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">footer</span> <span class="attr">data-hk</span>=<span class="string">&quot;s10-0&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">mt-6</span>=<span class="string">&quot;&quot;</span> <span class="attr">text-xs</span>=<span class="string">&quot;&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">op-60</span>=<span class="string">&quot;&quot;</span>&gt;</span>完全免费 无需魔法 无需登录 120次/天<span class="comment">&lt;!--#--&gt;</span> 剩120次 <span class="comment">&lt;!--/--&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;op-0&quot;</span>&gt;</span>免费Claude 3.5 Sonnet<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">footer</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">astro-island</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">main</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>